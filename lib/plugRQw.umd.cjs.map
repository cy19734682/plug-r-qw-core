{"version":3,"file":"plugRQw.umd.cjs","sources":["../src/locale/lang/zh-CN.js","../src/locale/format.ts","../src/locale/index.ts","../src/locale/i18nSFC.ts","../src/components/HeaderBt/HeaderBt.vue","../src/utils/proxy.ts","../src/components/FullPop/FullPop.vue","../src/components/Hello.vue","../src/components/IconTxtBtn/IconTxtBtn.vue","../src/components/Page404/Page404.vue","../src/utils/swal.ts","../src/components/TableTooltip/TableTooltip.vue","../src/utils/globalFunc.ts","../src/components/SideMenu/SideMenuGroup.vue","../src/components/SideMenu/SideMenu.vue","../src/components/TableIconBtn/TableIconBtn.vue","../src/components/ShowHidePanel/ShowHidePanel.vue","../src/components/ShowHidePanelB/ShowHidePanelB.vue","../src/utils/timer.ts","../src/components/TableSearch/TableSearch.vue","../src/directives/clickOutside.ts","../src/utils/swalConfirm.ts","../src/components/TableSetting/TableSetting.vue","../src/utils/needImportFunc.ts","../src/utils/messageBox.ts","../src/utils/spin.ts","../src/utils/fetch.ts","../src/components/PagePro/PagePro.vue","../src/components/BtTablePage/BtTablePage.vue","../src/components/SelectInput/SelectInput.vue","../src/utils/amap.ts","../src/components/InputMap/InputMap.vue","../src/components/AsyncCascader/AsyncCascader.vue","../src/components/AlCascaderMC/AlCascaderMC.vue","../src/utils/fullScreenImgByDom.ts","../src/components/UploadGroup/UploadGroup.vue","../src/components/MonthRange/MonthRange.vue","../src/components/EditorPro/EditorPro.vue","../src/components/FormR/ItemR.vue","../src/components/FormR/FormR.vue","../src/components/FormGroup/FormGroup.vue","../src/components/SearchForm/SearchForm.vue","../src/components/FormModal/FormModal.vue","../src/components/CheckboxTree/CheckboxTree.vue","../src/components/TransferBox/TransferBox.vue","../src/components/CheckboxGroupTwoClass/CheckboxGroupTwoClass.vue","../src/components/CheckboxGroupThreeClass/CheckboxGroupThreeClass.vue","../src/components/WellCard/WellCard.vue","../src/components/SelectScrollMore/SelectScrollMore.vue","../src/utils/tablePrint/PrintModal.vue","../src/utils/tablePrint/index.ts","../src/utils/domPrint.ts","../src/utils/fullScreenImgPreview.ts","../src/utils/wangeditor5init.ts","../src/index.ts"],"sourcesContent":["export default {\r\n\tr: {\r\n\t\tlocale: 'zh-CN',\r\n\t\ttestMsg: '测试国际化',\r\n\t\tconfirm: '确定',\r\n\t\tsave: '保存',\r\n\t\tcancel: '取消',\r\n\t\tclear: '清空',\r\n\t\tinfo: {\r\n\t\t\ttitle: '提示',\r\n\t\t\ttext: '确定执行该操作？'\r\n\t\t},\r\n\t\thttp: {\r\n\t\t\t403: '登录状态失效,请重新登录！',\r\n\t\t\t409: '该账号已在其他地方登录,点击确定退出。'\r\n\t\t},\r\n\t\tpSelect: '请选择',\r\n\t\tpInput: '请输入',\r\n\t\tselectDate: '选择日期',\r\n\t\tselectTime: '选择时间',\r\n\t\tsearch: '搜索',\r\n\t\tlevel: {\r\n\t\t\t1: '一级',\r\n\t\t\t2: '二级',\r\n\t\t\t3: '三级'\r\n\t\t},\r\n\t\tunknown: '未知',\r\n\t\ttitle: '标题',\r\n\t\trequired: '该项为必填',\r\n\t\tback: '返回',\r\n\t\tbutton: '按钮',\r\n\t\tcheck: '查询',\r\n\t\tadSearch: '高级查询',\r\n\t\tall: '全选',\r\n\t\ttabSetting: ' 列表显示设置',\r\n\t\tdelete: '删除',\r\n\t\tfView: '全屏预览',\r\n\t\tdownload: '点击下载',\r\n\t\tfile: '文件',\r\n\t\tselectFile: '选择文件',\r\n\t\tnotImg: '文件不是图片，不可预览',\r\n\t\twrongFileType: '文件类型不被允许',\r\n\t\tsupportType: '支持类型：',\r\n\t\tnone: '无',\r\n\t\tfileIsBig: '文件过大',\r\n\t\tsupportSize: '支持最大：',\r\n\t\tuploadError: '上传出错',\r\n\t\tuploadFail: '上传失败',\r\n\t\tclosePreview: '关闭预览',\r\n\t\tfullImg: '该文件不支持图片形式预览',\r\n\t\tpreview: '预览',\r\n\t\tsearchFor: '当前搜索：',\r\n\t\tnoMore: '没有更多数据了',\r\n\t\toptionLabel: '选项',\r\n\t\tgetDataError: '拉取数据出错',\r\n\t\tadd: '添加',\r\n\t\tremove: '移除',\r\n\t\taddAll: '全部添加',\r\n\t\tremoveAll: '全部移除',\r\n\t\tadded: '已添加',\r\n\t\tnotAdded: '未添加',\r\n\t\tsuccess: '成功',\r\n\t\tfailed: '失败',\r\n\t\terror: '出错',\r\n\t\tpageNotFound: '页面没找到',\r\n\t\tnotFoundMsg: '您访问的页面不存在，点击下面按钮返回上一个页面。',\r\n\t\thideMenu: '隐藏菜单',\r\n\t\tshowMenu: '显示菜单',\r\n\t\tprint: '打印',\r\n\t\tclose: '关闭',\r\n\t\thelp: '帮助',\r\n\t\tprintGuide: {\r\n\t\t\t1: '鼠标停留在表头列右边框，出现拖动图标，按下鼠标拖动可设置列宽。',\r\n\t\t\t2: '点击“列表显示设置”，可选择需要打印的列，选择完需点击“确定”按钮。',\r\n\t\t\t3: '页面有A4灰色参考线，将打印内容右边缘调至参考线区间，打印机默认设置时可将表格内容铺满A4纸，表格越宽字体将越小。',\r\n\t\t\t4: '将此页面地址复制到浏览器地址栏，打开的页面将不可用。',\r\n\t\t\t5: '未到此线内容将无法铺满纸张',\r\n\t\t\t6: '超过此线打印内容将不完整',\r\n\t\t\t7: 'A4 纵向参考线',\r\n\t\t\t8: 'A4 横向参考线',\r\n\t\t\t9: '复制的页面无法使用该打印功能。',\r\n\t\t\t10: '鼠标停留在打印内容顶部矩形条右边框，出现拖动图标，按下鼠标拖动可设置打印内容宽度。'\r\n\t\t},\r\n\t\tpage: '条/页',\r\n\t\ttotal: '共',\r\n\t\titems: '条',\r\n\t\tnotSave: '您未保存，是否保存？',\r\n\t\tlast: '上一张',\r\n\t\tnext: '下一张'\r\n\t}\r\n}\r\n","/**\r\n * @description 国际化\r\n * @author Ricky email:zhangqingcq@foxmail.com\r\n * @created 2023.04.27\r\n */\r\n\r\n/**\r\n * t('XXX',...arg)\r\n *  去掉XXX中双花括号，或替换%{XXX}为arg[XXX]，arg为t('XXX',...arg)中arg\r\n *  如果XXX没有花括号，则返回XXX本身\r\n */\r\n\r\nconst REG_NAME = /(%|){([0-9a-zA-Z_]+)}/g\r\n\r\nexport default function () {\r\n\tfunction hasOwn(obj: any, key: keyof any) {\r\n\t\treturn Object.prototype.hasOwnProperty.call(obj, key)\r\n\t}\r\n\r\n\t/**\r\n\t * template\r\n\t *\r\n\t * @param {String} string\r\n\t * @param {Array} a\r\n\t * @return {String}\r\n\t */\r\n\r\n\tfunction template(string: string, ...a: any[]) {\r\n\t\tlet args: any\r\n\t\tif (a.length === 1 && typeof a[0] === 'object') {\r\n\t\t\targs = a[0]\r\n\t\t}\r\n\r\n\t\tif (!args || !args.hasOwnProperty) {\r\n\t\t\targs = {}\r\n\t\t}\r\n\t\tif (string === undefined) {\r\n\t\t\treturn ''\r\n\t\t}\r\n\r\n\t\treturn string.replace(REG_NAME, (match, prefix, i, index) => {\r\n\t\t\tlet result\r\n\r\n\t\t\tif (string[index - 1] === '{' && string[index + match.length] === '}') {\r\n\t\t\t\treturn i\r\n\t\t\t} else {\r\n\t\t\t\tresult = hasOwn(args, i) ? args[i] : null\r\n\r\n\t\t\t\treturn result ?? ''\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\treturn template\r\n}\r\n","/**\r\n * @description 国际化\r\n * @author Ricky email:zhangqingcq@foxmail.com\r\n * @created 2023.04.27\r\n */\r\nimport deepmerge from 'deepmerge'\r\nimport zhLang from './lang/zh-CN'\r\nimport Format from './format'\r\n\r\nconst format = Format()\r\nlet lang: Record<keyof any, any> = zhLang\r\nconst message: Record<string, any> = {\r\n\tzh: zhLang\r\n}\r\nlet nowLang: Record<keyof any, any>\r\nlet merged: Record<string, any> = {}\r\nlet vueI18n: Record<keyof any, any>\r\nlet i18nHandler = function (this: any, path: string, options?: Record<keyof any, any> | Array<string | number>) {\r\n\tif (typeof this === 'object' && Reflect.has(this, '$t')) {\r\n\t\treturn this.$t(path, options)\r\n\t}\r\n\tif (vueI18n && vueI18n.global) {\r\n\t\treturn vueI18n.global.t(path, options)\r\n\t}\r\n\tif (vueI18n && vueI18n.locale) {\r\n\t\tif (!merged[vueI18n.locale] || nowLang != vueI18n.locale) {\r\n\t\t\tmerged[vueI18n.locale] = true\r\n\t\t\tlet localMessage = vueI18n.getLocaleMessage(vueI18n.locale) || {}\r\n\t\t\tlet newLocalMessage: Record<keyof any, any> = deepmerge(message[vueI18n.locale], localMessage, { clone: true })\r\n\t\t\tlang = newLocalMessage\r\n\t\t\tvueI18n.setLocaleMessage(vueI18n.locale, newLocalMessage)\r\n\t\t\tnowLang = vueI18n.locale\r\n\t\t}\r\n\t\treturn vueI18n.hlang(path, options)\r\n\t}\r\n}\r\n\r\nexport const t = function (this: any, path: string, options?: Record<keyof any, any> | Array<string | number>) {\r\n\tlet value = i18nHandler.apply(this, [path, options])\r\n\tif (value !== null && value !== undefined) {\r\n\t\treturn value\r\n\t}\r\n\r\n\tconst array = path.split('.')\r\n\tlet current = lang\r\n\r\n\tfor (let i = 0, j = array.length; i < j; i++) {\r\n\t\tconst property = array[i]\r\n\t\tvalue = current[property]\r\n\t\tif (i === j - 1) {\r\n\t\t\treturn format(value, options)\r\n\t\t}\r\n\t\tif (!value) {\r\n\t\t\treturn ''\r\n\t\t}\r\n\t\tcurrent = value\r\n\t}\r\n\treturn ''\r\n}\r\n\r\nexport const use = function (l: Record<keyof any, any>) {\r\n\tlang = l || lang\r\n}\r\n\r\nexport const i18n = function (initI18n: Record<keyof any, any>) {\r\n\tvueI18n = initI18n\r\n}\r\n\r\nexport default {\r\n\tuse,\r\n\tt,\r\n\ti18n\r\n}\r\n","import { t } from './index'\r\nimport { getCurrentInstance } from 'vue'\r\n\r\nexport default function (path: string, options?: Record<keyof any, any> | Array<string | number>) {\r\n\tconst proxy = getCurrentInstance()?.appContext?.config?.globalProperties\r\n\treturn t.apply(proxy, [path, options])\r\n}\r\n","<!--HeaderBt header右侧按钮，和header同高，左侧带白色分割线，按钮内容直接写在标签内\r\n@created 2023.05.11\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script setup lang=\"ts\">\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\ticon?: string\r\n\t\t\twithIcon?: boolean\r\n\t\t\ticonSize?: number | string\r\n\t\t\tcolor?: string\r\n\t\t\tborderColor?: string\r\n\t\t\tdisabled?: boolean\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\twithIcon: false,\r\n\t\t\ticonSize: 18,\r\n\t\t\tcolor: 'inherit',\r\n\t\t\tborderColor: '#fff',\r\n\t\t\tdisabled: false\r\n\t\t}\r\n\t)\r\n\r\n\tconst emit = defineEmits(['click'])\r\n\r\n\tfunction click() {\r\n\t\tif (props.disabled) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\temit('click')\r\n\t}\r\n</script>\r\n\r\n<template>\r\n\t<div\r\n\t\t:class=\"{ headerBtCTM: true, withIconCTM: props.icon || props.withIcon, disabled: props.disabled }\"\r\n\t\t:style=\"{ color: props.color, borderLeftColor: props.borderColor }\"\r\n\t\t@click=\"click\"\r\n\t>\r\n\t\t<Icon v-if=\"props.icon\" :size=\"props.iconSize\" :type=\"props.icon\" />\r\n\t\t<slot></slot>\r\n\t</div>\r\n</template>\r\n","import type { ComponentInternalInstance } from 'vue'\r\nimport { getCurrentInstance } from 'vue'\r\n\r\nexport default function () {\r\n\tconst { appContext } = getCurrentInstance() as ComponentInternalInstance\r\n\treturn appContext.config.globalProperties\r\n}\r\n","<!--FullPop “全屏”弹出页（绝对定位，和最近一个relative元素大小一致），自带header，提供方法开关页面\r\n@created 2023.05.11\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script setup lang=\"ts\">\r\n\timport t from '../../locale/i18nSFC'\r\n\timport HeaderBt from '../HeaderBt/HeaderBt.vue'\r\n\timport Proxy from '../../utils/proxy'\r\n\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\ttitle?: string\r\n\t\t\theaderColor?: string\r\n\t\t\theaderBg?: string\r\n\t\t\theaderFontSize?: number | string\r\n\t\t\tzIndex?: number\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\theaderFontSize: () => Proxy()?.fontSizeBase,\r\n\t\t\tzIndex: 1000\r\n\t\t}\r\n\t)\r\n\r\n\tconst emit = defineEmits(['on-open', 'on-close'])\r\n\r\n\tlet showPop = ref(false)\r\n\r\n\tconst hFontSize = computed(() => {\r\n\t\tif (typeof props.headerFontSize === 'number') {\r\n\t\t\treturn props.headerFontSize + 'px'\r\n\t\t}\r\n\t\treturn props.headerFontSize\r\n\t})\r\n\r\n\tconst popStyle = computed(() => {\r\n\t\treturn { zIndex: props.zIndex }\r\n\t})\r\n\r\n\tfunction open() {\r\n\t\tshowPop.value = true\r\n\t\temit('on-open')\r\n\t}\r\n\r\n\tfunction close(getData?: boolean) {\r\n\t\tshowPop.value = false\r\n\t\temit('on-close', getData === true)\r\n\t}\r\n\r\n\tdefineExpose({\r\n\t\topen,\r\n\t\tclose\r\n\t})\r\n</script>\r\n\r\n<template>\r\n\t<div v-show=\"showPop\" class=\"fullScreenPopBoxAM\" :style=\"popStyle\">\r\n\t\t<div class=\"headerAM\" :style=\"{ color: props.headerColor, backgroundColor: props.headerBg, fontSize: hFontSize }\">\r\n\t\t\t<!--这是标题-->\r\n\t\t\t<span class=\"headerTxtAM\">{{ title || t('r.title') }}</span>\r\n\t\t\t<!--这是返回按钮-->\r\n\t\t\t<HeaderBt icon=\"md-return-left\" @click=\"close\">{{ t('r.back') }}</HeaderBt>\r\n\t\t</div>\r\n\t\t<div class=\"contentAM\">\r\n\t\t\t<slot></slot>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n","<!--Hello\r\n@created 2023.04.27\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script setup lang=\"ts\">\r\n\tlet msg = ref('Greetings from Ricky.')\r\n</script>\r\n\r\n<template>\r\n\t<span class=\"msg\">{{ msg }}</span>\r\n</template>\r\n","<!--IconTxtBtn 表格顶部带图标的文字按钮（批量操作等），集成了权限v-has(自定义指令)，可指定图标、大小、按钮文字内容，可禁用\r\n@created 2023.07.19\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script lang=\"ts\" setup>\r\n\timport t from '../../locale/i18nSFC'\r\n\timport Proxy from '../../utils/proxy'\r\n\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\tname: string\r\n\t\t\ticon?: string\r\n\t\t\tsize?: number\r\n\t\t\tdisabled?: boolean\r\n\t\t\thas?: string\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\ticon: 'md-download',\r\n\t\t\tsize: () => Proxy().iconTxtBtnIconSize,\r\n\t\t\tdisabled: false,\r\n\t\t\thas: ''\r\n\t\t}\r\n\t)\r\n\tconst emit = defineEmits(['click'])\r\n\r\n\tconst txtSize = computed(() => Math.floor((props.size / 17) * Proxy()?.fontSizeBase) + 'px')\r\n\r\n\tfunction click(e: any) {\r\n\t\tif (props.disabled) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\temit('click', e)\r\n\t}\r\n</script>\r\n\r\n<template>\r\n\t<div\r\n\t\tclass=\"tabTopBtnsT\"\r\n\t\t@click=\"click\"\r\n\t\tv-has=\"has\"\r\n\t\t:class=\"{ disabled: props.disabled }\"\r\n\t\t:style=\"{ 'font-size': txtSize }\"\r\n\t>\r\n\t\t<Icon :type=\"props.icon\" :size=\"props.size\" />\r\n\t\t{{ props.name || t('r.button') }}\r\n\t</div>\r\n</template>\r\n","<!--Page404 404页面\r\n@created 2023.06.12\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script setup lang=\"ts\">\r\n\timport type { Router } from 'vue-router'\r\n\timport t from '../../locale/i18nSFC'\r\n\r\n\tconst instance = getCurrentInstance()!\r\n\tconst router = instance.appContext.config.globalProperties.$router as Router\r\n\r\n\tfunction back() {\r\n\t\trouter.go(-1)\r\n\t}\r\n</script>\r\n\r\n<template>\r\n\t<div class=\"c404K\">\r\n\t\t<div class=\"t404\">404</div>\r\n\t\t<div class=\"ct404\">UH OH! {{ t('r.pageNotFound') }}</div>\r\n\t\t<div class=\"p404\">{{ t('r.notFoundMsg') }}</div>\r\n\r\n\t\t<Button class=\"bt404\" @click=\"back\">{{ t('r.back') }}</Button>\r\n\t</div>\r\n</template>\r\n","/**\r\n * @description 提示框\r\n * @author ricky zhangqingcq@foxmail.com\r\n * @created 2023.05.08\r\n */\r\n\r\nimport swal from 'sweetalert'\r\nimport { myTypeof } from './globalFunc'\r\nimport { t } from '../locale'\r\n\r\ntype ButtonC = { text?: string; className?: string; value?: boolean | null; visible?: boolean }\r\ntype ButtonS = { cancel: ButtonC; confirm: ButtonC }\r\n\r\n/**\r\n * $swal实例\r\n * @param {object|string|boolean} option object:{title:'标题',content(or text):'内容，可以为空',type(or icon):'success(or error\r\n *   or warning)'}---string:'标题'---boolean:关闭$swal窗体\r\n * @param {string|HTMLElement} [text] 当option为object时不传此变量，当option为string时该变量为'内容'\r\n * @param {string} [icon] 当option为object时不传此变量，当option为string时该变量为弹出框类型'success'/'error'/'warning'\r\n * @param {boolean} [closeOnClickOutside] 点击外部关闭，默认：true\r\n */\r\nexport default function $swal(\r\n\tthis: any,\r\n\toption:\r\n\t\t| string\r\n\t\t| {\r\n\t\t\t\ttitle?: string\r\n\t\t\t\tcontent?: string\r\n\t\t\t\ttext?: string | HTMLElement\r\n\t\t\t\ttype?: string\r\n\t\t\t\ticon?: string\r\n\t\t\t\tonOk?: () => void\r\n\t\t\t\tclassName?: string\r\n\t\t\t\tbuttons?: ButtonS | Array<string>\r\n\t\t\t\tcloseOnClickOutside?: boolean\r\n\t\t  }\r\n\t\t| boolean,\r\n\ttext?: string | HTMLElement,\r\n\ticon?: string,\r\n\tcloseOnClickOutside: boolean = true\r\n) {\r\n\tconst T = (...arg: Parameters<typeof t>) => t.apply(this, arg)\r\n\r\n\treturn new Promise((r, j) => {\r\n\t\tif (typeof option === 'object' && !Array.isArray(option)) {\r\n\t\t\tlet okTxt = T('r.confirm')\r\n\t\t\tlet cancelTxt = T('r.cancel')\r\n\t\t\tlet cancelVisible = false\r\n\t\t\tlet okClass = 'swalConfirmBt'\r\n\t\t\tlet cancelClass = 'swalCancelBt'\r\n\t\t\tconst reg = /^HTML.*Element$/\r\n\r\n\t\t\toption.type && (option.icon = option.type) && delete option.type\r\n\t\t\toption.content && (option.text = option.content) && delete option.content\r\n\t\t\toption.className = option.className || 'swalBoxX'\r\n\r\n\t\t\tlet t = ''\r\n\t\t\tif (option.text && reg.test(myTypeof(option.text))) {\r\n\t\t\t\tt = 'content'\r\n\t\t\t} else if (option.text && myTypeof(option.text) === 'String') {\r\n\t\t\t\tt = 'text'\r\n\t\t\t}\r\n\r\n\t\t\tif (option.buttons) {\r\n\t\t\t\tif (typeof option.buttons === 'object' && !Array.isArray(option.buttons)) {\r\n\t\t\t\t\tif (option.buttons.cancel) {\r\n\t\t\t\t\t\toption.buttons.cancel.text && (cancelTxt = option.buttons.cancel.text) && (cancelVisible = true)\r\n\t\t\t\t\t\toption.buttons.cancel.className && (cancelClass = option.buttons.cancel.className)\r\n\r\n\t\t\t\t\t\toption.buttons.confirm.text && (okTxt = option.buttons.confirm.text)\r\n\t\t\t\t\t\toption.buttons.confirm.className && (okClass = option.buttons.confirm.className)\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (Array.isArray(option.buttons)) {\r\n\t\t\t\t\tif (option.buttons[0]) {\r\n\t\t\t\t\t\tcancelTxt = option.buttons[0]\r\n\t\t\t\t\t\tcancelVisible = true\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (option.buttons[1]) {\r\n\t\t\t\t\t\tokTxt = option.buttons[1]\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tswal({\r\n\t\t\t\ttitle: option.title,\r\n\t\t\t\ticon: option.icon,\r\n\t\t\t\tclassName: option.className,\r\n\t\t\t\t[t]: option.text,\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tconfirm: {\r\n\t\t\t\t\t\ttext: okTxt,\r\n\t\t\t\t\t\tvalue: true,\r\n\t\t\t\t\t\tvisible: true,\r\n\t\t\t\t\t\tclassName: okClass\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcancel: {\r\n\t\t\t\t\t\ttext: cancelTxt,\r\n\t\t\t\t\t\tvalue: null,\r\n\t\t\t\t\t\tvisible: cancelVisible,\r\n\t\t\t\t\t\tclassName: cancelClass\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcloseOnClickOutside: option.closeOnClickOutside ?? true\r\n\t\t\t})\r\n\t\t\t\t.then((res) => {\r\n\t\t\t\t\tif (res && typeof option.onOk === 'function') {\r\n\t\t\t\t\t\toption.onOk()\r\n\t\t\t\t\t}\r\n\t\t\t\t\tr(res)\r\n\t\t\t\t})\r\n\t\t\t\t.catch((err) => {\r\n\t\t\t\t\tj(err)\r\n\t\t\t\t})\r\n\t\t} else if (typeof option === 'string') {\r\n\t\t\tlet t = ''\r\n\t\t\tif (text) {\r\n\t\t\t\tswitch (typeof text) {\r\n\t\t\t\t\tcase 'string':\r\n\t\t\t\t\t\tt = 'text'\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\tcase 'object':\r\n\t\t\t\t\t\tt = 'content'\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tswal({\r\n\t\t\t\ttitle: option,\r\n\t\t\t\t[t]: text || '',\r\n\t\t\t\ticon: icon || '',\r\n\t\t\t\tclassName: 'swalBoxX',\r\n\t\t\t\tcloseOnClickOutside: closeOnClickOutside,\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tconfirm: {\r\n\t\t\t\t\t\ttext: T('r.confirm'),\r\n\t\t\t\t\t\tvalue: true,\r\n\t\t\t\t\t\tvisible: true,\r\n\t\t\t\t\t\tclassName: 'swalConfirmBt',\r\n\t\t\t\t\t\tcloseModal: true\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t\t.then((res) => {\r\n\t\t\t\t\tr(res)\r\n\t\t\t\t})\r\n\t\t\t\t.catch((err) => {\r\n\t\t\t\t\tj(err)\r\n\t\t\t\t})\r\n\t\t} else if (typeof option === 'boolean') {\r\n\t\t\tif (!option && swal.close) {\r\n\t\t\t\tswal.close()\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthrow new TypeError('swal第一个参数类型有误，仅支持Object/String/false')\r\n\t\t}\r\n\t})\r\n}\r\n","<script setup lang=\"ts\">\r\n\timport { debounce } from 'lodash-es'\r\n\timport { Tooltip } from 'view-ui-plus'\r\n\r\n\tconst props = defineProps<{ content?: string | number | boolean | null }>()\r\n\tconst spanRef = ref()\r\n\tconst contentRef = ref()\r\n\r\n\tconst tooltipDisabled = ref(true)\r\n\tlet debounceFunc: any = null\r\n\tconst maxWidth = ref(200)\r\n\r\n\tfunction getSize() {\r\n\t\tconst $span = tooltipDisabled.value ? spanRef.value : contentRef.value\r\n\t\tif (!$span) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tlet range: any = document.createRange()\r\n\t\trange.setStart($span, 0)\r\n\t\trange.setEnd($span, $span.childNodes.length)\r\n\t\tconst rangeWidth = range.getBoundingClientRect().width\r\n\t\tmaxWidth.value = $span.offsetWidth * 2\r\n\t\ttooltipDisabled.value = rangeWidth < $span.offsetWidth\r\n\r\n\t\trange = null\r\n\t}\r\n\r\n\tonMounted(() => {\r\n\t\tgetSize()\r\n\r\n\t\tdebounceFunc = debounce(() => {\r\n\t\t\tnextTick(function () {\r\n\t\t\t\tgetSize()\r\n\t\t\t})\r\n\t\t}, 200)\r\n\r\n\t\twindow.addEventListener('resize', debounceFunc)\r\n\t})\r\n\r\n\tonUpdated(getSize)\r\n\r\n\tonUnmounted(() => {\r\n\t\twindow.removeEventListener('resize', debounceFunc)\r\n\t})\r\n</script>\r\n\r\n<template>\r\n\t<div class=\"tableTooltip\">\r\n\t\t<span ref=\"spanRef\" v-if=\"tooltipDisabled\" class=\"contentText\">{{ props.content }}</span>\r\n\t\t<Tooltip\r\n\t\t\tv-else\r\n\t\t\t:content=\"typeof props.content === 'boolean' ? String(props.content) : props.content ?? ''\"\r\n\t\t\t:max-width=\"maxWidth\"\r\n\t\t\ttransfer\r\n\t\t>\r\n\t\t\t<span ref=\"contentRef\" class=\"contentText\">{{ props.content }}</span>\r\n\t\t</Tooltip>\r\n\t</div>\r\n</template>\r\n","/**\r\n * @description 全局公共方法集合，挂在app.config.globalProperties下(按需引入模式下除外)，组合式开发模式下推荐单独引用 import {xxx} from\r\n *   '@zhangqingcq/plug-r-qw'\r\n * @author ricky zhangqingcq@foxmail.com\r\n * @created 2023.07.14\r\n */\r\nimport { h, isRef } from 'vue'\r\nimport type { Collection, PlainObject, PredicateFunc } from '../public'\r\nimport { isPlainObject } from 'lodash-es'\r\nimport $swal from './swal'\r\nimport TableTooltip from '../components/TableTooltip/TableTooltip.vue'\r\n\r\nexport const isClient = typeof window !== 'undefined'\r\n\r\nexport function setValue(target: any, value: any) {\r\n\tif (isRef(target)) {\r\n\t\ttarget.value = value\r\n\t} else {\r\n\t\ttarget = value\r\n\t}\r\n}\r\n\r\nexport function myTypeof(v: any): string {\r\n\tlet str = Object.prototype.toString.call(v)\r\n\treturn str.replace(/\\[object |]/g, '')\r\n}\r\n\r\nexport function has(v: string) {\r\n\treturn { style: { display: hasPermission(v) ? 'unset' : 'none' } }\r\n}\r\n\r\n// 驼峰转换下划线\r\nexport function toLine(name: string): string {\r\n\treturn name.replace(/([A-Z])/g, '_$1').toLowerCase()\r\n}\r\n\r\n/**\r\n * 去掉对象属性前后空格\r\n */\r\nexport function trimObj(obj: Collection): Collection {\r\n\tlet p = myTypeof(obj)\r\n\tif (p === 'Object') {\r\n\t\tfor (let key in obj) {\r\n\t\t\tif (obj.hasOwnProperty(key)) {\r\n\t\t\t\tlet o = myTypeof(obj[key])\r\n\t\t\t\tif (o === 'String') {\r\n\t\t\t\t\tobj[key] = obj[key].trim()\r\n\t\t\t\t} else if (o === 'Object' || o === 'Array') {\r\n\t\t\t\t\ttrimObj(obj[key])\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} else if (p === 'Array') {\r\n\t\tfor (let i = 0, l = obj.length; i < l; i++) {\r\n\t\t\tlet t = myTypeof(obj[i])\r\n\t\t\tif (t === 'String') {\r\n\t\t\t\tobj[i] = obj[i].trim()\r\n\t\t\t} else if (t === 'Array' || t === 'Object') {\r\n\t\t\t\ttrimObj(obj[i])\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn obj\r\n}\r\n\r\n/**\r\n * 清空集合\r\n * @param val 被清空的集合\r\n * @param ignoreList 不需要清理的字段集合\r\n * @return *\r\n */\r\nexport function clearObj(val: Collection, ignoreList: Array<keyof Collection | never> = []): Collection {\r\n\tif (myTypeof(val) === 'Array') {\r\n\t\tval.forEach((item: Collection, index: number) => {\r\n\t\t\tswitch (myTypeof(item)) {\r\n\t\t\t\tcase 'Array':\r\n\t\t\t\tcase 'Object':\r\n\t\t\t\t\tclearObj(item)\r\n\t\t\t\t\tbreak\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tval[index] = null\r\n\t\t\t}\r\n\t\t})\r\n\t\treturn val\r\n\t} else if (myTypeof(val) === 'Object') {\r\n\t\tfor (let key in val) {\r\n\t\t\tif (val.hasOwnProperty(key)) {\r\n\t\t\t\tlet go = true\r\n\t\t\t\tfor (let item of ignoreList) {\r\n\t\t\t\t\tif (item === key) {\r\n\t\t\t\t\t\tgo = false\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (go) {\r\n\t\t\t\t\tswitch (myTypeof(val[key])) {\r\n\t\t\t\t\t\tcase 'Array':\r\n\t\t\t\t\t\tcase 'Object':\r\n\t\t\t\t\t\t\tclearObj(val[key])\r\n\t\t\t\t\t\t\tbreak\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tval[key] = null\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn val\r\n\t} else {\r\n\t\treturn val\r\n\t}\r\n}\r\n\r\n/*以form-data方式提交请求数据时，$fetch的config参数值*/\r\nexport const formDataHeadConfig = {\r\n\theaders: {\r\n\t\t'Content-Type': 'multipart/form-data'\r\n\t}\r\n}\r\n\r\n/*将普通对象转换成form-data请求参数格式*/\r\nexport function toFormData(data: Record<string, any>): FormData {\r\n\tlet temp = new FormData()\r\n\tfor (let key in data) {\r\n\t\tif (data.hasOwnProperty(key) && data[key] !== null) {\r\n\t\t\ttemp.append(key, data[key])\r\n\t\t}\r\n\t}\r\n\treturn temp\r\n}\r\n\r\n/**\r\n * 在目标集合中按条件查找或直接查找，返回第一个满足条件的元素或路径\r\n * 与findPath不同，这里的路径是完整路径（findPath省略了一些标准结构中间路径），找不到返回：false\r\n * @param {array|object} group 被查找的集合\r\n * @param {Function|string|number|boolean} condition 查找的条件或值\r\n * @param {boolean} [getPath] 是否返回路径，默认为：false，返回找到的元素\r\n */\r\nexport function findCollection(\r\n\tgroup: Collection,\r\n\tcondition: PredicateFunc | string | number | boolean,\r\n\tgetPath: boolean = false\r\n) {\r\n\tif (!group || !condition) {\r\n\t\treturn false\r\n\t}\r\n\tlet PATH\r\n\tlet target: string | Collection = 'notFoundC'\r\n\tlet deepSearch: Function = function (group: Collection, condition: (e: any) => boolean) {\r\n\t\tif (Array.isArray(group)) {\r\n\t\t\tif (myTypeof(condition) === 'Function' && condition(group)) {\r\n\t\t\t\ttarget = group\r\n\t\t\t\treturn []\r\n\t\t\t}\r\n\t\t\tfor (let e of group) {\r\n\t\t\t\tif (target !== 'notFoundC') {\r\n\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t\tif ((myTypeof(condition) === 'Function' && condition(e)) || e === condition) {\r\n\t\t\t\t\ttarget = e\r\n\t\t\t\t\treturn [group.indexOf(e)]\r\n\t\t\t\t} else if (myTypeof(e) === 'Array' || myTypeof(e) === 'Object') {\r\n\t\t\t\t\tlet r = deepSearch(e, condition)\r\n\t\t\t\t\tif (r !== undefined) {\r\n\t\t\t\t\t\treturn [group.indexOf(e), ...r]\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (myTypeof(group) === 'Object') {\r\n\t\t\tif (myTypeof(condition) === 'Function' && condition(group)) {\r\n\t\t\t\ttarget = group\r\n\t\t\t\treturn []\r\n\t\t\t}\r\n\t\t\tfor (let key in group) {\r\n\t\t\t\tif (target !== 'notFoundC') {\r\n\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t\tif (group.hasOwnProperty(key)) {\r\n\t\t\t\t\tif ((myTypeof(condition) === 'Function' && condition(key)) || group[key] === condition) {\r\n\t\t\t\t\t\ttarget = group[key]\r\n\t\t\t\t\t\treturn [key]\r\n\t\t\t\t\t} else if (myTypeof(group[key]) === 'Object' || myTypeof(group[key]) === 'Array') {\r\n\t\t\t\t\t\tlet r = deepSearch(group[key], condition)\r\n\t\t\t\t\t\tif (r !== undefined) {\r\n\t\t\t\t\t\t\treturn [key, ...r]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tPATH = deepSearch(group, condition)\r\n\tif (getPath) {\r\n\t\treturn PATH || false\r\n\t}\r\n\treturn target === 'notFoundC' ? false : target\r\n}\r\n\r\n/*判断某个值是否在集合中*/\r\nexport function oneOf(value: any, validList: any[]) {\r\n\tfor (let i = 0, l = validList.length; i < l; i++) {\r\n\t\tif (value === validList[i]) {\r\n\t\t\treturn true\r\n\t\t}\r\n\t}\r\n\treturn false\r\n}\r\n\r\n/**\r\n * 小数位数限制，超出会返回被去掉后的值\r\n * @param val 原来的值\r\n * @param num 小数点后的位数，默认：2\r\n * @return {number|*}\r\n */\r\nexport function decimalDigitsLimit(val: number | string, num: number = 2): string | number {\r\n\tlet expStr = new RegExp(`(^-?\\\\d+\\\\.\\\\d{${num}})(\\\\d+$)`)\r\n\tlet valStr = (val && String(val)) || ''\r\n\tif (expStr.test(valStr)) {\r\n\t\treturn Number(valStr.replace(expStr, '$1'))\r\n\t}\r\n\treturn val\r\n}\r\n\r\n/*文件导出，调用后端接口以form表单提交数据下载文件*/\r\nexport function downloadFileByFormSubmit(url: string, data: PlainObject = {}, method: string = 'get'): void {\r\n\tlet form = document.createElement('form')\r\n\tlet body = document.getElementsByTagName('body')[0]\r\n\tbody.appendChild(form)\r\n\tform.setAttribute('style', 'display:none')\r\n\tform.setAttribute('target', '')\r\n\tform.setAttribute('method', method)\r\n\tlet _url = url\r\n\tif (window && window.hasOwnProperty('g')) {\r\n\t\t/*所有特定缩写字母开头的地址，都会被改变加上config.js（public里的全局配置文件，在index.html引入，在打包后通过更改该文件用于不\r\n\t\t 同环境的部署）里配置的地址变成绝对地址，如:\r\n\t\t config.js里配置了 window.g={mgrURL:'http://mgr.myweb.com'}\r\n\t\t 请求地址 ‘/mgr/file’ 会被改变为 'http://mgr.myweb.com/file'\r\n\t\t */\r\n\t\t// @ts-ignore\r\n\t\tlet httpEnv = Object.keys(window.g)\r\n\t\t\t.filter((e) => e?.indexOf?.('URL') > -1)\r\n\t\t\t.map((e) => e.replace?.('URL', ''))\r\n\r\n\t\tfor (let item of httpEnv) {\r\n\t\t\tlet regExp = new RegExp('^/' + item + '(?=/.*$)', 'i')\r\n\t\t\t// @ts-ignore\r\n\t\t\tif (regExp.test(url) && window.g[item + 'URL']) {\r\n\t\t\t\t// @ts-ignore\r\n\t\t\t\t_url = window.g[item + 'URL'] + url.replace(regExp, '')\r\n\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tform.setAttribute('action', _url)\r\n\r\n\tif (isPlainObject(data)) {\r\n\t\tfor (let key in data) {\r\n\t\t\tif (data.hasOwnProperty(key) && (data[key] || data[key] === 0 || data[key] === false || data[key] === '')) {\r\n\t\t\t\tlet input = document.createElement('input')\r\n\t\t\t\tinput.setAttribute('type', 'hidden')\r\n\t\t\t\tinput.setAttribute('name', key)\r\n\t\t\t\tinput.setAttribute('value', data[key])\r\n\t\t\t\tform.appendChild(input)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tform.submit()\r\n\r\n\t\tlet ta: any = setTimeout(() => {\r\n\t\t\tbody.removeChild(form)\r\n\t\t\tclearTimeout(ta)\r\n\t\t\tta = null\r\n\t\t}, 8000)\r\n\t} else {\r\n\t\tconsole.error('请求数据格式有误，无法下载文件')\r\n\t}\r\n}\r\n\r\n/**\r\n * 文件导出功能（调用文件下载方法downloadFileByFormSubmit）\r\n * @param url 导出路径\r\n * @param data 参数\r\n * @param method 请求方式\r\n */\r\nexport function fileExport(this: any, url: string, data: PlainObject = {}, method: string = 'get'): void {\r\n\tif (\r\n\t\tdata.hasOwnProperty('columns') &&\r\n\t\t(data['columns'] === '' || data['columns'] === null || data['columns'] === undefined)\r\n\t) {\r\n\t\t$swal.call(this, {\r\n\t\t\ttitle: '需要导出的列不能为空',\r\n\t\t\ttype: 'warning'\r\n\t\t})\r\n\t\treturn\r\n\t}\r\n\tdownloadFileByFormSubmit(url, data, method)\r\n}\r\n\r\n/**\r\n * 依据列显示设置缓存获取columns的key的集合\r\n * @param {String} sKey - 列显示设置插件的sKey\r\n * @param {Array} columns - 表格table的columns\r\n * @param {Boolean} returnArray - 是否返回数组，默认值false,返回String\r\n * */\r\nexport function getColumnsKeys(sKey: string, columns: any[], returnArray: boolean = false): string | string[] {\r\n\tlet temp\r\n\tif (sKey && myTypeof(columns) === 'Array') {\r\n\t\tlet names = localStorage.getItem(sKey)\r\n\t\tif (names) {\r\n\t\t\tlet t = JSON.parse(decodeURI(names))\r\n\t\t\ttemp = columns.filter((e) => e?.key && t?.indexOf?.(e.title) !== -1).map((e) => e.key)\r\n\t\t} else {\r\n\t\t\ttemp = columns.map((e) => e?.key)\r\n\t\t}\r\n\t} else {\r\n\t\ttemp = []\r\n\t}\r\n\tif (!returnArray) {\r\n\t\ttemp = String(temp)\r\n\t}\r\n\treturn temp\r\n}\r\n\r\n/**\r\n * 判断一个值是否为有效值，有效值：不为空即为有效\r\n * @param val 需要判断的值\r\n * @returns {boolean}\r\n */\r\nexport function isValidValue(val: any): boolean {\r\n\treturn val !== undefined && val !== null && val !== ''\r\n}\r\n\r\nexport function isNumberValue(val: any): boolean {\r\n\tconst reg = /^-?\\d+(.\\d+)?$/\r\n\treturn reg.test(val)\r\n}\r\n\r\n/**\r\n * 手动tooltip(基于tableTooltip的高级表格内容展示，展示内容和形式更多样和合理)\r\n * tableTooltip: 替换view-design的Table的tooltip功能，只在内容会导致换行或显示不完整时渲染tooltip\r\n * @param {String/Array/Function} contentKey 要设置tooltip的column的key或者key组成的数组（内容按数组中key对应的内容先后拼接），\r\n * 或获取值的自定义逻辑（Function回调，会传入params）\r\n * @param {boolean} dash 在内容为空(null、undefined、'')时是否以'--'代替显示\r\n * @param {String} jointMark 在内容为多个字段拼接时，各字段间连接符，默认没有\r\n */\r\nexport function tooltipManual(\r\n\tcontentKey: string | string[] | ((params: any) => string),\r\n\tdash: boolean = false,\r\n\tjointMark: string = ''\r\n) {\r\n\treturn function (_h: any, params: any) {\r\n\t\tlet content: string\r\n\t\tif (Array.isArray(contentKey)) {\r\n\t\t\tlet temp: any[] = []\r\n\t\t\tfor (let item of contentKey) {\r\n\t\t\t\tif (isValidValue(params.row?.[item])) {\r\n\t\t\t\t\ttemp.push(params.row[item])\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcontent = temp.join(jointMark)\r\n\t\t} else if (typeof contentKey === 'function') {\r\n\t\t\tcontent = contentKey(params)\r\n\t\t} else {\r\n\t\t\tcontent = params.row?.[contentKey]\r\n\t\t}\r\n\r\n\t\treturn h(TableTooltip, { content: dash ? (content === '' ? '--' : content ?? '--') : content })\r\n\t}\r\n}\r\n\r\n/*判断集合（数组或对象）每个元素或单个变量是否是有效值*/\r\nexport function isEmptyValue(data: Collection): boolean {\r\n\tif (isPlainObject(data)) {\r\n\t\tfor (let key in data) {\r\n\t\t\tif (data.hasOwnProperty(key) && isValidValue(data[key])) {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true\r\n\t} else if (Array.isArray(data)) {\r\n\t\tfor (let item of data) {\r\n\t\t\tif (isValidValue(item)) {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true\r\n\t}\r\n\treturn !isValidValue(data)\r\n}\r\n\r\n/*获取字符串长度，中文2，其他1（一般用于用户输入长度限制）*/\r\nexport function stringLength(str: string): number {\r\n\tif (myTypeof(str) === 'String') {\r\n\t\treturn str.replace(/[^\\x00-\\xff]/g, '01').length\r\n\t} else if (myTypeof(str) === 'Number') {\r\n\t\tstr += ''\r\n\t\treturn str.replace(/[^\\x00-\\xff]/g, '01').length\r\n\t}\r\n\treturn 0\r\n}\r\n\r\n/**\r\n * 按条件设置集合中指定字段的值\r\n * @param {Object} option\r\n * @param {Array} option.group 目标集合\r\n * @param {Function} option.condition 匹配条件\r\n * @param {String} option.key 要设置的字段键名\r\n * @param  option.val 要设置的字段的值，或处理逻辑\r\n * @param {String} option.childKey 子集键名\r\n */\r\nexport function setValByOption({\r\n\tgroup,\r\n\tcondition,\r\n\tkey,\r\n\tval,\r\n\tchildKey = 'children'\r\n}: {\r\n\tgroup: Collection\r\n\tcondition: (item: any) => boolean\r\n\tkey: string\r\n\tval: any\r\n\tchildKey?: string\r\n}) {\r\n\tif (\r\n\t\tmyTypeof(group) !== 'Array' ||\r\n\t\tmyTypeof(condition) !== 'Function' ||\r\n\t\tmyTypeof(key) !== 'String' ||\r\n\t\tmyTypeof(childKey) !== 'String'\r\n\t) {\r\n\t\treturn false\r\n\t}\r\n\tgroup.forEach((item: any) => {\r\n\t\tif (condition(item)) {\r\n\t\t\tif (myTypeof(val) === 'Function') {\r\n\t\t\t\titem[key] = val(item[key])\r\n\t\t\t} else {\r\n\t\t\t\titem[key] = val\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (myTypeof(item[childKey]) === 'Array' && item[childKey].length > 0) {\r\n\t\t\tsetValByOption({\r\n\t\t\t\tgroup: item[childKey],\r\n\t\t\t\tcondition,\r\n\t\t\t\tkey,\r\n\t\t\t\tval,\r\n\t\t\t\tchildKey\r\n\t\t\t})\r\n\t\t}\r\n\t})\r\n}\r\n\r\n/**\r\n * 是否有该权限，用于权限管理\r\n * @param {String} value 权限代码\r\n * @returns {boolean}\r\n */\r\nexport function hasPermission(value: string): boolean {\r\n\tlet btnPermissions = sessionStorage.getItem('btnPermissions')\r\n\tif (btnPermissions) {\r\n\t\treturn btnPermissions.split(',').indexOf(value) > -1\r\n\t}\r\n\treturn false\r\n}\r\n\r\n/**\r\n * 判断一个变量是否是NaN\r\n * @param v 变量\r\n * @returns {boolean}\r\n */\r\nexport function isNaN(v: any): boolean {\r\n\treturn myTypeof(v) === 'Number' && String(v) === 'NaN'\r\n}\r\n\r\n/**\r\n *过滤对象属性或者将对象转换成url的query字符串\r\n * @param {Object} data 需要处理的对象\r\n * @param {Boolean} toUrl 是否需要转换成url，为false时可以不传\r\n * @param {Boolean} keepEmptyVal 是否保留空值（用于接口置空某个字段），为false时可以不传\r\n * @returns {*}\r\n * 注意：当toUrl=false且keepEmptyVal=true时，两个参数都传比较好\r\n */\r\n\r\nexport function dataFilterOrToUrl(\r\n\tdata: PlainObject,\r\n\ttoUrl: boolean = false,\r\n\tkeepEmptyVal: boolean = false\r\n): string | PlainObject {\r\n\tif (myTypeof(data) !== 'Object') {\r\n\t\treturn data\r\n\t}\r\n\tlet _data = Object.assign(data, {})\r\n\tlet url = ''\r\n\tfor (let key in _data) {\r\n\t\tif (_data.hasOwnProperty(key)) {\r\n\t\t\tlet val = _data[key]\r\n\t\t\tif (\r\n\t\t\t\tval === undefined ||\r\n\t\t\t\tval === '' ||\r\n\t\t\t\t(myTypeof(val) === 'String' && val.trim() === '') ||\r\n\t\t\t\tval === null ||\r\n\t\t\t\tisNaN(val)\r\n\t\t\t) {\r\n\t\t\t\tif (keepEmptyVal) {\r\n\t\t\t\t\tif (toUrl) {\r\n\t\t\t\t\t\turl += key + '=&'\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t_data[key] = ''\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdelete _data[key]\r\n\t\t\t\t}\r\n\t\t\t} else if (toUrl) {\r\n\t\t\t\turl += key + '=' + val + '&'\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (toUrl) {\r\n\t\tif (url.length > 0) {\r\n\t\t\treturn url.substring(0, url.length - 1)\r\n\t\t}\r\n\t\treturn ''\r\n\t}\r\n\treturn _data\r\n}\r\n\r\n/*过滤对象或数组中无效值*/\r\nexport function removeEmptyValue(data: Collection): Collection {\r\n\tlet temp: Collection = {}\r\n\tif (Array.isArray(data)) {\r\n\t\ttemp = []\r\n\t\tfor (let item of data) {\r\n\t\t\tif (Array.isArray(item) || isPlainObject(item)) {\r\n\t\t\t\ttemp.push(removeEmptyValue(item))\r\n\t\t\t} else if (isValidValue(item)) {\r\n\t\t\t\ttemp.push(item)\r\n\t\t\t}\r\n\t\t}\r\n\t} else if (isPlainObject(data)) {\r\n\t\tfor (let key in data) {\r\n\t\t\tif (data.hasOwnProperty(key)) {\r\n\t\t\t\tif (Array.isArray(data[key]) || isPlainObject(data[key])) {\r\n\t\t\t\t\ttemp[key] = removeEmptyValue(data[key])\r\n\t\t\t\t} else if (isValidValue(data[key])) {\r\n\t\t\t\t\ttemp[key] = data[key]\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn temp\r\n}\r\n\r\n/**\r\n *打印页面，根据后端所传递的数据生成\r\n * @param data\r\n * @return {Promise<any>}\r\n */\r\nexport function htmlPrint(data: string): void {\r\n\tconst pWin = window.open()\r\n\tif (pWin) {\r\n\t\tpWin.document.write(data)\r\n\t\tlet ta: any = setTimeout(() => {\r\n\t\t\tpWin.print()\r\n\t\t\twindow.clearTimeout(ta)\r\n\t\t\tta = null\r\n\t\t}, 10)\r\n\t}\r\n}\r\n\r\n/**\r\n * 查找dom元素所有兄弟\r\n * @param elem - 被查找的元素\r\n */\r\nexport function siblingElems(elem: ChildNode) {\r\n\tlet nodes: any[] = []\r\n\tlet _elem = elem\r\n\twhile (elem.previousSibling && (elem = elem.previousSibling)) {\r\n\t\tif (elem.nodeType === 1) {\r\n\t\t\tnodes.push(elem)\r\n\t\t}\r\n\t}\r\n\r\n\twhile (_elem.nextSibling && (_elem = _elem.nextSibling)) {\r\n\t\tif (_elem.nodeType === 1) {\r\n\t\t\tnodes.push(_elem)\r\n\t\t}\r\n\t}\r\n\treturn nodes\r\n}\r\n","<script lang=\"ts\" setup>\r\n\timport { siblingElems } from '../../utils/globalFunc'\r\n\r\n\tconst router = useRouter()\r\n\tconst props = withDefaults(defineProps<{ data?: any[]; pathName?: string }>(), {\r\n\t\tdata: () => [],\r\n\t\tpathName: ''\r\n\t})\r\n\r\n\tfunction getClass(item: any) {\r\n\t\treturn item?.path === props.pathName ? 'active' : ''\r\n\t}\r\n\r\n\tfunction handleClick(e: any, item: any) {\r\n\t\te?.preventDefault?.()\r\n\t\tlet target = e?.target\r\n\r\n\t\tif (item && !item.children && !target.classList.contains('active')) {\r\n\t\t\trouter.push(item.path)\r\n\t\t\treturn\r\n\t\t}\r\n\t\tlet parent = target.parentNode\r\n\t\tlet siblings = siblingElems(parent)\r\n\t\tfor (let item of siblings) {\r\n\t\t\titem?.classList?.remove?.('open') //手风琴效果\r\n\t\t\tconst child = item?.querySelectorAll?.('.open')\r\n\t\t\tif (child && Array.isArray(child)) {\r\n\t\t\t\tfor (let e of child) {\r\n\t\t\t\t\te?.classList?.remove?.('open')\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tparent?.classList?.toggle?.('open')\r\n\t}\r\n</script>\r\n<template>\r\n\t<ul class=\"groupBoxRP\">\r\n\t\t<template v-for=\"(item, i) of props.data\" :key=\"item?.path + i\">\r\n\t\t\t<li v-if=\"item\" :class=\"{ dropItemRP: item.children }\">\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"menuTxtR\"\r\n\t\t\t\t\t:class=\"getClass(item)\"\r\n\t\t\t\t\t@click=\"handleClick($event, item)\"\r\n\t\t\t\t\t:style=\"{ paddingLeft: item.level * 20 + 'px' }\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{{ item.name || '-- no name --' }}\r\n\t\t\t\t</div>\r\n\t\t\t\t<sideMenuGroup :data=\"item.children\" v-if=\"item.children\" :path-name=\"props.pathName\" />\r\n\t\t\t</li>\r\n\t\t</template>\r\n\t</ul>\r\n</template>\r\n","<!--SideMenu 侧边菜单，贴在父容器左侧，可向左将整个菜单收起\r\n@created 2023.07.17\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script lang=\"ts\" setup>\r\n\timport t from '../../locale/i18nSFC'\r\n\timport SideMenuGroup from './SideMenuGroup.vue'\r\n\r\n\tconst props = withDefaults(defineProps<{ data?: any[] }>(), { data: () => [] })\r\n\tconst emit = defineEmits(['on-change'])\r\n\tconst route = useRoute()\r\n\r\n\tconst menuDisplay = ref<boolean>(true)\r\n\tconst pathName = ref()\r\n\tconst menuRef = ref()\r\n\tconst titleC = computed(() => (menuDisplay.value ? t('r.hideMenu') : t('r.showMenu')))\r\n\tconst typeIco = computed(() => (menuDisplay.value ? 'ios-arrow-back' : 'ios-arrow-forward'))\r\n\r\n\tonBeforeMount(() => {\r\n\t\tlet t: string = localStorage.getItem('menuDisplayR') || ''\r\n\r\n\t\tif (t !== '') {\r\n\t\t\tmenuDisplay.value = JSON.parse(t)\r\n\t\t} else {\r\n\t\t\tmenuDisplay.value = true\r\n\t\t\tlocalStorage.setItem('menuDisplayR', JSON.stringify(true))\r\n\t\t}\r\n\t})\r\n\r\n\twatch(\r\n\t\t() => route.path,\r\n\t\t(after) => {\r\n\t\t\tpathName.value = after\r\n\t\t\tnextTick(addOpen)\r\n\t\t},\r\n\t\t{ immediate: true }\r\n\t)\r\n\r\n\tfunction showHideMenu() {\r\n\t\tmenuDisplay.value = !menuDisplay.value\r\n\t\tlocalStorage.setItem('menuDisplayR', JSON.stringify(menuDisplay.value))\r\n\t\temit('on-change', menuDisplay.value)\r\n\t}\r\n\r\n\tfunction addOpen() {\r\n\t\tlet t = menuRef.value.querySelectorAll('.dropItemRP')\r\n\t\tfor (let e of t) {\r\n\t\t\tif (e?.querySelector?.('.active') && !e.classList?.contains?.('open')) {\r\n\t\t\t\te.classList?.add?.('open')\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n<template>\r\n\t<div ref=\"menuRef\" class=\"menuBoxRP\">\r\n\t\t<div class=\"menuListR\" v-show=\"menuDisplay\">\r\n\t\t\t<side-menu-group :data=\"props.data\" :pathName=\"pathName\" />\r\n\t\t</div>\r\n\t\t<Icon\r\n\t\t\t:type=\"typeIco\"\r\n\t\t\t:size=\"25\"\r\n\t\t\t:class=\"{ showIco: !menuDisplay }\"\r\n\t\t\tclass=\"menuShowHideIco\"\r\n\t\t\t:title=\"titleC\"\r\n\t\t\t@click=\"showHideMenu\"\r\n\t\t\t:color=\"menuDisplay ? '#fff' : '#333'\"\r\n\t\t/>\r\n\t</div>\r\n</template>\r\n","<!--TableIconBtn 表格用图标按钮，集成了权限v-has(自定义指令)，可指定图标、大小、提示信息，可禁用\r\n@created 2023.07.20\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n<script lang=\"ts\" setup>\r\n\timport t from '../../locale/i18nSFC'\r\n\r\n\tconst emit = defineEmits(['click'])\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{ icon?: string; title?: string; has?: string; disabled?: boolean; size?: number }>(),\r\n\t\t{\r\n\t\t\ticon: 'md-radio-button-on',\r\n\t\t\thas: '',\r\n\t\t\tdisabled: false,\r\n\t\t\tsize: 24\r\n\t\t}\r\n\t)\r\n\r\n\tfunction onClick(e: any) {\r\n\t\tif (props.disabled) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\temit('click', e)\r\n\t}\r\n</script>\r\n\r\n<template>\r\n\t<div\r\n\t\tclass=\"tableBtnsG\"\r\n\t\t:class=\"{ disabled: props.disabled }\"\r\n\t\tv-has=\"props.has\"\r\n\t\t@click=\"onClick\"\r\n\t\t:title=\"props.title || t('r.button')\"\r\n\t>\r\n\t\t<Icon :type=\"props.icon\" :size=\"props.size\" />\r\n\t</div>\r\n</template>\r\n","<!--ShowHidePanel 收展面板，用于展示或收起表格页条件查询表单组\r\n@created 2023.07.20\r\n@author Ricky email:zhangqingcq@foxmail.com\r\n@params bg 例如：bg = '#fff' 或 bg = 'white' 不传为透明背景 (bg为自定义属性，控制该组件背景色) <show-hide-panel bg=\"#fff\">需要包装的代码</show-hide-panel> -->\r\n<script lang=\"ts\" setup>\r\n\tconst show = defineModel<boolean>({ default: true })\r\n\tconst props = defineProps<{ bg?: string }>()\r\n\r\n\tconst getBg = computed(() => (show ? 'background:' + props.bg || 'transparent' : ''))\r\n</script>\r\n\r\n<template>\r\n\t<div :style=\"getBg\">\r\n\t\t<div v-show=\"show\" class=\"contentX\">\r\n\t\t\t<slot />\r\n\t\t</div>\r\n\t\t<div class=\"arrowA\">\r\n\t\t\t<div class=\"btA\" @click=\"show = !show\">\r\n\t\t\t\t<Icon :type=\"show ? 'ios-arrow-up' : 'ios-arrow-down'\" size=\"20\" />\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n","<!--ShowHidePanelB 收展面板，用于展示或收起表格页条件查询表单组\r\n@created 2023.07.31\r\n@author Ricky email:zhangqingcq@foxmail.com\r\n@params modelValue(v-model绑定)展开收起\r\n@params bg 例如：bg = '#fff' 或 bg = 'white' 不传为透明背景 (bg为自定义属性，控制该组件背景色) <show-hide-panel-b v-model=\"open\" bg=\"#fff\">需要包装的代码</show-hide-panel-b> -->\r\n\r\n<script setup lang=\"ts\">\r\n\tconst props = withDefaults(defineProps<{ modelValue?: boolean; bg?: string }>(), {\r\n\t\tmodelValue: false,\r\n\t\tbg: 'transparent'\r\n\t})\r\n\tconst emit = defineEmits(['update:modelValue'])\r\n\tconst show = computed({\r\n\t\tget() {\r\n\t\t\treturn props.modelValue\r\n\t\t},\r\n\t\tset(d: boolean) {\r\n\t\t\temit('update:modelValue', d)\r\n\t\t}\r\n\t})\r\n\r\n\tconst getBg = computed(() => (show.value ? 'background:' + props.bg : ''))\r\n</script>\r\n\r\n<template>\r\n\t<div :style=\"getBg\">\r\n\t\t<div v-show=\"show\" class=\"contentZ\">\r\n\t\t\t<slot />\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n","/**\r\n * @description 可自动销毁的定时器和计时器\r\n * @author ricky zhangqingcq@foxmail.com\r\n * @created 2023.07.14\r\n */\r\n\r\nlet timeoutBox: any[] = []\r\nlet intervalBox: any[] = []\r\n/**\r\n * 初始化\r\n * @param {object} r router实例\r\n */\r\nexport const init = function (r: any) {\r\n\tif (r && r.beforeEach) {\r\n\t\tr.beforeEach(() => {\r\n\t\t\ttimeoutBox.map((e) => {\r\n\t\t\t\twindow.clearTimeout(e)\r\n\t\t\t})\r\n\t\t\tintervalBox.map((e) => {\r\n\t\t\t\twindow.clearInterval(e)\r\n\t\t\t})\r\n\t\t\ttimeoutBox.length = 0\r\n\t\t\tintervalBox.length = 0\r\n\t\t})\r\n\t} else {\r\n\t\tconsole.warn(\r\n\t\t\t'安装库plug-r-qw时未传入router，调用该库的定时器方法产生的定时器将不能自动销毁，请传入router：Vue.use(plugRQw,{router,...})'\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport const setTimeout = function (fn: () => void, time: number): number {\r\n\tlet handler = window.setTimeout(fn, time)\r\n\ttimeoutBox.push(handler)\r\n\treturn handler\r\n}\r\n\r\nexport const setInterval = function (fn: () => void, time: number): number {\r\n\tlet handler = window.setInterval(fn, time)\r\n\tintervalBox.push(handler)\r\n\treturn handler\r\n}\r\n\r\nexport default {\r\n\tinit,\r\n\tsetTimeout,\r\n\tsetInterval\r\n}\r\n","<!--TableSearch 带高级查询按钮的快捷搜索组件，v-model绑定搜索框的值，高级查询按钮控制是否展开高级查询组件（showHidePanelB+searchForm）\r\n@created 2023.07.31\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n<script setup lang=\"ts\">\r\n\t/**\r\n\t * @desc 联合showHidePanelB、searchForm等插件对table进行查询\r\n\t * @param {string} modelValue - 搜索框的值（v-model）必填\r\n\t * @param {boolean} open - 高级搜索是否开启 必填\r\n\t * @param {string} placeholder - 搜索框的placeholder\r\n\t * @param {string} width - 整个插件宽度\r\n\t * @param {string} right - 整个插件定位-右（最近relative）\r\n\t * @param {string} top - 整个插件定位-上（最近relative）\r\n\t * @example 调用示例 <table-search v-model=\"areaName\" :open=\"openSearch\" placeholder=\"片区名称\" @on-search=\"search\" @on-toggle=\"openSearch=!openSearch\"/>\r\n\t */\r\n\r\n\timport t from '../../locale/i18nSFC'\r\n\timport { setTimeout } from '../../utils/timer'\r\n\r\n\tconst emit = defineEmits(['update:modelValue', 'on-toggle', 'on-search'])\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\tmodelValue: string\r\n\t\t\topen: boolean\r\n\t\t\tplaceholder?: string\r\n\t\t\tshowBtn?: boolean\r\n\t\t\tfixed?: boolean\r\n\t\t\twidth?: string | number\r\n\t\t\tright?: string | number\r\n\t\t\ttop?: string | number\r\n\t\t\tbtnColor?: string\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\topen: false,\r\n\t\t\tshowBtn: true,\r\n\t\t\tfixed: false,\r\n\t\t\twidth: '210px',\r\n\t\t\tright: '0',\r\n\t\t\ttop: '0',\r\n\t\t\tbtnColor: 'inherit'\r\n\t\t}\r\n\t)\r\n\r\n\tlet isDebounce = false\r\n\tconst value = computed({\r\n\t\tget() {\r\n\t\t\treturn props.modelValue\r\n\t\t},\r\n\t\tset(d: string) {\r\n\t\t\temit('update:modelValue', d)\r\n\t\t}\r\n\t})\r\n\tconst openX = computed({\r\n\t\tget() {\r\n\t\t\treturn props.open\r\n\t\t},\r\n\t\tset(d: boolean) {\r\n\t\t\temit('on-toggle', d)\r\n\t\t}\r\n\t})\r\n\tconst iconL = computed(() => (openX.value ? 'ios-arrow-up' : 'ios-arrow-down'))\r\n\r\n\tfunction onSearch() {\r\n\t\tif (!isDebounce) {\r\n\t\t\tisDebounce = true\r\n\t\t\temit('on-search', value.value)\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tisDebounce = false\r\n\t\t\t}, 2000)\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<template>\r\n\t<div\r\n\t\tclass=\"tableSearchV\"\r\n\t\t:style=\"{ position: props.fixed ? 'fixed' : 'absolute', right: props.right, top: props.top }\"\r\n\t>\r\n\t\t<slot>\r\n\t\t\t<Input\r\n\t\t\t\tv-model=\"value\"\r\n\t\t\t\t:style=\"{ width: props.width }\"\r\n\t\t\t\tsearch\r\n\t\t\t\t@on-search=\"onSearch\"\r\n\t\t\t\tclass=\"searchInputC\"\r\n\t\t\t\t:placeholder=\"props.placeholder || t('r.pInput')\"\r\n\t\t\t/>\r\n\t\t</slot>\r\n\t\t<span class=\"sbt\" @click=\"openX = !openX\" v-show=\"props.showBtn\" :style=\"{ color: props.btnColor }\"\r\n\t\t\t><icon :type=\"iconL\" :color=\"props.btnColor\" />{{ t('r.adSearch') }}</span\r\n\t\t>\r\n\t</div>\r\n</template>\r\n","import { isClient } from '../utils/globalFunc'\r\n\r\nexport default {\r\n\tbeforeMount(el: any, binding: any) {\r\n\t\tfunction documentHandler(e: any) {\r\n\t\t\tif (el.contains(e.target)) {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t\tbinding?.value?.(e)\r\n\t\t}\r\n\r\n\t\tel.__vueClickOutside__ = documentHandler\r\n\t\tisClient && document.addEventListener('click', documentHandler)\r\n\t},\r\n\tunmounted(el: any) {\r\n\t\tisClient && document.removeEventListener('click', el.__vueClickOutside__)\r\n\t\tdelete el.__vueClickOutside__\r\n\t}\r\n}\r\n","/**\r\n * @description 提示框\r\n * @author ricky zhangqingcq@foxmail.com\r\n * @created 2023.05.09\r\n */\r\n\r\nimport $swal from './swal'\r\nimport { t } from '../locale'\r\n\r\nexport default function $swalConfirm(\r\n\tthis: any,\r\n\ttitle: string,\r\n\ttext: string,\r\n\ticon: string,\r\n\tonOk: () => void,\r\n\tcloseOnClickOutside: boolean = false\r\n) {\r\n\tconst T = (...arg: Parameters<typeof t>) => t.apply(this, arg)\r\n\t$swal.call(this, {\r\n\t\ttitle: title || T('r.info.title'),\r\n\t\ttext: text || T('r.info.text'),\r\n\t\ticon: icon || 'warning',\r\n\t\tonOk: onOk,\r\n\t\tbuttons: [T('r.cancel')],\r\n\t\tcloseOnClickOutside: closeOnClickOutside\r\n\t})\r\n}\r\n","<!--TableSetting 设置表格哪些列展示，支持指定列默认展示、指定列禁止修改展示设置\r\n@created 2023.08.14\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n<script lang=\"ts\" setup>\r\n\t/**\r\n\t * @desc 利用table的columns和localstorage对table进行列的显示设置\r\n\t * @param {array} modelValue - 插件的值（v-model,对应table的columns）必填\r\n\t * @param {string} sKey - 插件数据在localstorage的唯一标识，命名规则：插件所在单文件名称_取名时间，如areaNew_202003231639 必填\r\n\t * @param {string} [width] - 设置面板宽度\r\n\t * @param {string} [bg] - 设置面板背景色，默认值可通过全局属性tableSettingBg改变，默认：`'#fff'`\r\n\t * @param {string} [placement] - 设置面板呼出位置，默认：'bottom-end'\r\n\t * @param {boolean} [defaultCheck] - 是否设置默认勾选（默认false，用于默认展示所有列），如果设为true（用于默认展示部分列）,则在v-model绑定的columns项里设置showSettingCheck:true\r\n\t * @param {string} [storage] - 指定使用浏览器缓存类型，可选值`'localStorage'`、`'sessionStorage'`，默认：`localStorage`\r\n\t * @param {boolean} [transfer] - 是否将面板放置于 body 内，在 Tabs、带有 overflow:hidden 的 上级容器内使用时，建议添加此属性，它将不受父级样式影响，从而达到更好的效果，默认值可通过全局属性tableSettingTransfer改变，默认：`true`\r\n\t * @param {boolean} [eventsEnabled] - 是否开启 Popper 的 eventsEnabled 属性，开启可能会牺牲一定的性能，但可以让弹出面板根据页面环境动态改变位置和自身尺寸，提升体验，默认值可通过全局属性tableSettingEventsEnabled改变，默认：`true`\r\n\t * @example 调用示例 <table-setting v-model=\"columns\" sKey=\"tableSettingEx_202007030903\"/>\r\n\t */\r\n\timport Popper from 'popper.js'\r\n\timport type { Placement } from 'popper.js'\r\n\timport { cloneDeep } from 'lodash-es'\r\n\timport vClickOutside from '../../directives/clickOutside'\r\n\timport t from '../../locale/i18nSFC'\r\n\timport Proxy from '../../utils/proxy'\r\n\timport { setTimeout } from '../../utils/timer'\r\n\timport SwalConfirm from '../../utils/swalConfirm'\r\n\r\n\tconst emit = defineEmits(['update:modelValue'])\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\tmodelValue?: any[]\r\n\t\t\tsKey: string\r\n\t\t\twidth?: string\r\n\t\t\tbg?: string\r\n\t\t\tplacement?: Placement\r\n\t\t\tdefaultCheck?: boolean\r\n\t\t\tstorage?: 'localStorage' | 'sessionStorage'\r\n\t\t\ttransfer?: boolean\r\n\t\t\teventsEnabled?: boolean /*是否开启 Popper 的 eventsEnabled 属性，开启可能会牺牲一定的性能，但可以让弹出面板根据页面环境动态改变位置和自身尺寸，提升体验*/\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\tmodelValue: () => [],\r\n\t\t\twidth: '240px',\r\n\t\t\tbg: () => Proxy().tableSettingBg,\r\n\t\t\tplacement: 'bottom-end',\r\n\t\t\tdefaultCheck: false,\r\n\t\t\tstorage: 'localStorage',\r\n\t\t\ttransfer: () => Proxy().tableSettingTransfer,\r\n\t\t\teventsEnabled: () => Proxy().tableSettingEventsEnabled\r\n\t\t}\r\n\t)\r\n\r\n\tconst buttonRef = ref()\r\n\tconst popperRef = ref()\r\n\r\n\tconst indeterminate = ref(true)\r\n\tconst checkAll = ref(false)\r\n\tconst show = ref(false)\r\n\tconst groupT = ref<any[]>([])\r\n\tconst groupX = computed(() => {\r\n\t\tlet unknown = t('r.unknown')\r\n\t\tif (props.modelValue?.length > groupT.value.length) {\r\n\t\t\tgroupT.value = cloneDeep(props.modelValue)\r\n\t\t}\r\n\t\treturn groupT.value.map((e: Record<string, any>) => {\r\n\t\t\tlet temp: Record<string, any> = { label: e?.title || unknown }\r\n\t\t\tif (e?.disableShowSetting) {\r\n\t\t\t\ttemp.disabled = true\r\n\t\t\t}\r\n\t\t\treturn temp\r\n\t\t})\r\n\t})\r\n\tconst disabledGroup = computed(() => groupX.value.filter((e: Record<string, any>) => e?.disabled))\r\n\tconst checkAllGroup = computed({\r\n\t\tget() {\r\n\t\t\treturn props.modelValue?.map?.((e: Record<string, any>) => e?.title || t('r.unknown'))\r\n\t\t},\r\n\t\tset(v: any[]) {\r\n\t\t\tlet subV = groupT.value.filter((e: Record<string, any>) => {\r\n\t\t\t\tfor (let item of v) {\r\n\t\t\t\t\tif (item === e?.title) {\r\n\t\t\t\t\t\treturn true\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false\r\n\t\t\t})\r\n\t\t\temit('update:modelValue', subV)\r\n\t\t}\r\n\t})\r\n\tconst locale = getCurrentInstance()?.appContext?.config?.globalProperties?.$i18n?.locale\r\n\tlet _popper: any = null\r\n\r\n\tonMounted(() => {\r\n\t\tlet unknown = t('r.unknown')\r\n\t\tlet localStr: string | null = getStorage()\r\n\t\tif (localStr) {\r\n\t\t\tcheckAllGroup.value = JSON.parse(decodeURI(localStr))\r\n\t\t} else {\r\n\t\t\tif (props.defaultCheck) {\r\n\t\t\t\tcheckAllGroup.value = props.modelValue\r\n\t\t\t\t\t.filter((e: Record<string, any>) => e?.showSettingCheck)\r\n\t\t\t\t\t.map((e) => e?.title || unknown)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tnextTick(function () {\r\n\t\t\tif (!buttonRef.value || !popperRef.value) {\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\t_popper = new Popper(buttonRef.value, popperRef.value, {\r\n\t\t\t\tplacement: props.placement,\r\n\t\t\t\teventsEnabled: props.eventsEnabled,\r\n\t\t\t\tmodifiers: {\r\n\t\t\t\t\tcomputeStyle: {\r\n\t\t\t\t\t\tgpuAcceleration: false\r\n\t\t\t\t\t},\r\n\t\t\t\t\tpreventOverflow: {\r\n\t\t\t\t\t\tboundariesElement: 'window'\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tonUpdate: (d: any) => {\r\n\t\t\t\t\tif (d?.popper && d.instance?.popper) {\r\n\t\t\t\t\t\tconst c = calcPopperHeight(d)\r\n\t\t\t\t\t\tconst { needChange } = c\r\n\t\t\t\t\t\tif (needChange) {\r\n\t\t\t\t\t\t\tconst { height } = c\r\n\t\t\t\t\t\t\tconst el = d.instance.popper\r\n\t\t\t\t\t\t\tif (el.style) {\r\n\t\t\t\t\t\t\t\tel.style.height = `${height}px`\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t})\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\tshow.value = true\r\n\t\t\t_popper?.update?.()\r\n\t\t\tnextTick(function () {\r\n\t\t\t\tshow.value = false\r\n\t\t\t})\r\n\t\t}, 0)\r\n\t})\r\n\r\n\tonBeforeUnmount(function () {\r\n\t\t_popper?.destroy?.()\r\n\t})\r\n\r\n\tfunction calcPopperHeight(d: Record<string, any>) {\r\n\t\tconst { height } = d.popper\r\n\t\tconst el = d.instance.popper\r\n\t\t//浏览器窗口高度\r\n\t\tconst h = window.innerHeight\r\n\t\tlet _h = 0\r\n\t\tif (el.childNodes?.length) {\r\n\t\t\tfor (let i = 0; i < el.childNodes.length; i++) {\r\n\t\t\t\t_h += el.childNodes[i]?.offsetHeight\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (h < height - 10 || height < _h) {\r\n\t\t\treturn {\r\n\t\t\t\tneedChange: true,\r\n\t\t\t\theight: h - 10 < _h ? h - 10 : _h\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn { needChange: false }\r\n\t\t}\r\n\t}\r\n\r\n\tfunction checkAllGroupChange(data: any[]) {\r\n\t\tif (data.length === groupX.value.length) {\r\n\t\t\tindeterminate.value = false\r\n\t\t\tcheckAll.value = true\r\n\t\t} else if (data.length > disabledGroup.value.length) {\r\n\t\t\tindeterminate.value = true\r\n\t\t\tcheckAll.value = false\r\n\t\t} else {\r\n\t\t\tindeterminate.value = false\r\n\t\t\tcheckAll.value = false\r\n\t\t}\r\n\t}\r\n\r\n\twatch(() => checkAllGroup.value, checkAllGroupChange, {\r\n\t\timmediate: true,\r\n\t\tdeep: true\r\n\t})\r\n\r\n\tfunction close() {\r\n\t\tif (show.value) {\r\n\t\t\tif (getChange()) {\r\n\t\t\t\tSwalConfirm(t('r.notSave'), '', 'warning', save)\r\n\t\t\t}\r\n\t\t\tshow.value = false\r\n\t\t}\r\n\t}\r\n\r\n\tfunction labelClick() {\r\n\t\tif (!show.value) {\r\n\t\t\tshow.value = true\r\n\t\t\tnextTick(function () {\r\n\t\t\t\t_popper?.update?.()\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\tclose()\r\n\t\t}\r\n\t}\r\n\r\n\tfunction save() {\r\n\t\tif (locale) {\r\n\t\t\twindow[props.storage].setItem(props.sKey + '_' + locale, encodeURI(JSON.stringify(checkAllGroup.value)))\r\n\t\t} else {\r\n\t\t\twindow[props.storage].setItem(props.sKey, encodeURI(JSON.stringify(checkAllGroup.value)))\r\n\t\t}\r\n\t\tclose()\r\n\t}\r\n\r\n\tfunction clickOutsideHandle(event: any) {\r\n\t\tif (show.value) {\r\n\t\t\tif (props.transfer) {\r\n\t\t\t\tconst $el = popperRef.value\r\n\t\t\t\tif ($el === event?.target || $el?.contains?.(event?.target)) {\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tevent?.preventDefault?.()\r\n\t\t\tclose()\r\n\t\t}\r\n\t}\r\n\r\n\tfunction handleCheckAll() {\r\n\t\tif (indeterminate.value) {\r\n\t\t\tcheckAll.value = false\r\n\t\t} else {\r\n\t\t\tcheckAll.value = !checkAll.value\r\n\t\t}\r\n\t\tindeterminate.value = false\r\n\r\n\t\tif (checkAll.value) {\r\n\t\t\tcheckAllGroup.value = groupX.value.map((e: Record<string, any>) => e?.label)\r\n\t\t} else {\r\n\t\t\tcheckAllGroup.value = disabledGroup.value.map((e: Record<string, any>) => e?.label)\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getStorage() {\r\n\t\tlet localStr\r\n\t\tif (locale) {\r\n\t\t\tlocalStr = window[props.storage].getItem(props.sKey + '_' + locale)\r\n\t\t} else {\r\n\t\t\tlocalStr = window[props.storage].getItem(props.sKey)\r\n\t\t}\r\n\t\treturn localStr\r\n\t}\r\n\r\n\tfunction getChange() {\r\n\t\tlet t = getStorage()\r\n\t\tif (t) {\r\n\t\t\tt = JSON.parse(decodeURI(t))\r\n\t\t\tif (t?.length !== checkAllGroup.value?.length) {\r\n\t\t\t\treturn true\r\n\t\t\t} else {\r\n\t\t\t\tfor (let e of t) {\r\n\t\t\t\t\tif (checkAllGroup.value.indexOf(e) === -1) {\r\n\t\t\t\t\t\treturn true\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn true\r\n\t\t}\r\n\t\treturn false\r\n\t}\r\n</script>\r\n\r\n<template>\r\n\t<div class=\"tabSetF\" v-click-outside=\"clickOutsideHandle\">\r\n\t\t<div ref=\"buttonRef\" class=\"tabSetBt\" @click=\"labelClick\">\r\n\t\t\t<Icon type=\"md-settings\" size=\"17\" />\r\n\t\t\t<span class=\"cannotSelect\">{{ t('r.tabSetting') }}</span>\r\n\t\t</div>\r\n\t\t<Teleport to=\"body\" :disabled=\"!props.transfer\">\r\n\t\t\t<div ref=\"popperRef\" class=\"tabSetCard\" v-show=\"show\" :style=\"{ width: props.width, backgroundColor: props.bg }\">\r\n\t\t\t\t<div class=\"topCheck\">\r\n\t\t\t\t\t<Checkbox :indeterminate=\"indeterminate\" v-model=\"checkAll\" @click.prevent.native=\"handleCheckAll\">{{\r\n\t\t\t\t\t\tt('r.all')\r\n\t\t\t\t\t}}</Checkbox>\r\n\t\t\t\t\t<div class=\"btnR\" style=\"float: right; display: inline-block\" @click=\"save\">\r\n\t\t\t\t\t\t<span class=\"iconfont icon-r-save\"></span>\r\n\t\t\t\t\t\t<span>{{ t('r.save') }}</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<CheckboxGroup v-model=\"checkAllGroup\">\r\n\t\t\t\t\t<Checkbox\r\n\t\t\t\t\t\tv-for=\"(itemT, index) in groupX\"\r\n\t\t\t\t\t\tclass=\"setItem\"\r\n\t\t\t\t\t\t:label=\"itemT && itemT.label\"\r\n\t\t\t\t\t\t:key=\"'tabSet_' + props.sKey + index\"\r\n\t\t\t\t\t\t:disabled=\"itemT && itemT.disabled\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</CheckboxGroup>\r\n\t\t\t</div>\r\n\t\t</Teleport>\r\n\t</div>\r\n</template>\r\n","/**\r\n * @description 公共方法集合，需要单独引用才能使用\r\n * @author ricky zhangqingcq@foxmail.com\r\n * @created 2023.07.14\r\n */\r\nimport type { Collection } from '../public'\r\nimport { isObject, isFunction, isPlainObject, cloneDeep, isEmpty } from 'lodash-es'\r\nimport { myTypeof } from './globalFunc'\r\n\r\n// 下划线转换驼峰\r\nexport function toHump(name: string): string {\r\n\treturn name.replace(/_(\\w)/g, function (all, letter) {\r\n\t\treturn letter.toUpperCase()\r\n\t})\r\n}\r\n\r\n/*用浏览器内部转换器实现html转码*/\r\nexport function htmlEncode(text: string): string | HTMLElement {\r\n\t//1.首先动态创建一个容器标签元素，如DIV\r\n\tlet temp = document.createElement('div')\r\n\t//2.然后将要转换的字符串设置为这个元素的innerText(ie支持)或者textContent(火狐，google支持)\r\n\ttemp.textContent !== undefined ? (temp.textContent = text) : (temp.innerText = text)\r\n\t//3.最后返回这个元素的innerHTML，即得到经过HTML编码转换的字符串了\r\n\treturn temp.innerHTML\r\n}\r\n\r\n/*用浏览器内部转换器实现html解码*/\r\nexport function htmlDecode(html: string): string | null {\r\n\t//1.首先动态创建一个容器标签元素，如DIV\r\n\tlet temp = document.createElement('div')\r\n\t//2.然后将要转换的字符串设置为这个元素的innerHTML(ie，火狐，google都支持)\r\n\ttemp.innerHTML = html\r\n\t//3.最后返回这个元素的innerText(ie支持)或者textContent(火狐，google支持)，即得到经过HTML解码的字符串了。\r\n\treturn temp.innerText || temp.textContent\r\n}\r\n\r\n/*根据file文件对象获取文件地址用来预览*/\r\nexport function getFileSrc(file: File) {\r\n\treturn new Promise((resolve) => {\r\n\t\tlet reader = new FileReader()\r\n\t\treader.readAsDataURL(file) // 读出 base64\r\n\t\treader.onloadend = () => {\r\n\t\t\tresolve(reader.result)\r\n\t\t}\r\n\t})\r\n}\r\n\r\n/*获取后缀名*/\r\nexport function getFileTypeByName(name: string): string {\r\n\treturn name?.split('.').pop()!.toLocaleLowerCase() || ''\r\n}\r\n\r\n/*判断是否为图片（type是否包含‘image’）*/\r\nexport function isImgByFile(type: string): boolean {\r\n\treturn myTypeof(type) === 'String' && type.indexOf('image') > -1\r\n}\r\n\r\n/*根据文件名获取图标（上传组件用）*/\r\nexport function getFileTypeIconByName(name: string): string {\r\n\tconst format = getFileTypeByName(name)\r\n\tlet type = 'ios-document-outline'\r\n\r\n\tif (['gif', 'jpg', 'jpeg', 'png', 'bmp', 'webp'].indexOf(format) > -1) {\r\n\t\ttype = 'ios-image'\r\n\t} else if (['mp4', 'm3u8', 'rmvb', 'avi', 'swf', '3gp', 'mkv', 'flv'].indexOf(format) > -1) {\r\n\t\ttype = 'ios-film'\r\n\t} else if (['mp3', 'wav', 'wma', 'ogg', 'aac', 'flac'].indexOf(format) > -1) {\r\n\t\ttype = 'ios-musical-notes'\r\n\t} else if (['doc', 'txt', 'docx', 'pages', 'epub', 'pdf'].indexOf(format) > -1) {\r\n\t\ttype = 'md-document'\r\n\t} else if (['numbers', 'csv', 'xls', 'xlsx'].indexOf(format) > -1) {\r\n\t\ttype = 'ios-stats'\r\n\t} else if (['keynote', 'ppt', 'pptx'].indexOf(format) > -1) {\r\n\t\ttype = 'ios-videocam'\r\n\t}\r\n\r\n\treturn type\r\n}\r\n\r\n/*下载一个文件（替换容易被浏览器屏蔽的window.open方法）*/\r\nexport function downloadFileReaderFile(name: string, href: string): void {\r\n\tlet saveLink = document.createElement('a')\r\n\tsaveLink.href = href\r\n\tsaveLink.download = name\r\n\tfakeALinkClick(saveLink)\r\n}\r\n\r\n/*模拟被点击（比如模拟用户点击链接下载东西）*/\r\nexport function fakeALinkClick(obj: Record<string, any>): void {\r\n\tlet ev = document.createEvent('MouseEvents')\r\n\tev.initMouseEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null)\r\n\tobj.dispatchEvent(ev)\r\n}\r\n\r\n/**\r\n * 按条件查找一个元素在集合中的位置（路径），返回找到的第一个符合条件的位置\r\n * 仅适用于[{children:[{...},...],...},...]类似树结构集合（最外层也可以是一个对象）或一维数组\r\n * @param  {Object} option 参数\r\n * @param {Array|Object} option.group - 集合，被查找的集合，必填\r\n * @param {Function|String|Number|Boolean} option.condition - 查找条件，为常量时，将常量和集合元素直接对比，必填\r\n * @param {String} option.pathKey - 查找结果（路径）元素在集合中的key，在集合为数组时，可以不填，返回index（索引）\r\n * @param {String} option.childKey - 集合子元素的key，默认值 children\r\n * @param {Array} option.path - 递归用参数，逻辑内部参数，不用传\r\n * @return {Array} 返回带有路径（层级）信息的数组\r\n * @example group: {id:1,name:'爸爸',children:[{id:2,name:'大儿子'},{id:3,name:'二儿子'}]}\r\n *          condition: e=>e?.id === 3\r\n *          pathKey: 'name'\r\n *          childKey: 'children'\r\n *\r\n *          返回：['爸爸','二儿子']\r\n */\r\nexport function findPath({\r\n\tgroup,\r\n\tcondition,\r\n\tpathKey,\r\n\tchildKey = 'children',\r\n\tpath = []\r\n}: {\r\n\tgroup: Collection\r\n\tcondition: (item: any) => boolean\r\n\tpathKey?: any\r\n\tchildKey?: any\r\n\tpath?: string[]\r\n}): Array<string | number> {\r\n\tif (group && isObject(group)) {\r\n\t\tif (isFunction(condition)) {\r\n\t\t\tif (isPlainObject(group)) {\r\n\t\t\t\tlet item = group\r\n\t\t\t\tlet temp = cloneDeep(path)\r\n\t\t\t\tif (condition(item)) {\r\n\t\t\t\t\tif (pathKey && item[pathKey]) {\r\n\t\t\t\t\t\ttemp.push(item[pathKey])\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn temp\r\n\t\t\t\t} else if (item[childKey] && !isEmpty(item[childKey])) {\r\n\t\t\t\t\tif (pathKey && item[pathKey]) {\r\n\t\t\t\t\t\ttemp.push(item[pathKey])\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet rr = findPath({\r\n\t\t\t\t\t\tgroup: item[childKey],\r\n\t\t\t\t\t\tcondition: condition,\r\n\t\t\t\t\t\tpathKey: pathKey,\r\n\t\t\t\t\t\tchildKey: childKey,\r\n\t\t\t\t\t\tpath: temp\r\n\t\t\t\t\t})\r\n\t\t\t\t\tif (!isEmpty(rr)) {\r\n\t\t\t\t\t\treturn rr\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (Array.isArray(group)) {\r\n\t\t\t\tfor (let item of group) {\r\n\t\t\t\t\tlet temp = cloneDeep(path)\r\n\t\t\t\t\tif (condition(item)) {\r\n\t\t\t\t\t\tif (pathKey && item[pathKey]) {\r\n\t\t\t\t\t\t\ttemp.push(item[pathKey])\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttemp.push(String(group.indexOf(item)))\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn temp\r\n\t\t\t\t\t} else if (item[childKey] && item[childKey].length > 0) {\r\n\t\t\t\t\t\tif (pathKey && item[pathKey]) {\r\n\t\t\t\t\t\t\ttemp.push(item[pathKey])\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttemp.push(String(group.indexOf(item)))\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlet rr = findPath({\r\n\t\t\t\t\t\t\tgroup: item[childKey],\r\n\t\t\t\t\t\t\tcondition: condition,\r\n\t\t\t\t\t\t\tpathKey: pathKey,\r\n\t\t\t\t\t\t\tchildKey: childKey,\r\n\t\t\t\t\t\t\tpath: temp\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tif (!isEmpty(rr)) {\r\n\t\t\t\t\t\t\treturn rr\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (Array.isArray(group)) {\r\n\t\t\t//条件为常量，集合为数组，这种情况只会有一种业务场景：在一维数组中查找某个常量在数组中第一次出现的index\r\n\t\t\tfor (let item of group) {\r\n\t\t\t\tlet temp = cloneDeep(path)\r\n\t\t\t\tif (item === condition) {\r\n\t\t\t\t\ttemp.push(String(group.indexOf(item)))\r\n\t\t\t\t\treturn temp\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn []\r\n}\r\n\r\n/*获取字符串width*/\r\nexport function getStringWidth(str: string, fontSize: number = 12): number {\r\n\tif (myTypeof(str) === 'String' && str.length > 0) {\r\n\t\tlet nodesH = document.createElement('span')\r\n\t\tnodesH.style.fontSize = fontSize + 'px'\r\n\t\tnodesH.style.fontFamily = 'inherit'\r\n\t\tnodesH.innerHTML = str\r\n\t\tnodesH.style.opacity = '0'\r\n\t\tnodesH.style.position = 'fixed'\r\n\t\tnodesH.style.top = '3000px'\r\n\t\tdocument.body.append(nodesH)\r\n\t\tconst width = nodesH.clientWidth\r\n\t\tdocument.body.removeChild(nodesH)\r\n\t\treturn width\r\n\t}\r\n\treturn 0\r\n}\r\n\r\n/**\r\n * 如果值为''则将其替换为null\r\n * @param val 被替换的值\r\n * @returns {*}\r\n */\r\n\r\nexport function emptyInput(val: any) {\r\n\tif (val === '') {\r\n\t\treturn null\r\n\t}\r\n\treturn val\r\n}\r\n\r\n//阻止冒泡\r\nexport function stopBubbling(e: any): void {\r\n\te = e || window.Event\r\n\tif (e?.stopPropagation) {\r\n\t\t//W3C阻止冒泡方法\r\n\t\te.stopPropagation?.()\r\n\t} else if (e) {\r\n\t\te.cancelBubble = true //IE阻止冒泡方法\r\n\t}\r\n}\r\n","/**\r\n * @description 基于view-ui:Modal的对话框插件\r\n * @author Ricky email:zhangqingcq@foxmail.com\r\n * @created 2023.05.04\r\n */\r\nimport { h } from 'vue'\r\nimport type { VNode } from 'vue'\r\nimport { Modal, Button } from 'view-ui-plus'\r\nimport { myTypeof } from './globalFunc'\r\nimport { t } from '../locale'\r\nimport type { RenderFunc } from '../public'\r\n\r\nlet loading: boolean = false\r\n\r\n/**\r\n * 对话框\r\n * @param {object} options 对话框配置\r\n * @param {string|VNode|Function} options.content 提示框内容，必填，传`''`触发默认值，1.string，直接将文字插入对应位置；\r\n * 2.VNode，如：h('div',{style:{color:'red'}},'123')；注意此处h是vue的渲染函数，需要引入：import {h} from 'vue'\r\n * 3.Function,如：(_h)=>_h('div',{class:'my-class'},'123')；此处_h作为参数，不需要单独引入\r\n * @param {number} [options.height] 弹框高度,默认值130,最小值130\r\n * @param {number} [options.width] 弹框宽度，默认值416,最小值416\r\n * @param {string} [options.title] 弹框标题内容，默认值“提示”\r\n * @param {Function} [options.onOk] 确定按钮回调函数\r\n * @param {Function} [options.onCancel] 取消按钮回调函数\r\n * @param {Function} [options.onClose] 关闭（右上角叉叉）按钮回调函数\r\n * @param {string} [options.okText] 确定按钮文字，默认值“确定”\r\n * @param {string} [options.cancelText] 取消按钮文字，默认值“取消”\r\n * @param {boolean} [options.noWarnIcon] 不展示内容开头的警告图标(非字符串内容默认不展示)，默认值“false”\r\n * @param {string} [options.footerAlign] 底部对齐方式，string，默认值“center”\r\n * @param {boolean} [options.cancelBt] 展示取消按钮，boolean，默认值“true”\r\n * 组件中调用示例：this.messageBox({\r\n *                      content:'确定执行操作？'\r\n *                    })\r\n */\r\nexport default function messageBox(\r\n\tthis: any,\r\n\t{\r\n\t\theight,\r\n\t\twidth = 416,\r\n\t\ttitle,\r\n\t\tcontent,\r\n\t\tonOk,\r\n\t\tonCancel,\r\n\t\tonClose,\r\n\t\tokText,\r\n\t\tcancelText,\r\n\t\tnoWarnIcon,\r\n\t\tfooterAlign,\r\n\t\tcancelBt = true\r\n\t}: {\r\n\t\theight?: number\r\n\t\twidth?: number\r\n\t\ttitle?: string\r\n\t\tcontent: string | VNode | RenderFunc\r\n\t\tonOk?: () => void | Promise<any>\r\n\t\tonCancel?: () => void\r\n\t\tonClose?: () => void\r\n\t\tokText?: string\r\n\t\tcancelText?: string\r\n\t\tnoWarnIcon?: boolean\r\n\t\tfooterAlign?: string\r\n\t\tcancelBt?: boolean\r\n\t}\r\n): void {\r\n\tconst T = (...arg: Parameters<typeof t>) => t.apply(this, arg)\r\n\r\n\tlet heightTemp = height && Number(height) - 90 > 100 ? Number(height) - 90 + 'px' : 0\r\n\tlet heightT = heightTemp || '100px'\r\n\tlet stringContent = myTypeof(content) === 'String'\r\n\tconst functionContent = typeof content === 'function'\r\n\r\n\tModal.warning({\r\n\t\twidth: width,\r\n\t\tfooterHide: true,\r\n\t\trender: () => {\r\n\t\t\treturn h(\r\n\t\t\t\t'div',\r\n\t\t\t\t{\r\n\t\t\t\t\tclass: 'customMessageBox',\r\n\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\theight: heightT\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t[\r\n\t\t\t\t\th(\r\n\t\t\t\t\t\t'div',\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tclass: 'containerN'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\th(\r\n\t\t\t\t\t\t\t\t'div',\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tclass: 'titleN'\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\th('span', title || T('r.info.title')),\r\n\t\t\t\t\t\t\t\t\th(\r\n\t\t\t\t\t\t\t\t\t\tButton,\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tclass: 'fr closeN',\r\n\t\t\t\t\t\t\t\t\t\t\ttype: 'text',\r\n\t\t\t\t\t\t\t\t\t\t\tonClick() {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (loading) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tModal.remove()\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (onClose && myTypeof(onClose) === 'Function') {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClose()\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t() =>\r\n\t\t\t\t\t\t\t\t\t\t\th('i', {\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass: 'ivu-icon ivu-icon-ios-close',\r\n\t\t\t\t\t\t\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize: '30px'\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\th(\r\n\t\t\t\t\t\t\t\t'div',\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tclass: 'contentN',\r\n\t\t\t\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\t\t\t\ttextAlign: stringContent ? 'center' : 'left'\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\th('i', {\r\n\t\t\t\t\t\t\t\t\t\tclass: stringContent && !noWarnIcon ? 'ivu-icon ivu-icon-ios-alert-outline' : 'hide',\r\n\t\t\t\t\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\t\t\t\t\tfontSize: '60px',\r\n\t\t\t\t\t\t\t\t\t\t\tcolor: '#f8bb86'\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\th('div', { class: 'msgBoxConO' }, functionContent ? [content(h)] : content || T('r.info.text'))\r\n\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\th(\r\n\t\t\t\t\t\t\t\t'div',\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tclass: 'footerN',\r\n\t\t\t\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\t\t\t\ttextAlign: footerAlign || 'center'\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\th(\r\n\t\t\t\t\t\t\t\t\t\tButton,\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tclass: 'okBtN',\r\n\t\t\t\t\t\t\t\t\t\t\tonClick(e: any) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (onOk && typeof onOk === 'function') {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst p = onOk()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (p && myTypeof(p) === 'Promise') {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tloading = true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst el = e?.currentTarget || e?.target\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (el) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tel.classList?.add?.('ivu-btn-loading')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tel.nextSibling?.setAttribute?.('disabled', 'disabled')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst c = el.parentElement?.parentElement?.querySelector?.('.titleN .closeN')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tc.classList?.add?.('disabled')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tPromise.resolve(p)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloading = false\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tModal.remove()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.catch(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloading = false\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tModal.remove()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tModal.remove()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t() => [\r\n\t\t\t\t\t\t\t\t\t\t\th('i', {\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass: 'ivu-load-loop ivu-icon ivu-icon-ios-loading'\r\n\t\t\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\t\t\th('span', okText || T('r.confirm'))\r\n\t\t\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\th(\r\n\t\t\t\t\t\t\t\t\t\tButton,\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tclass: ['cancelBtN', !cancelBt && 'hide'],\r\n\t\t\t\t\t\t\t\t\t\t\tonClick() {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (loading) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tModal.remove()\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (myTypeof(onCancel) === 'Function') {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonCancel && onCancel()\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t() => cancelText || T('r.cancel')\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t)\r\n\t\t\t\t]\r\n\t\t\t)\r\n\t\t}\r\n\t})\r\n}\r\n","let count = 0\r\nlet loader = document.createElement('div')\r\nloader.setAttribute('class', 'spinModal')\r\n\r\nloader.innerHTML =\r\n\t'<div class=\"loader\"><svg class=\"circular\" viewBox=\"25 25 50 50\"><circle class=\"path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-width=\"5\" stroke-miterlimit=\"10\" /></svg></div>'\r\n\r\nwindow.onload = function () {\r\n\tdocument.getElementsByTagName('body')[0].append(loader)\r\n}\r\n\r\n/**\r\n * 开关spin\r\n * @param d 开为：true，关：不传\r\n */\r\nexport function toggleSpin(d?: boolean): void {\r\n\tif (d) {\r\n\t\tloader.classList.add('show')\r\n\t} else {\r\n\t\tloader.classList.remove('show')\r\n\t}\r\n}\r\n\r\n/**\r\n * 网络请求计数\r\n * @param d 增加计数：true，减少计数：不传\r\n */\r\nexport function counts(d?: boolean) {\r\n\tlet t = count\r\n\tif (d) {\r\n\t\tcount++\r\n\t} else if (count > 0) {\r\n\t\tcount--\r\n\t}\r\n\r\n\tif (t !== count) {\r\n\t\tif (count === 0) {\r\n\t\t\ttoggleSpin(false)\r\n\t\t} else if (t === 0) {\r\n\t\t\ttoggleSpin(true)\r\n\t\t}\r\n\t}\r\n}\r\n","/**\r\n * @description 基于axios的网络请求插件\r\n * @author Ricky email:zhangqingcq@foxmail.com\r\n * @created 2023.05.10\r\n */\r\nimport type { AxiosInstance, AxiosRequestConfig, AxiosResponse } from 'axios'\r\nimport { isEmpty } from 'lodash-es'\r\nimport { t } from '../locale'\r\nimport messageBox from './messageBox'\r\n\r\nimport { counts } from './spin'\r\nimport type { Collection } from '../public'\r\n\r\nconst host = window.location.origin\r\n\r\nlet proxy: any = null\r\nconst T = (...arg: Parameters<typeof t>) => t.apply(proxy, arg)\r\n\r\nexport interface ServiceR extends AxiosInstance {\r\n\tstore?: any\r\n}\r\n\r\nexport interface RequestConfigR extends AxiosRequestConfig {\r\n\tspin?: boolean\r\n\tnoEmptyStr?: boolean\r\n}\r\n\r\n// 创建自定义对象\r\nlet service: ServiceR = axios.create({\r\n\tbaseURL: host,\r\n\twithCredentials: true // 允许携带cookie\r\n})\r\n\r\nfunction notInitYet() {\r\n\tconsole.info(\r\n\t\t'store为空，请在安装插件时传入store实例，vuex：app.use(plugRQw,{store})，Pinia：app.use(plugRQw,{useStore})'\r\n\t)\r\n}\r\n\r\n/**\r\n * 拦截器，在发起请求前调用\r\n */\r\nservice.interceptors.request.use(\r\n\t(q) => {\r\n\t\treturn q\r\n\t},\r\n\t(e) => {\r\n\t\treturn Promise.reject(e)\r\n\t}\r\n)\r\n\r\nfunction logoutHandle() {\r\n\tif (service.store) {\r\n\t\tif (typeof service.store === 'function') {\r\n\t\t\tconst store = service.store()\r\n\t\t\tif (store.logout) {\r\n\t\t\t\tstore.logout()\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tservice.store?.dispatch?.('logout')\r\n\t\t}\r\n\t} else {\r\n\t\tnotInitYet()\r\n\t}\r\n}\r\n\r\n/**\r\n * 拦截器，在请求返回时调用\r\n */\r\nservice.interceptors.response.use(\r\n\t(r) => {\r\n\t\tif (proxy && (r?.data?.code === 403 || r?.data?.code === 409)) {\r\n\t\t\tmessageBox({\r\n\t\t\t\tcontent: T('r.http.' + r.data.code),\r\n\t\t\t\tonOk: logoutHandle\r\n\t\t\t})\r\n\t\t}\r\n\t\treturn r\r\n\t},\r\n\t(e) => {\r\n\t\tif (proxy && (e?.response?.status === 403 || e?.response?.status === 409)) {\r\n\t\t\tmessageBox({\r\n\t\t\t\tcontent: T('r.http.' + e.response.status),\r\n\t\t\t\tonOk: logoutHandle\r\n\t\t\t})\r\n\t\t}\r\n\t\tconsole.warn('请求出错：', e)\r\n\t\treturn Promise.reject(e)\r\n\t}\r\n)\r\n\r\n/**\r\n * 封装请求结果和错误处理\r\n */\r\nfunction checkResult(r: Partial<AxiosResponse>, msg?: string | null, rPath?: string[], config?: RequestConfigR) {\r\n\tif (config && config.spin) {\r\n\t\tcounts(false)\r\n\t}\r\n\tlet y = true\r\n\tlet d = r && r.data\r\n\tif (d) {\r\n\t\trPath = rPath ? rPath : []\r\n\t\tfor (let e of rPath) {\r\n\t\t\td = d[e]\r\n\t\t\ty = y && d\r\n\t\t}\r\n\t\tif (y) {\r\n\t\t\treturn d\r\n\t\t}\r\n\t\tmsg && console.warn(msg)\r\n\t\treturn false\r\n\t}\r\n\tmsg && console.warn(msg)\r\n\treturn false\r\n}\r\n\r\nfunction handleRequest(\r\n\tmethod: string,\r\n\turl: string,\r\n\tdata?: Collection,\r\n\tmsg?: string | null,\r\n\trPath?: string[],\r\n\tconfig?: RequestConfigR,\r\n\tisUrlData?: boolean\r\n) {\r\n\treturn new Promise((s, j) => {\r\n\t\tswitch (method) {\r\n\t\t\tcase 'get':\r\n\t\t\t\tservice\r\n\t\t\t\t\t.get(url, { params: data })\r\n\t\t\t\t\t.then((r) => {\r\n\t\t\t\t\t\tlet d = checkResult(r, msg, rPath, config)\r\n\t\t\t\t\t\tif (d) {\r\n\t\t\t\t\t\t\ts(d)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tj(r)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((e) => {\r\n\t\t\t\t\t\tcheckResult({}, msg, rPath, config)\r\n\t\t\t\t\t\tj(e)\r\n\t\t\t\t\t})\r\n\t\t\t\tbreak\r\n\t\t\tcase 'delete':\r\n\t\t\t\tlet keyT = isUrlData ? 'params' : 'data'\r\n\t\t\t\tservice\r\n\t\t\t\t\t.delete(url, { [keyT]: data })\r\n\t\t\t\t\t.then((r) => {\r\n\t\t\t\t\t\tlet d = checkResult(r, msg, rPath, config)\r\n\t\t\t\t\t\tif (d) {\r\n\t\t\t\t\t\t\ts(d)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tj(r)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((e) => {\r\n\t\t\t\t\t\tcheckResult({}, msg, rPath, config)\r\n\t\t\t\t\t\tj(e)\r\n\t\t\t\t\t})\r\n\t\t\t\tbreak\r\n\t\t\tcase 'post':\r\n\t\t\t\tservice\r\n\t\t\t\t\t.post(url, data, config)\r\n\t\t\t\t\t.then((r) => {\r\n\t\t\t\t\t\tlet d = checkResult(r, msg, rPath, config)\r\n\t\t\t\t\t\tif (d) {\r\n\t\t\t\t\t\t\ts(d)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tj(r)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((e) => {\r\n\t\t\t\t\t\tcheckResult({}, msg, rPath, config)\r\n\t\t\t\t\t\tj(e)\r\n\t\t\t\t\t})\r\n\t\t\t\tbreak\r\n\t\t\tcase 'put':\r\n\t\t\t\tservice\r\n\t\t\t\t\t.put(url, data, config)\r\n\t\t\t\t\t.then((r) => {\r\n\t\t\t\t\t\tlet d = checkResult(r, msg, rPath, config)\r\n\t\t\t\t\t\tif (d) {\r\n\t\t\t\t\t\t\ts(d)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tj(r)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((e) => {\r\n\t\t\t\t\t\tcheckResult({}, msg, rPath, config)\r\n\t\t\t\t\t\tj(e)\r\n\t\t\t\t\t})\r\n\t\t\t\tbreak\r\n\t\t\tdefault:\r\n\t\t}\r\n\t})\r\n}\r\n\r\n/**\r\n * 检查请求传入的各个参数\r\n * @param method 请求方法\r\n * @param url 地址\r\n * @param data 餐宿\r\n * @param msg 错误信息\r\n * @param rPath 返回数据路径（提取）\r\n * @param config 请求配置\r\n * @param isUrlData delete方法传参模式 true:params,false:data\r\n * @returns {Promise<*>}\r\n */\r\nfunction checkRequest(\r\n\tmethod: string,\r\n\turl: string,\r\n\tdata: Collection = {},\r\n\tmsg?: string | null,\r\n\trPath?: string[],\r\n\tconfig?: RequestConfigR,\r\n\tisUrlData?: boolean\r\n) {\r\n\treturn new Promise((s, j) => {\r\n\t\tif (url) {\r\n\t\t\tif (config && config.spin) {\r\n\t\t\t\tcounts(true)\r\n\t\t\t}\r\n\t\t\tlet url_ = url\r\n\t\t\tif (window && window.hasOwnProperty('g')) {\r\n\t\t\t\t/*所有特定缩写字母开头的地址，都会被改变加上config.js（public里的全局配置文件，在index.html引入，在打包后通过更改该文件用于不\r\n\t\t\t\t 同环境的部署）里配置的地址变成绝对地址，如:\r\n\t\t\t\t config.js里配置了 window.g={mgrURL:'http://mgr.myweb.com'}\r\n\t\t\t\t 请求地址 ‘/mgr/file’ 会被改变为 'http://mgr.myweb.com/file'\r\n\t\t\t\t */\r\n\r\n\t\t\t\t// @ts-ignore\r\n\t\t\t\tconst _g = window.g\r\n\t\t\t\tlet httpEnv = Object.keys(_g)\r\n\t\t\t\t\t.filter((e) => e?.indexOf?.('URL') > -1)\r\n\t\t\t\t\t.map((e) => e.replace?.('URL', ''))\r\n\r\n\t\t\t\tfor (let e of httpEnv) {\r\n\t\t\t\t\tlet regExp = new RegExp('^/' + e + '(?=/.*$)', 'i')\r\n\t\t\t\t\tif (regExp.test(url) && _g[e + 'URL']) {\r\n\t\t\t\t\t\turl_ = _g[e + 'URL'] + url.replace(regExp, '')\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet data_: Collection | undefined\r\n\t\t\tif (config?.headers?.['Content-Type'] === 'multipart/form-data') {\r\n\t\t\t\tdata_ = data\r\n\t\t\t} else {\r\n\t\t\t\tif (data && !isEmpty(data)) {\r\n\t\t\t\t\tif (Array.isArray(data)) {\r\n\t\t\t\t\t\tdata_ = []\r\n\t\t\t\t\t\tfor (let e of data) {\r\n\t\t\t\t\t\t\tif (e || e === 0 || e === false || (e === '' && config && !config.noEmptyStr)) {\r\n\t\t\t\t\t\t\t\tdata_.push(e)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdata_ = {}\r\n\t\t\t\t\t\tfor (let key in data) {\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tdata.hasOwnProperty(key) &&\r\n\t\t\t\t\t\t\t\t(data[key] ||\r\n\t\t\t\t\t\t\t\t\tdata[key] === 0 ||\r\n\t\t\t\t\t\t\t\t\tdata[key] === false ||\r\n\t\t\t\t\t\t\t\t\t(data[key] === '' && config && !config.noEmptyStr))\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tdata_[key] = data[key]\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet method_ = method.toLowerCase()\r\n\t\t\thandleRequest(method_, url_, data_, msg, rPath, config, isUrlData)\r\n\t\t\t\t.then((r) => {\r\n\t\t\t\t\ts(r)\r\n\t\t\t\t})\r\n\t\t\t\t.catch((e) => {\r\n\t\t\t\t\tj(e)\r\n\t\t\t\t})\r\n\t\t} else {\r\n\t\t\tconsole.error('没有请求地址:url')\r\n\t\t\tj('没有请求地址:url')\r\n\t\t}\r\n\t})\r\n}\r\n\r\n/**\r\n * @description 基于axios封装的请求插件，引入库时使用this.$fetch时直接调用以下方法（选项式），例如：this.$fetch.get(\"/getData\",{id:1})，\r\n * vue3的setup模式使用：proxy调用（更推荐单独引用：import {$fetch} from '@zhangqingcq/plug-r-qw'）\r\n * 单独引入时遵循Es Modules规范即可\r\n * @class\r\n */\r\nexport default {\r\n\t/**\r\n\t * @description 初始化该请求插件，单独引入的话调用一次后，方可实现spin等功能，默认在该库安装时已自动化初始化了该请求插件\r\n\t * @function\r\n\t * @param {object} store 项目中vuex的store，或pinia的useStore\r\n\t * @param app 当前vue实例\r\n\t */\r\n\tinit(store: any, app: any) {\r\n\t\tservice.store = store\r\n\t\tproxy = app.config.globalProperties\r\n\t} /**\r\n\t * post 请求\r\n\t * @function\r\n\t * @param {string} url 请求地址\r\n\t * @param {object} data 请求数据\r\n\t * @param {string} msg 错误信息，在控制台输出，方便调试，不用可以不传，例如：\r\n\t * @example this.$fetch.post(\"/getDataB\",{name:'ricky'},\"获取数据B失败\")\r\n\t * @param {Array.<string>} rPath 请求结果提取路径，如：[data,list]表示data.list,如不需过滤可不传\r\n\t * @param {object} config 请求配置  如请求过程需要遮罩层，设置 spin:true即可\r\n\t * @return {Promise<object>}\r\n\t * @example this.$fetch.post(\"/getData\",{id:1},null,['result','list'])\r\n\t *  .then(r=>{\r\n\t *      console.log(r)\r\n\t *      r相当于:data.result.list,data是网络请求结果\r\n\t *  })\r\n\t *\r\n\t * 注意：\r\n\t *  请求最多支持5个入参，最少一个(url)，依次为：url,data,msg,rPath,config。如果要传靠后的入参，但不想传前面的，应该这样传：\r\n\t *  this.$fetch.post(\"/setData\",{},null,[],{\r\n\t *     headers: {\r\n\t *         'Content-Type': 'multipart/form-data'\r\n\t *       },\r\n\t *       spin:true\r\n\t *   }\r\n\t *  )\r\n\t */,\r\n\tpost(url: string, data?: Collection, msg?: string | null, rPath?: string[], config?: RequestConfigR) {\r\n\t\treturn new Promise((s, j) => {\r\n\t\t\tcheckRequest('post', url, data, msg, rPath, config)\r\n\t\t\t\t.then((r) => {\r\n\t\t\t\t\ts(r)\r\n\t\t\t\t})\r\n\t\t\t\t.catch((e) => {\r\n\t\t\t\t\tj(e)\r\n\t\t\t\t})\r\n\t\t})\r\n\t} /**\r\n\t * put请求\r\n\t * @param {string} url 请求地址\r\n\t * @param {object} data 请求数据\r\n\t * @param {string} msg 错误信息，在控制台输出，方便调试，不用可以不传\r\n\t * @param {Array.<string>} rPath 请求结果提取路径\r\n\t * @param {object} config 请求配置  如请求过程需要遮罩层，设置 spin:true即可\r\n\t * @return {Promise<unknown>}\r\n\t */,\r\n\tput(url: string, data?: Collection, msg?: string | null, rPath?: string[], config?: RequestConfigR) {\r\n\t\treturn new Promise((s, j) => {\r\n\t\t\tcheckRequest('put', url, data, msg, rPath, config)\r\n\t\t\t\t.then((r) => {\r\n\t\t\t\t\ts(r)\r\n\t\t\t\t})\r\n\t\t\t\t.catch((e) => {\r\n\t\t\t\t\tj(e)\r\n\t\t\t\t})\r\n\t\t})\r\n\t} /**\r\n\t * get请求\r\n\t * @param {string} url 请求地址\r\n\t * @param {object} data 请求数据\r\n\t * @param {string} msg 错误信息，在控制台输出，方便调试，不用可以不传\r\n\t * @param {Array.<string>} rPath 请求结果提取路径\r\n\t * @param {object} config 请求配置  如请求过程需要遮罩层，设置 spin:true即可\r\n\t * @return {Promise<unknown>}\r\n\t * PS: get请求时(delete请求同理)，可以把请求参数写在url里，也可以写在data里，注意写在data里时，data是对象\r\n\t * 以请求'/devices',找到id=2,name=meter举例：\r\n\t *  只传url时，url = '/devices?id=2&name=meter'\r\n\t *  url和data都传时,url = '/devices',data={id:2,name:'meter'}\r\n\t */,\r\n\tget(url: string, data?: Collection, msg?: string | null, rPath?: string[], config?: RequestConfigR) {\r\n\t\treturn new Promise((s, j) => {\r\n\t\t\tcheckRequest('get', url, data, msg, rPath, config)\r\n\t\t\t\t.then((r) => {\r\n\t\t\t\t\ts(r)\r\n\t\t\t\t})\r\n\t\t\t\t.catch((e) => {\r\n\t\t\t\t\tj(e)\r\n\t\t\t\t})\r\n\t\t})\r\n\t} /**\r\n\t * delete 请求\r\n\t * @param {string} url 请求地址\r\n\t * @param {object} data 请求数据\r\n\t * @param {string} msg 错误信息，在控制台输出，方便调试，不用可以不传\r\n\t * @param {Array.<string>} rPath 请求结果提取路径\r\n\t * @param {object} config 请求配置  如请求过程需要遮罩层，设置 spin:true即可\r\n\t * @param isUrlData 传参模式 true:params,false:data\r\n\t * @return {Promise<unknown>}\r\n\t */,\r\n\tdelete(\r\n\t\turl: string,\r\n\t\tdata?: Collection,\r\n\t\tmsg?: string | null,\r\n\t\trPath?: string[],\r\n\t\tconfig?: RequestConfigR,\r\n\t\tisUrlData: boolean = true\r\n\t) {\r\n\t\treturn new Promise((s, j) => {\r\n\t\t\tcheckRequest('delete', url, data, msg, rPath, config, isUrlData)\r\n\t\t\t\t.then((r) => {\r\n\t\t\t\t\ts(r)\r\n\t\t\t\t})\r\n\t\t\t\t.catch((e) => {\r\n\t\t\t\t\tj(e)\r\n\t\t\t\t})\r\n\t\t})\r\n\t} /**\r\n\t * 并发请求   例如：\r\n\t * @example this.$fetch.all(\r\n\t *  [\r\n\t *    this.$fetch.get(\"/getData\"),\r\n\t *    this.$fetch.post(\"/getDataB\",{name:'ricky'})\r\n\t *  ]\r\n\t * )\r\n\t */,\r\n\tall: axios.all /**\r\n\t * 并发请求结果分离 例如：\r\n\t * @example this.$fetch.all(\r\n\t *  [\r\n\t *    this.$fetch.get(\"/getData\"),\r\n\t *    this.$fetch.post(\"/getDataB\",{name:'ricky'})\r\n\t *  ]\r\n\t * )\r\n\t *  .then(\r\n\t *    this.$fetch.spread((result1,result2)=>{\r\n\t *        console.log(result1,result2)\r\n\t *    })\r\n\t *   )\r\n\t */,\r\n\tspread: axios.spread /**\r\n\t * 该请求插件暴露给外界的配置对象，为axios.create创建的实例对象，使用方法见axios官方网站\r\n\t */,\r\n\tconfig: service\r\n}\r\n","<!--PagePro 极简页签，支持v-model绑定当前页数，可选每页条数，可禁用\r\n@created 2024.04.18\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script setup lang=\"ts\">\r\n\timport t from '../../locale/i18nSFC'\r\n\timport Proxy from '../../utils/proxy'\r\n\timport { getStringWidth } from '../../utils/needImportFunc'\r\n\r\n\tconst emit = defineEmits(['update:modelValue', 'on-change', 'on-page-size-change'])\r\n\tconst pageRef = ref()\r\n\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\tmodelValue?: number\r\n\t\t\ttotal?: number\r\n\t\t\tpageSize?: number\r\n\t\t\tsize?: 'small' | 'default'\r\n\t\t\tpageSizeOpts?: number[]\r\n\t\t\tshowTotal?: boolean /*是否展示total*/\r\n\t\t\tshowSizer?: boolean /*是否展示sizer*/\r\n\t\t\ttransfer?: boolean\r\n\t\t\tdisabled?: boolean\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\tmodelValue: 1,\r\n\t\t\ttotal: 0,\r\n\t\t\tpageSize: 10,\r\n\t\t\tsize: 'default',\r\n\t\t\tpageSizeOpts: () => Proxy()?.pageSizes || [10, 20, 50, 100],\r\n\t\t\tshowTotal: () => Proxy()?.pageShowTotal,\r\n\t\t\tshowSizer: () => Proxy()?.pageShowSizer,\r\n\t\t\ttransfer: true,\r\n\t\t\tdisabled: false\r\n\t\t}\r\n\t)\r\n\r\n\tconst _fontSizeBase = Proxy?.()?.fontSizeBase || 14\r\n\tconst currentPadding = ref(16)\r\n\r\n\tconst current = computed({\r\n\t\tget() {\r\n\t\t\treturn props.modelValue\r\n\t\t},\r\n\t\tset(v) {\r\n\t\t\temit('update:modelValue', v)\r\n\t\t\temit('on-change', v)\r\n\t\t}\r\n\t})\r\n\r\n\tconst pageSizeT = computed({\r\n\t\tget() {\r\n\t\t\treturn props.pageSize\r\n\t\t},\r\n\t\tset(v) {\r\n\t\t\temit('on-page-size-change', v)\r\n\t\t\tif (current.value !== 1) {\r\n\t\t\t\tcurrent.value = 1\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\r\n\tconst currentSize = computed(() => {\r\n\t\tconst t = getStringWidth(String(props.total || 0), _fontSizeBase) + currentPadding.value + 2\r\n\t\treturn t < 32 ? 32 : t\r\n\t})\r\n\r\n\twatch(\r\n\t\tcurrentSize,\r\n\t\t(v) => {\r\n\t\t\tnextTick(function () {\r\n\t\t\t\tchangeCurrentSize(v)\r\n\t\t\t})\r\n\t\t},\r\n\t\t{ immediate: true }\r\n\t)\r\n\r\n\tfunction getPadding() {\r\n\t\tconst $inputEl = pageRef.value?.$el?.querySelector?.('input')\r\n\t\tif (!$inputEl) {\r\n\t\t\treturn 16\r\n\t\t}\r\n\t\tconst inputStyle = window.getComputedStyle($inputEl)\r\n\t\tconst paddingL = inputStyle?.paddingLeft\r\n\t\tconst paddingR = inputStyle?.paddingRight\r\n\t\tif (!paddingL || !paddingR) {\r\n\t\t\treturn 16\r\n\t\t}\r\n\t\treturn Number(paddingL.replace('px', '')) + Number(paddingR.replace('px', ''))\r\n\t}\r\n\r\n\tfunction changeCurrentSize(val: any) {\r\n\t\tconst $inputEl = pageRef.value?.$el?.querySelector?.('input')\r\n\t\tif ($inputEl?.style) {\r\n\t\t\t$inputEl.style.width = `${val}px`\r\n\t\t}\r\n\t}\r\n\r\n\tonMounted(() => {\r\n\t\tcurrentPadding.value = getPadding()\r\n\t})\r\n</script>\r\n\r\n<template>\r\n\t<div class=\"pagePro\" :class=\"{ pageProDefault: props.size === 'default' }\">\r\n\t\t<span v-if=\"props.showTotal\" class=\"pageTotal\"\r\n\t\t\t>{{ t('r.total') + ' ' }}{{ props.total }}{{ ' ' + t('r.items') }}</span\r\n\t\t>\r\n\t\t<Page\r\n\t\t\tref=\"pageRef\"\r\n\t\t\tv-model=\"current\"\r\n\t\t\t:page-size=\"pageSizeT\"\r\n\t\t\t:total=\"props.total\"\r\n\t\t\t:size=\"props.size\"\r\n\t\t\t:page-size-opts=\"props.pageSizeOpts\"\r\n\t\t\t:disabled=\"props.disabled\"\r\n\t\t\tsimple\r\n\t\t/>\r\n\t\t<div class=\"pageProSize\" v-if=\"props.showSizer\">\r\n\t\t\t<Select v-model=\"pageSizeT\" :size=\"props.size\" :transfer=\"props.transfer\" :disabled=\"props.disabled\">\r\n\t\t\t\t<Option v-for=\"item in props.pageSizeOpts\" :value=\"item\" :key=\"item\">{{ item }} {{ t('r.page') }}</Option>\r\n\t\t\t</Select>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n","<!--BtTablePage 表格-页签-表顶操作（如：批量XX，导出）集成UI组件\r\n@created 2023.08.15\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script lang=\"ts\" setup>\r\n\timport { h } from 'vue'\r\n\timport { cloneDeep } from 'lodash-es'\r\n\timport { TableColumnConfig, Radio } from 'view-ui-plus'\r\n\timport type { PredicateFunc } from '../../public'\r\n\timport Proxy from '../../utils/proxy'\r\n\timport { toLine, tooltipManual } from '../../utils/globalFunc'\r\n\timport { toHump } from '../../utils/needImportFunc'\r\n\timport $fetch from '../../utils/fetch.js'\r\n\timport { setTimeout } from '../../utils/timer'\r\n\timport PagePro from '../PagePro/PagePro.vue'\r\n\r\n\tconst emit = defineEmits(['on-selection-change', 'on-data-change'])\r\n\r\n\tlet tc: { showSettingCheck?: boolean; disableShowSetting?: boolean } = {\r\n\t\tshowSettingCheck: false,\r\n\t\tdisableShowSetting: false\r\n\t}\r\n\r\n\tconst TableColumnR = { ...tc, ...TableColumnConfig }\r\n\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\turl?: string /*表格拉取数据的接口地址*/\r\n\t\t\tmethod?: 'get' | 'post' /*表格拉取数据的接口的请求类型,get、post*/\r\n\t\t\tsearchData?: Record<string, any> /*表格条件查询数据*/\r\n\t\t\tcolumns?: Array<typeof TableColumnR> /*表格表头结构数据，同view-ui-plus*/\r\n\t\t\tdataHandler?: (d: any) => {\r\n\t\t\t\tdata: Record<string, any>\r\n\t\t\t\ttotal: number\r\n\t\t\t\t[k: keyof any]: any\r\n\t\t\t} /*接口数据处理方法，处理后格式须为{data:[...],total:xx}*/\r\n\t\t\tselection?: boolean /*是否展示每列开头选择框*/\r\n\t\t\tradio?: boolean /*表格是否是单选表格，每次只能选中一行*/\r\n\t\t\tselectionFixed?: 'left' | 'right' | false /*每列开头选择框固定*/\r\n\t\t\trowClickSelect?: boolean /*是否点击行操作开头选择框*/\r\n\t\t\tdata?: any[] /*表格默认数据，没有url的本地静态表格使用*/\r\n\t\t\tsortable?: 'custom' | '' /*排序模式*/\r\n\t\t\tinitData?: boolean /*初始化数据，即组件创建后自动拉取第一次数据*/\r\n\t\t\thighlightRow?: boolean /*高亮当前行*/\r\n\t\t\trowClickNum?: number /*自动拉取第一次数据时点击第几行，默认-1，不点击*/\r\n\t\t\ttableEmptyTdHandle?: boolean /*表格内容为空是否显示为‘--’*/\r\n\t\t\tnoBorderTable?: boolean /*表格无边框*/\r\n\t\t\torderDefault?: 'asc' | 'desc' /*排序是升是降*/\r\n\t\t\torderKey?: string /*排序的key*/\r\n\t\t\torderKeyFormat?: 'underline' | 'camelcase' /*排序key的格式*/\r\n\t\t\tgetDataLoading?: boolean /*拉取表格数据时显示遮罩层*/\r\n\t\t\tshowTopRow?: boolean /*展示顶行（列表设置、批量操作按钮、导出等按钮、统计信息等）,各项子内容通过slot接入*/\r\n\t\t\tlightHead?: boolean /*浅色背景表头，避免和headerBar菜单紧邻时页面局部颜色不平衡*/\r\n\t\t\tnoPage?: boolean /*表格页签*/\r\n\t\t\tusePagePro?: boolean /*是否使用pagePro组件作为页签*/\r\n\t\t\tshowTotal?: boolean /*page是否展示total*/\r\n\t\t\tshowSizer?: boolean /*page是否展示sizer*/\r\n\t\t\tpageSize?: number /*每页条数*/\r\n\t\t\tpageComponentSize?: 'small' | 'default' /*页签大小*/\r\n\t\t\tnoElevator?: boolean /*页签不带电梯*/\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\turl: '',\r\n\t\t\tmethod: 'get',\r\n\t\t\tsearchData: () => ({}),\r\n\t\t\tcolumns: () => [],\r\n\t\t\tselection: false,\r\n\t\t\tradio: false,\r\n\t\t\tselectionFixed: false,\r\n\t\t\trowClickSelect: true,\r\n\t\t\tdata: () => [],\r\n\t\t\tsortable: '',\r\n\t\t\tinitData: true,\r\n\t\t\thighlightRow: false,\r\n\t\t\trowClickNum: -1,\r\n\t\t\ttableEmptyTdHandle: false,\r\n\t\t\tnoBorderTable: false,\r\n\t\t\torderDefault: 'desc',\r\n\t\t\torderKey: 'id',\r\n\t\t\torderKeyFormat: 'underline',\r\n\t\t\tgetDataLoading: false,\r\n\t\t\tshowTopRow: false,\r\n\t\t\tlightHead: false,\r\n\t\t\tnoPage: false,\r\n\t\t\tusePagePro: () => Proxy()?.btTablePageUsePagePro,\r\n\t\t\tshowTotal: () => Proxy()?.pageShowTotal,\r\n\t\t\tshowSizer: () => Proxy()?.pageShowSizer,\r\n\t\t\tpageSize: 10,\r\n\t\t\tpageComponentSize: 'default',\r\n\t\t\tnoElevator: false\r\n\t\t}\r\n\t)\r\n\r\n\tconst pageSizes = Proxy()?.pageSizes || [10, 20, 50, 100]\r\n\tconst dataT = ref(props.data)\r\n\tconst pageSizeT = ref<number>(\r\n\t\t(localStorage.getItem('btPageSize') && Number(localStorage.getItem('btPageSize'))) || props.pageSize\r\n\t)\r\n\tconst current = ref(1)\r\n\tconst total = ref(0)\r\n\tlet selected: Record<string, any>[] = []\r\n\tlet currentKey: string | null\r\n\tlet currentIndex: number | null\r\n\tlet _key: string = props.orderKey\r\n\tlet _order: string = props.orderDefault\r\n\tconst tableContainerHeight = 300\r\n\r\n\tconst columnsFixed = computed(() => {\r\n\t\tfor (let e of props.columns) {\r\n\t\t\tif (e?.fixed) {\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false\r\n\t})\r\n\r\n\tconst fixedTable = computed(() => props.selectionFixed || columnsFixed.value)\r\n\r\n\tconst queryData = computed(() => {\r\n\t\tlet t: Record<string, any> = {\r\n\t\t\t...props.searchData,\r\n\t\t\tcurrent: current.value,\r\n\t\t\tsize: pageSizeT.value\r\n\t\t}\r\n\t\tif (props.sortable === 'custom') {\r\n\t\t\tif (props.orderKeyFormat === 'underline') {\r\n\t\t\t\tt[_order] = toLine(_key)\r\n\t\t\t} else if (props.orderKeyFormat === 'camelcase') {\r\n\t\t\t\tt[_order] = toHump(_key)\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn t\r\n\t})\r\n\r\n\tconst columnsT = computed(() => {\r\n\t\tlet t = props.columns.filter((e) => {\r\n\t\t\treturn e && e.type !== 'selection'\r\n\t\t})\r\n\t\tif (props.selection || props.radio) {\r\n\t\t\tlet c: Record<string, any>\r\n\t\t\tif (props.radio) {\r\n\t\t\t\tc = {\r\n\t\t\t\t\ttitle: ' ',\r\n\t\t\t\t\twidth: 65,\r\n\t\t\t\t\trender: (_h: any, params: Record<string, any>) => {\r\n\t\t\t\t\t\treturn h(Radio, {\r\n\t\t\t\t\t\t\tmodelValue: params.row.btChecked\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tc = {\r\n\t\t\t\t\ttype: 'selection',\r\n\t\t\t\t\twidth: 60\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (props.selectionFixed) {\r\n\t\t\t\tc.fixed = props.selectionFixed\r\n\t\t\t}\r\n\t\t\tt.unshift(c)\r\n\t\t}\r\n\t\tt.forEach((e) => {\r\n\t\t\tif (!e) {\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tif (props.sortable === 'custom') {\r\n\t\t\t\tif (e.key && e.sortable !== true && e.sortable !== false) {\r\n\t\t\t\t\te.sortable = 'custom'\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\te.sortable = false\r\n\t\t\t}\r\n\t\t\tif (!e.align) {\r\n\t\t\t\te.align = Proxy()?.btTablePageAlign || 'center'\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tt.forEach((e) => {\r\n\t\t\tif (e?.key && e.render === undefined) {\r\n\t\t\t\tif (e.tooltip) {\r\n\t\t\t\t\te.render = tooltipManual(e.key, props.tableEmptyTdHandle)\r\n\t\t\t\t} else {\r\n\t\t\t\t\te.render = (_h: any, params: any) => {\r\n\t\t\t\t\t\tlet td = ''\r\n\t\t\t\t\t\tif (e?.key) {\r\n\t\t\t\t\t\t\ttd = params.row[e.key]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (props.tableEmptyTdHandle) {\r\n\t\t\t\t\t\t\treturn h('span', td === '' ? '--' : td ?? '--')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn h('span', td)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\treturn t\r\n\t})\r\n\r\n\tconst dataS = computed({\r\n\t\tget() {\r\n\t\t\treturn dataT.value.map((e: Record<string, any>, i: number) => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tbtKey: 'bt-' + i,\r\n\t\t\t\t\tbtChecked: false,\r\n\t\t\t\t\t...e\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\tset(v: any) {\r\n\t\t\tdataT.value = v\r\n\t\t}\r\n\t})\r\n\r\n\tconst selectedIds = computed(() => selected.map((e: Record<string, any>) => e?.id))\r\n\r\n\tconst selectedKeys = computed(() => selected.map((e: Record<string, any>) => e?.btKey))\r\n\r\n\tconst tableRef = ref()\r\n\r\n\twatch(() => props.searchData, search, { deep: true })\r\n\r\n\twatch(\r\n\t\t() => props.orderDefault,\r\n\t\t(after) => {\r\n\t\t\t_order = after\r\n\t\t}\r\n\t)\r\n\r\n\twatch(\r\n\t\t() => props.orderKey,\r\n\t\t(after) => {\r\n\t\t\t_key = after\r\n\t\t}\r\n\t)\r\n\r\n\tfunction search() {\r\n\t\t/*私有*/\r\n\t\tcurrent.value = 1\r\n\t\tgetDataAndClickRow()\r\n\t}\r\n\r\n\tfunction initTable() {\r\n\t\t/*私有*/\r\n\t\tif (props.initData) {\r\n\t\t\tgetDataAndClickRow()\r\n\t\t}\r\n\t}\r\n\r\n\tfunction addRow(row: Record<string, any>) {\r\n\t\t/*添加行（公开），分页时不推荐使用，详细见说明文档*/\r\n\t\tdataT.value.unshift(cloneDeep(row))\r\n\t\tsetTimeout(() => {\r\n\t\t\ttableRef.value?.clickCurrentRow?.(0)\r\n\t\t}, 100)\r\n\t}\r\n\r\n\t/**\r\n\t * 更新行数据（公开）\r\n\t * @param {object} row 新的行数据（只更新旧数据和新数据都有的字段，如想更新的其中一个字段为row.name，那么旧row数据需要有name这个字段）\r\n\t * @param {number|boolean} setCurrentRow 1.数字，行在表数据中的index；2.布尔值，更新当前行\r\n\t * @param {boolean} clickCurrentRow 更新完数据点击更新的行\r\n\t */\r\n\tfunction setRowData(row: Record<string, any>, setCurrentRow: boolean, clickCurrentRow: boolean) {\r\n\t\tlet index: number | null = null\r\n\t\tif (setCurrentRow) {\r\n\t\t\tindex = currentIndex\r\n\t\t} else if (typeof setCurrentRow === 'number') {\r\n\t\t\tindex = setCurrentRow\r\n\t\t}\r\n\t\tif (index !== null) {\r\n\t\t\tlet t = dataT.value[index]\r\n\t\t\tfor (let key in row) {\r\n\t\t\t\tif (row.hasOwnProperty(key)) {\r\n\t\t\t\t\tt[key] = row[key]\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (clickCurrentRow) {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\ttableRef.value?.clickCurrentRow?.(index)\r\n\t\t\t\t}, 10)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction deleteRow(index: number) {\r\n\t\t/*根据索引数字删除行（公开），分页时不推荐使用，详细见说明文档*/\r\n\t\tdataT.value.splice(index, 1)\r\n\t\tsetTimeout(() => {\r\n\t\t\ttableRef.value?.clickCurrentRow?.(0)\r\n\t\t}, 100)\r\n\t}\r\n\r\n\tfunction onRowClick(row: Record<string, any>, i: number) {\r\n\t\t/*私有*/\r\n\t\tif (row.btChecked && props.radio) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif ((props.selection || props.radio) && props.rowClickSelect) {\r\n\t\t\ttableRef.value?.toggleSelect?.(i)\r\n\t\t}\r\n\t}\r\n\r\n\tfunction onSelect(s: any, row: Record<string, any>) {\r\n\t\t/*私有*/\r\n\t\tcurrentKey = row.btKey\r\n\t\tcurrentIndex = Number(row.btKey.split('-')[1])\r\n\t\tif (props.radio) {\r\n\t\t\tdataT.value[currentIndex].btChecked = true\r\n\t\t}\r\n\t}\r\n\r\n\tfunction selectionHandle(selection: any) {\r\n\t\t/*私有*/\r\n\t\tif (props.radio) {\r\n\t\t\tfor (let e of dataS.value) {\r\n\t\t\t\tif (e?.btKey && e.btKey !== currentKey) {\r\n\t\t\t\t\tdataT.value[Number(e.btKey.split('-')[1])].btChecked = false\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tselected = selection\r\n\t\temit('on-selection-change', selection)\r\n\t}\r\n\r\n\tfunction getSelected() {\r\n\t\t/*获取已选行数据（公开）*/\r\n\t\treturn cloneDeep(selected)\r\n\t}\r\n\r\n\tfunction changePage() {\r\n\t\t/*私有*/\r\n\t\tgetDataAndClickRow()\r\n\t}\r\n\r\n\tfunction pageSizeChange(v: number) {\r\n\t\t/*私有*/\r\n\t\tpageSizeT.value = v\r\n\t\tlocalStorage.setItem('btPageSize', String(v))\r\n\t\tif (current.value === 1) {\r\n\t\t\tgetDataAndClickRow()\r\n\t\t}\r\n\t}\r\n\r\n\tfunction onSortChange({ key, order }: { key: string; order: string }) {\r\n\t\t/*表头排序(私有)*/\r\n\t\tif (_order === 'normal') {\r\n\t\t\t/*恢复到默认页面排序*/\r\n\t\t\t_key = props.orderKey\r\n\t\t\t_order = props.orderDefault\r\n\t\t} else {\r\n\t\t\t_key = key\r\n\t\t\t_order = order\r\n\t\t}\r\n\t\tcurrent.value = 1\r\n\t\tgetTableData()\r\n\t}\r\n\r\n\t/**\r\n\t * 主动选中行（公开）多选、单选模式皆可用\r\n\t * @param {Number|Array|Function} predicate 断言,选中的条件：\r\n\t * 1. Number:根据索引index选中行\r\n\t * 2. Array:根据索引index数组选中行(仅多选)\r\n\t * 3. Function:根据断言函数返回true的行选中\r\n\t */\r\n\tfunction selectRow(predicate: number | number[] | PredicateFunc) {\r\n\t\tconst _p = predicate\r\n\t\tif (typeof _p === 'number') {\r\n\t\t\tclearSelect()\r\n\t\t\tcurrentIndex = _p\r\n\t\t\tcurrentKey = dataS.value?.[_p]?.btKey\r\n\t\t\ttableRef.value?.clickCurrentRow?.(_p)\r\n\t\t} else if (Array.isArray(_p)) {\r\n\t\t\tif (props.radio || !props.selection) {\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tclearSelect()\r\n\t\t\tfor (let i of _p) {\r\n\t\t\t\ttableRef.value?.clickCurrentRow?.(i)\r\n\t\t\t}\r\n\t\t} else if (typeof _p === 'function') {\r\n\t\t\tfor (let i = 0; i < dataS.value.length; i++) {\r\n\t\t\t\tconst e = dataS.value[i]\r\n\t\t\t\tif (_p(e)) {\r\n\t\t\t\t\ttableRef.value?.clickCurrentRow?.(i)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction clearSelect() {\r\n\t\t/*清空选择（公开）*/\r\n\t\tif (props.radio) {\r\n\t\t\tif (selectedKeys.value.length > 0 && dataS.value.length > 0) {\r\n\t\t\t\tlet i = selectedKeys.value[0].split('-')[1]\r\n\t\t\t\tdataS.value[i].btChecked = false\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ttableRef.value?.selectAll?.(false)\r\n\t\t}\r\n\t\tif (selected.length > 0) {\r\n\t\t\tselected = []\r\n\t\t\temit('on-selection-change', [])\r\n\t\t}\r\n\t\tcurrentKey = null\r\n\t\tcurrentIndex = null\r\n\t}\r\n\r\n\tfunction clearTableData() {\r\n\t\t/*清空选择（公开）,用于特殊场景下重置表格，不拉取数据，如需刷新数据直接调用getTableData*/\r\n\t\tdataT.value = []\r\n\t\tclearSelect()\r\n\t\tcurrent.value = 1\r\n\t\ttotal.value = 0\r\n\t}\r\n\r\n\tfunction getTableData(order?: string, orderKey?: string, keepSelect?: boolean) {\r\n\t\t/*拉取表格数据（公开）*/\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tif (order) {\r\n\t\t\t\t_order = order\r\n\t\t\t}\r\n\t\t\tif (orderKey) {\r\n\t\t\t\t_key = orderKey\r\n\t\t\t}\r\n\t\t\tif (props.url) {\r\n\t\t\t\t$fetch[props.method](props.url, queryData.value, '', [], { spin: props.getDataLoading })\r\n\t\t\t\t\t.then((d: any) => {\r\n\t\t\t\t\t\tlet r: Record<string, any>\r\n\t\t\t\t\t\tif (!keepSelect) {\r\n\t\t\t\t\t\t\tclearSelect()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (typeof props.dataHandler === 'function') {\r\n\t\t\t\t\t\t\tr = props.dataHandler(d)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tr = d\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (r.data) {\r\n\t\t\t\t\t\t\t/*接口返回数据为空时可能是用null表示，所以有下面逻辑*/\r\n\t\t\t\t\t\t\tif (r.data.records || r.data.records === null) {\r\n\t\t\t\t\t\t\t\tdataT.value = r.data.records || []\r\n\t\t\t\t\t\t\t} else if (r.data.page) {\r\n\t\t\t\t\t\t\t\tif (r.data.page.records || r.data.page.records === null) {\r\n\t\t\t\t\t\t\t\t\tdataT.value = r.data.page.records || []\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else if (r.data.data) {\r\n\t\t\t\t\t\t\t\tif (r.data.data.records || r.data.data.records === null) {\r\n\t\t\t\t\t\t\t\t\tdataT.value = r.data.data.records || []\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdataT.value = r.data\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttotal.value = r.data.page?.total || r.data.data?.total || r.data.total || r.total || 0\r\n\t\t\t\t\t\t\tif (total.value === 0 && current.value > 1 && dataT.value && dataT.value.length === 0) {\r\n\t\t\t\t\t\t\t\t/*如果没有数据，将当前页置为1*/\r\n\t\t\t\t\t\t\t\tcurrent.value = 1\r\n\t\t\t\t\t\t\t} else if (current.value > 1 && total.value <= (current.value - 1) * pageSizeT.value) {\r\n\t\t\t\t\t\t\t\t/*当前页并没有数据，自动拉取前一页数据*/\r\n\t\t\t\t\t\t\t\tcurrent.value--\r\n\t\t\t\t\t\t\t\tnextTick(function () {\r\n\t\t\t\t\t\t\t\t\tgetTableData(order, orderKey)\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\temit('on-data-change', r)\r\n\t\t\t\t\t\t\tresolve(r)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.warn('请求返回数据有误，无法使用')\r\n\t\t\t\t\t\t\tclearTableData()\r\n\t\t\t\t\t\t\temit('on-data-change', r)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((e: any) => {\r\n\t\t\t\t\t\tclearSelect()\r\n\t\t\t\t\t\tclearTableData()\r\n\t\t\t\t\t\temit('on-data-change', e)\r\n\t\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tconsole.warn('没有有效的请求地址，无法获取表格数据')\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tfunction getDataAndClickRow(clickCurrentRow?: boolean, order?: string, orderKey?: string) {\r\n\t\t/*单选模式时（非单选模式只拉数据不点击），拉取表格数据并且点击行，如果传true，则点击当前行，不传则点击 rowClickNum 指定行（公开）*/\r\n\t\tif (props.radio && (clickCurrentRow || props.rowClickNum !== -1)) {\r\n\t\t\tgetTableData(order, orderKey, clickCurrentRow).then(() => {\r\n\t\t\t\t//点击对应行\r\n\t\t\t\tif (dataT.value.length > 0) {\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tif (clickCurrentRow) {\r\n\t\t\t\t\t\t\ttableRef.value?.clickCurrentRow?.(currentIndex || 0)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttableRef.value?.clickCurrentRow?.(props.rowClickNum)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 10)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\tgetTableData()\r\n\t\t}\r\n\t}\r\n\r\n\tonMounted(initTable)\r\n\r\n\tdefineExpose({\r\n\t\tdataS,\r\n\t\tselectedIds,\r\n\t\taddRow,\r\n\t\tsetRowData,\r\n\t\tdeleteRow,\r\n\t\tgetSelected,\r\n\t\tselectRow,\r\n\t\tclearSelect,\r\n\t\tclearTableData,\r\n\t\tgetTableData,\r\n\t\tgetDataAndClickRow\r\n\t})\r\n</script>\r\n\r\n<template>\r\n\t<div class=\"btTablePage fullHeight flexColumnBox\" ref=\"tableBox\">\r\n\t\t<div class=\"topBtn\" v-show=\"props.showTopRow\">\r\n\t\t\t<slot name=\"tableSetting\" />\r\n\r\n\t\t\t<slot name=\"topMsg\" />\r\n\r\n\t\t\t<slot name=\"topBtnGroup\" />\r\n\t\t</div>\r\n\t\t<div class=\"tableContainer growFlexItem\">\r\n\t\t\t<div class=\"fullHeight relativeBox\">\r\n\t\t\t\t<div ref=\"tableContainerLOI\" class=\"fullFlowContent\">\r\n\t\t\t\t\t<Table\r\n\t\t\t\t\t\tref=\"tableRef\"\r\n\t\t\t\t\t\tv-bind=\"$attrs\"\r\n\t\t\t\t\t\t:height=\"(fixedTable && tableContainerHeight) || null\"\r\n\t\t\t\t\t\t:class=\"{ noBorderTable: props.noBorderTable, fullHeightTable: !fixedTable, lightHeadO: props.lightHead }\"\r\n\t\t\t\t\t\t:columns=\"columnsT\"\r\n\t\t\t\t\t\t:data=\"dataS\"\r\n\t\t\t\t\t\t:highlight-row=\"props.radio || props.highlightRow\"\r\n\t\t\t\t\t\t@on-select=\"onSelect\"\r\n\t\t\t\t\t\t@on-selection-change=\"selectionHandle\"\r\n\t\t\t\t\t\t@on-sort-change=\"onSortChange\"\r\n\t\t\t\t\t\t@on-row-click=\"onRowClick\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class=\"pageContainer\" v-show=\"!props.noPage\">\r\n\t\t\t<PagePro\r\n\t\t\t\tv-if=\"props.usePagePro\"\r\n\t\t\t\tv-model=\"current\"\r\n\t\t\t\t:total=\"total\"\r\n\t\t\t\t:showTotal=\"props.showTotal\"\r\n\t\t\t\t:pageSize=\"pageSizeT\"\r\n\t\t\t\t:showSizer=\"props.showSizer\"\r\n\t\t\t\t:pageSizeOpts=\"pageSizes\"\r\n\t\t\t\t:size=\"props.pageComponentSize\"\r\n\t\t\t\t@on-change=\"changePage\"\r\n\t\t\t\t@on-page-size-change=\"pageSizeChange\"\r\n\t\t\t/>\r\n\t\t\t<Page\r\n\t\t\t\tv-else\r\n\t\t\t\tv-model=\"current\"\r\n\t\t\t\t:total=\"total\"\r\n\t\t\t\t:pageSize=\"pageSizeT\"\r\n\t\t\t\t:pageSizeOpts=\"pageSizes\"\r\n\t\t\t\t:showSizer=\"props.showSizer\"\r\n\t\t\t\t:showTotal=\"props.showTotal\"\r\n\t\t\t\t:size=\"props.pageComponentSize\"\r\n\t\t\t\t:showElevator=\"!props.noElevator\"\r\n\t\t\t\t@on-change=\"changePage\"\r\n\t\t\t\t@on-page-size-change=\"pageSizeChange\"\r\n\t\t\t/>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n","<!--SelectInput 下拉选择和输入框组合，select选择要输入的key,input输入val\r\n@created 2023.08.16\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script lang=\"ts\" setup>\r\n\timport { debounce } from 'lodash-es'\r\n\timport t from '../../locale/i18nSFC'\r\n\r\n\tconst emit = defineEmits(['update:modelValue', 'on-change'])\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\tmodelValue?: Record<string, any> /*组件的值，建议使用v-model绑定，key对应select值，val对应input值*/\r\n\t\t\tlabelWidth?: number /*表单项标签宽度*/\r\n\t\t\tlabelTextAlign?: 'left' | 'center' | 'right' /*select内容对齐方式*/\r\n\t\t\titemWidth?: number | string /*表单项内容宽度,用于行内表单*/\r\n\t\t\tselectOption?: any[] /*选择框待选项*/\r\n\t\t\tplaceholder?: string\r\n\t\t\tclearable?: boolean\r\n\t\t\tdisabled?: boolean /*禁用，仅展示*/\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\tmodelValue: () => ({\r\n\t\t\t\tkey: null,\r\n\t\t\t\tval: null\r\n\t\t\t}),\r\n\t\t\tlabelWidth: 160,\r\n\t\t\tlabelTextAlign: 'right',\r\n\t\t\titemWidth: 200,\r\n\t\t\tselectOption: () => [],\r\n\t\t\tclearable: false,\r\n\t\t\tdisabled: false\r\n\t\t}\r\n\t)\r\n\r\n\tconst selectVal = computed({\r\n\t\tget() {\r\n\t\t\treturn props.modelValue?.key\r\n\t\t},\r\n\t\tset(v: any) {\r\n\t\t\tlet temp: Record<string, any> = {\r\n\t\t\t\tkey: v,\r\n\t\t\t\tval: null\r\n\t\t\t}\r\n\t\t\tif (selectVal.value && selectVal.value !== v) {\r\n\t\t\t\ttemp.beforeKey = selectVal.value\r\n\t\t\t}\r\n\t\t\temit('update:modelValue', temp)\r\n\t\t\temit('on-change', temp)\r\n\t\t}\r\n\t})\r\n\r\n\tconst inputVal = computed({\r\n\t\tget() {\r\n\t\t\treturn (props.modelValue && props.modelValue.val) || null\r\n\t\t},\r\n\t\tset(v: any) {\r\n\t\t\temit('update:modelValue', {\r\n\t\t\t\tkey: selectVal.value,\r\n\t\t\t\tval: v\r\n\t\t\t})\r\n\t\t}\r\n\t})\r\n\r\n\tconst labelSelectStyle = computed(() => ({\r\n\t\twidth: props.labelWidth + 'px',\r\n\t\ttextAlign: props.labelTextAlign\r\n\t}))\r\n\r\n\tconst inputStyle = computed(() => ({\r\n\t\twidth: typeof props.itemWidth === 'number' ? props.itemWidth + 'px' : props.itemWidth\r\n\t}))\r\n\r\n\tfunction inputChange(e: Record<string, any>) {\r\n\t\tif (e?.target && e.target.value !== undefined) {\r\n\t\t\thandleChange({\r\n\t\t\t\tkey: selectVal.value,\r\n\t\t\t\tval: e.target.value\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleChange = debounce((data) => {\r\n\t\temit('on-change', data)\r\n\t}, 500)\r\n</script>\r\n\r\n<template>\r\n\t<div>\r\n\t\t<Select v-model=\"selectVal\" :style=\"labelSelectStyle\" :disabled=\"Boolean(props.disabled)\" transfer>\r\n\t\t\t<Option\r\n\t\t\t\tv-for=\"(item, index) in props.selectOption\"\r\n\t\t\t\t:value=\"item?.val\"\r\n\t\t\t\t:label=\"item?.label\"\r\n\t\t\t\t:key=\"'selectInputOp' + item?.value + index\"\r\n\t\t\t\t:style=\"{ textAlign: props.labelTextAlign }\"\r\n\t\t\t/>\r\n\t\t</Select>\r\n\t\t<Input\r\n\t\t\tv-model=\"inputVal\"\r\n\t\t\t:placeholder=\"props.placeholder || t('r.pInput')\"\r\n\t\t\t:style=\"inputStyle\"\r\n\t\t\t:clearable=\"props.clearable\"\r\n\t\t\t:disabled=\"Boolean(props.disabled)\"\r\n\t\t\t@on-change=\"inputChange\"\r\n\t\t/>\r\n\t</div>\r\n</template>\r\n","type AmapR = { securityJsCode: string; key: string }\r\nlet _amap: AmapR = { securityJsCode: '', key: '' }\r\n\r\nexport function set({ securityJsCode, key }: AmapR): void {\r\n\t_amap.securityJsCode = securityJsCode\r\n\t_amap.key = key\r\n}\r\n\r\nexport function get(d: 'securityJsCode' | 'key'): string {\r\n\treturn _amap[d]\r\n}\r\n","<!--InputMap 带搜索框的地图组件，支持搜索地点，经纬度回显地点，缩放，移动地图，拖动标记，点击标记显示地点信息\r\n@created 2023.08.16\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script lang=\"ts\" setup>\r\n\timport { cloneDeep, isNumber } from 'lodash-es'\r\n\timport t from '../../locale/i18nSFC'\r\n\timport { setTimeout } from '../../utils/timer'\r\n\timport AMapLoader from '@amap/amap-jsapi-loader'\r\n\timport { get } from '../../utils/amap'\r\n\timport { Input } from 'view-ui-plus'\r\n\r\n\tconst emit = defineEmits(['update:modelValue', 'on-change'])\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\tmodelValue?: Record<string, any>\r\n\t\t\twidth?: string | number\r\n\t\t\theight?: string | number\r\n\t\t\tplaceholder?: string\r\n\t\t\tdisabled?: boolean\r\n\t\t\tshowMap?: boolean\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\tmodelValue: () => ({}),\r\n\t\t\twidth: '100%',\r\n\t\t\tdisabled: false,\r\n\t\t\tshowMap: true\r\n\t\t}\r\n\t)\r\n\r\n\tconst valueT = computed({\r\n\t\tget() {\r\n\t\t\tlet temp\r\n\t\t\tif (!props.modelValue) {\r\n\t\t\t\ttemp = {\r\n\t\t\t\t\tname: null\r\n\t\t\t\t}\r\n\t\t\t} else if (!props.modelValue.name) {\r\n\t\t\t\ttemp = {\r\n\t\t\t\t\t...props.modelValue,\r\n\t\t\t\t\tname: null\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\ttemp = cloneDeep(props.modelValue)\r\n\t\t\t}\r\n\t\t\treturn temp\r\n\t\t},\r\n\t\tset(val) {\r\n\t\t\temit('update:modelValue', cloneDeep(val))\r\n\t\t}\r\n\t})\r\n\r\n\tconst widthT = computed(() => {\r\n\t\tif (isNumber(props.width)) {\r\n\t\t\treturn props.width + 'px'\r\n\t\t} else {\r\n\t\t\treturn props.width\r\n\t\t}\r\n\t})\r\n\r\n\tconst heightT = computed(() => {\r\n\t\tif (isNumber(props.height)) {\r\n\t\t\treturn props.height + 'px'\r\n\t\t} else if (props.height) {\r\n\t\t\treturn props.height\r\n\t\t} else if (isNumber(props.width)) {\r\n\t\t\treturn props.width * 0.66 + 'px'\r\n\t\t} else {\r\n\t\t\treturn '200px'\r\n\t\t}\r\n\t})\r\n\r\n\tconst containerStyle = computed<Record<string, any>>(() => ({\r\n\t\twidth: widthT.value,\r\n\t\tposition: 'relative'\r\n\t}))\r\n\r\n\tconst mapStyle = computed<Record<string, any>>(() => ({\r\n\t\twidth: widthT.value,\r\n\t\theight: heightT.value,\r\n\t\tmarginTop: '6px',\r\n\t\topacity: props.showMap ? 1 : 0,\r\n\t\tposition: props.showMap ? 'relative' : 'absolute',\r\n\t\ttop: props.showMap ? 0 : '-10000px'\r\n\t}))\r\n\r\n\twatch(\r\n\t\t() => props.modelValue,\r\n\t\t(after) => {\r\n\t\t\t//更新地图mark\r\n\t\t\tif (after && after.lng && after.lat) {\r\n\t\t\t\tif (!Map || !GeoCoder) {\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tcreateMarker({\r\n\t\t\t\t\tlng: after.lng,\r\n\t\t\t\t\tlat: after.lat,\r\n\t\t\t\t\tname: after.name\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t)\r\n\r\n\tconst mapId = 'mapId' + Math.floor(Math.random() * 1000000000)\r\n\tconst mapInputRef = ref<InstanceType<typeof Input> | null>(null)\r\n\tconst mapRef = ref<HTMLDivElement | null>(null)\r\n\tlet infoWindow: Record<string, any> | null\r\n\r\n\tfunction checkHeight() {\r\n\t\tif ((mapRef.value && mapRef.value.clientHeight < 10) || !mapRef.value) {\r\n\t\t\tsetTimeout(checkHeight, 300)\r\n\t\t} else {\r\n\t\t\t/*高德地图实例初始化较慢，暂时延时1秒，后面寻找完美解决方案*/\r\n\t\t\tsetTimeout(initMap, 100)\r\n\t\t}\r\n\t}\r\n\r\n\tlet AMap: any\r\n\tlet Map: any\r\n\tlet GeoCoder: any\r\n\tlet AutoComplete: any\r\n\r\n\tfunction initMap() {\r\n\t\tAMapLoader.load({\r\n\t\t\tkey: get('key'),\r\n\t\t\tversion: '2.0',\r\n\t\t\tplugins: ['AMap.AutoComplete', 'AMap.Geocoder']\r\n\t\t}).then((_map) => {\r\n\t\t\tAMap = _map\r\n\t\t\tMap = new AMap.Map(mapId).on('complete', () => {\r\n\t\t\t\tGeoCoder = new AMap.Geocoder()\r\n\r\n\t\t\t\tif (props.modelValue?.lng && props.modelValue?.lat) {\r\n\t\t\t\t\tcreateMarker({\r\n\t\t\t\t\t\tlng: props.modelValue.lng,\r\n\t\t\t\t\t\tlat: props.modelValue.lat,\r\n\t\t\t\t\t\tname: props.modelValue.name\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\tconst iEl = mapInputRef.value?.$el?.children\r\n\t\t\t\tif (iEl && iEl.length > 1) {\r\n\t\t\t\t\tAutoComplete = new AMap.AutoComplete({\r\n\t\t\t\t\t\tinput: iEl[1]\r\n\t\t\t\t\t}).on('select', (val: Record<string, any>) => {\r\n\t\t\t\t\t\tif (val?.poi?.name) {\r\n\t\t\t\t\t\t\tif (val.poi.location?.lng && val.poi.location?.lat) {\r\n\t\t\t\t\t\t\t\tcreateMarker({\r\n\t\t\t\t\t\t\t\t\tname: val.poi.name,\r\n\t\t\t\t\t\t\t\t\tlng: val.poi.location.lng,\r\n\t\t\t\t\t\t\t\t\tlat: val.poi.location.lat\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tvalueT.value = {\r\n\t\t\t\t\t\t\t\t\tname: val.poi.name,\r\n\t\t\t\t\t\t\t\t\tlng: val.poi.location.lng,\r\n\t\t\t\t\t\t\t\t\tlat: val.poi.location.lat\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tMap?.setCity(val.poi.name, () => {\r\n\t\t\t\t\t\t\t\t\tlet center = Map.getCenter()\r\n\t\t\t\t\t\t\t\t\tcreateMarker({\r\n\t\t\t\t\t\t\t\t\t\tname: val.poi.name,\r\n\t\t\t\t\t\t\t\t\t\tlng: center.lng,\r\n\t\t\t\t\t\t\t\t\t\tlat: center.lat\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\tvalueT.value = {\r\n\t\t\t\t\t\t\t\t\t\tname: val.poi.name,\r\n\t\t\t\t\t\t\t\t\t\tlng: center.lng,\r\n\t\t\t\t\t\t\t\t\t\tlat: center.lat\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\temit('on-change', valueT.value)\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\tMap?.on('hotspotclick', (d: Record<string, any>) => {\r\n\t\t\t\t\tcreateMarker({\r\n\t\t\t\t\t\tname: d.name,\r\n\t\t\t\t\t\tlng: d.lnglat.lng,\r\n\t\t\t\t\t\tlat: d.lnglat.lat\r\n\t\t\t\t\t})\r\n\t\t\t\t\tvalueT.value = {\r\n\t\t\t\t\t\tname: d.name,\r\n\t\t\t\t\t\tlng: d.lnglat.lng,\r\n\t\t\t\t\t\tlat: d.lnglat.lat\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\tfunction createMarker({ lng, lat, name }: { lng: number; lat: number; name: string }) {\r\n\t\tMap?.clearMap()\r\n\t\tlet point = new AMap.LngLat(lng, lat)\r\n\t\tlet marker = new AMap.Marker({\r\n\t\t\tmap: Map,\r\n\t\t\tposition: point,\r\n\t\t\tdraggable: true\r\n\t\t})\r\n\t\tMap?.add(marker)\r\n\t\tgetAddress(lng, lat)\r\n\t\tmarker.on('dragend', () => {\r\n\t\t\tlet dragPoint = marker.getPosition()\r\n\t\t\tvalueT.value = {\r\n\t\t\t\tname: name || null,\r\n\t\t\t\tlng: dragPoint.lng,\r\n\t\t\t\tlat: dragPoint.lat\r\n\t\t\t}\r\n\t\t\tgetAddress(lng, lat)\r\n\t\t})\r\n\t\tmarker.on('click', (e: Record<string, any>) => {\r\n\t\t\tif (infoWindow) {\r\n\t\t\t\tinfoWindow.open(Map, e?.target?.getPosition?.())\r\n\t\t\t}\r\n\t\t})\r\n\t\tMap?.setFitView()\r\n\t}\r\n\r\n\tfunction getAddress(lng: number, lat: number) {\r\n\t\tGeoCoder?.getAddress([lng, lat], (status: string, result: Record<string, any>) => {\r\n\t\t\tif (status === 'complete' && result.info === 'OK' && result.regeocode && result.regeocode.formattedAddress) {\r\n\t\t\t\tinfoWindow = new AMap.InfoWindow({\r\n\t\t\t\t\t//创建信息窗体\r\n\t\t\t\t\tisCustom: true,\r\n\t\t\t\t\tcontent: '<div class=\"mapInfoWindowIKJ\">' + result.regeocode.formattedAddress + '</div>',\r\n\t\t\t\t\toffset: new AMap.Pixel(16, -45),\r\n\t\t\t\t\tcloseWhenClickMap: true\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tinfoWindow = null\r\n\t\t\t\tconsole.warn('地图获取位置信息失败', result)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tonMounted(checkHeight)\r\n\r\n\tonUnmounted(() => {\r\n\t\tif (!Map) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tMap.destroy()\r\n\t\t//@ts-ignore\r\n\t\tAMapLoader?.reset()\r\n\t\tMap = null\r\n\t\tGeoCoder = null\r\n\t\tAutoComplete = null\r\n\t\tinfoWindow = null\r\n\t})\r\n</script>\r\n\r\n<template>\r\n\t<div :style=\"containerStyle\" class=\"containerIKJ\">\r\n\t\t<Input\r\n\t\t\tref=\"mapInputRef\"\r\n\t\t\tv-model=\"valueT.name\"\r\n\t\t\t:class=\"{ mapInputIKJ: props.showMap }\"\r\n\t\t\t:placeholder=\"props.placeholder || t('r.search')\"\r\n\t\t\t:disabled=\"props.disabled\"\r\n\t\t\ticon=\"ios-search\"\r\n\t\t/>\r\n\t\t<div :style=\"mapStyle\" ref=\"mapRef\" :id=\"mapId\"></div>\r\n\t</div>\r\n</template>\r\n","<!--AsyncCascader 远程拉取数据的级联下拉选择框，依据url属性从后端拉取数据，失焦时选择，v-model绑定选中的ID\r\n@created 2023.08.17\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script lang=\"ts\" setup>\r\n\timport { myTypeof } from '../../utils/globalFunc'\r\n\timport { findPath } from '../../utils/needImportFunc'\r\n\timport $fetch from '../../utils/fetch'\r\n\timport t from '../../locale/i18nSFC'\r\n\timport { isEmpty, last, isEqual, isString, isNumber, cloneDeep } from 'lodash-es'\r\n\r\n\tconst emit = defineEmits(['update:modelValue', 'on-label-change'])\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\tmodelValue?: any[] | number | string /*级联绑定值(v-model)*/\r\n\t\t\turl?: string /*级联数据接口地址*/\r\n\t\t\toptionVal?: string /*v-model收集节点的哪些字段*/\r\n\t\t\toptionLabel?: string /*选项的标签对应接口字段*/\r\n\t\t\toptionFilter?: <T>(\r\n\t\t\t\td: T[]\r\n\t\t\t) => T[] /*筛选待选项的方法，入参是接口请求回来的待选项数据，返回处理后的待选项（仅进行筛选操作，不要做其它处理）*/\r\n\t\t\tseparator?: string /*选中的label分隔符（多级展示时）,valProp为String（多级）时分隔符*/\r\n\t\t\tonlyLastVal?: boolean /*只取最后一级*/\r\n\t\t\tonlyLastLabel?: boolean /*只显示最后一级*/\r\n\t\t\tfilterable?: boolean\r\n\t\t\tplaceholder?: string\r\n\t\t\tdisabled?: boolean\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\turl: window?.g?.mgrURL ? window.g.mgrURL + '/web/v1/umc/orgs' : '',\r\n\t\t\toptionVal: 'id',\r\n\t\t\toptionLabel: 'name',\r\n\t\t\tseparator: '/',\r\n\t\t\tonlyLastVal: true,\r\n\t\t\tonlyLastLabel: true,\r\n\t\t\tfilterable: false,\r\n\t\t\tplaceholder: '',\r\n\t\t\tdisabled: false\r\n\t\t}\r\n\t)\r\n\tconst dataC = ref<any[]>([])\r\n\r\n\tconst value = computed<any[]>({\r\n\t\tget() {\r\n\t\t\tlet valProp = props.modelValue\r\n\t\t\tif (Array.isArray(valProp)) {\r\n\t\t\t\treturn cloneDeep(valProp)\r\n\t\t\t} else if (isNumber(valProp)) {\r\n\t\t\t\treturn findPath({\r\n\t\t\t\t\tgroup: dataC.value,\r\n\t\t\t\t\tcondition: (item) => item?.value === valProp,\r\n\t\t\t\t\tpathKey: 'value'\r\n\t\t\t\t})\r\n\t\t\t} else if (isString(valProp)) {\r\n\t\t\t\treturn valProp.split(props.separator)\r\n\t\t\t}\r\n\t\t\treturn []\r\n\t\t},\r\n\t\tset(v: any[]) {\r\n\t\t\tif (props.onlyLastVal) {\r\n\t\t\t\tif (isEmpty(v)) {\r\n\t\t\t\t\temit('update:modelValue', null)\r\n\t\t\t\t\temit('on-label-change', null)\r\n\t\t\t\t} else {\r\n\t\t\t\t\temit('update:modelValue', last(v))\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (isEqual(props.modelValue, v)) {\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\temit('update:modelValue', cloneDeep(v))\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\r\n\tfunction getData() {\r\n\t\tif (!props.url) {\r\n\t\t\tconsole.error('没有用于拉取级联数据的有效接口地址')\r\n\t\t\treturn\r\n\t\t}\r\n\t\t$fetch\r\n\t\t\t.get(props.url)\r\n\t\t\t.then((r: any) => {\r\n\t\t\t\tlet d: any[] | null = null\r\n\t\t\t\tif (r?.data?.records) {\r\n\t\t\t\t\td = r.data.records\r\n\t\t\t\t} else if (r?.data) {\r\n\t\t\t\t\td = r.data\r\n\t\t\t\t} else if (r) {\r\n\t\t\t\t\td = r\r\n\t\t\t\t}\r\n\t\t\t\tif (d) {\r\n\t\t\t\t\tif (typeof props.optionFilter === 'function' && myTypeof(props.optionFilter) === 'Function') {\r\n\t\t\t\t\t\td = props.optionFilter(d)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdataC.value = dataFilter(d)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.warn('级联数据错误，不能使用')\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch(() => {\r\n\t\t\t\tconsole.warn('拉取级联数据出错')\r\n\t\t\t})\r\n\t}\r\n\r\n\tfunction dataFilter(d: any[]): any[] {\r\n\t\tlet temp: any[] = []\r\n\t\tfor (let item of d) {\r\n\t\t\tlet tt: Record<string, any> = {\r\n\t\t\t\tvalue: item[props.optionVal],\r\n\t\t\t\tlabel: item[props.optionLabel]\r\n\t\t\t}\r\n\t\t\tif (item?.children && !isEmpty(item.children)) {\r\n\t\t\t\ttt.children = dataFilter(item.children)\r\n\t\t\t}\r\n\t\t\ttemp.push(tt)\r\n\t\t}\r\n\t\treturn temp\r\n\t}\r\n\r\n\tfunction format(labels: any[]) {\r\n\t\tif (props.onlyLastLabel) {\r\n\t\t\treturn last(labels)\r\n\t\t}\r\n\t\treturn labels.join(props.separator)\r\n\t}\r\n\r\n\tfunction onChange(v: any, selectedDetail: any[]) {\r\n\t\tlet label: string = ''\r\n\t\tif (!isEmpty(selectedDetail)) {\r\n\t\t\tlabel = selectedDetail\r\n\t\t\t\t.map((item) => {\r\n\t\t\t\t\treturn item?.label\r\n\t\t\t\t})\r\n\t\t\t\t.join(props.separator)\r\n\t\t}\r\n\t\temit('on-label-change', label)\r\n\t}\r\n\r\n\tonMounted(getData)\r\n</script>\r\n\r\n<template>\r\n\t<Cascader\r\n\t\t:data=\"dataC\"\r\n\t\tv-model=\"value\"\r\n\t\t@on-change=\"onChange\"\r\n\t\tchange-on-select\r\n\t\ttransfer\r\n\t\t:disabled=\"props.disabled\"\r\n\t\t:render-format=\"format\"\r\n\t\t:placeholder=\"props.placeholder || t('r.pSelect')\"\r\n\t\t:filterable=\"props.filterable\"\r\n\t/>\r\n</template>\r\n","<!--AlCascaderMC 行政区域级联，v-model绑定区域代码，内置数据，可设置地址级别\r\n@created 2023.08.21\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script lang=\"ts\" setup>\r\n\timport { cloneDeep, isEmpty, last } from 'lodash-es'\r\n\timport t from '../../locale/i18nSFC'\r\n\timport ArCascader from 'ar-cascader'\r\n\r\n\tconst emit = defineEmits(['update:modelValue', 'on-name-change'])\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\tmodelValue?: string | number | any[] | null /*组件绑定的值（v-model）*/\r\n\t\t\tlevel?: 0 | 1 | 2 | '0' | '1' | '2' /*精确至几级行政区域（0：省级，1：市级，2：县级）*/\r\n\t\t\tdisabled?: boolean /*禁用组件*/\r\n\t\t\ttransfer?: boolean /*弹出框元素直接放置于body下*/\r\n\t\t\tfilterable?: boolean /*可搜索*/\r\n\t\t\tseparator?: string /*地址名称分隔符*/\r\n\t\t\tplaceholder?: string /*占位符*/\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\tlevel: 2,\r\n\t\t\tdisabled: false,\r\n\t\t\ttransfer: true,\r\n\t\t\tfilterable: true,\r\n\t\t\tseparator: '/'\r\n\t\t}\r\n\t)\r\n\tconst valueT = computed({\r\n\t\tget() {\r\n\t\t\tif (props.modelValue && (typeof props.modelValue === 'string' || typeof props.modelValue === 'number')) {\r\n\t\t\t\tlet temp = String(props.modelValue).trim()\r\n\r\n\t\t\t\tlet regP = /^\\d+$/\r\n\t\t\t\tif (regP.test(temp)) {\r\n\t\t\t\t\tlet lv1 = temp.substring(0, 2) + '0000000000'\r\n\t\t\t\t\tlet lv2 = temp.substring(0, 4) + '00000000'\r\n\t\t\t\t\treturn [lv1, lv2, temp]\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (temp.indexOf(props.separator) !== -1) {\r\n\t\t\t\t\t/*以中文名称和分隔符拼接的String地址*/\r\n\t\t\t\t\treturn temp.split(props.separator)\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn [temp]\r\n\t\t\t} else if (Array.isArray(props.modelValue)) {\r\n\t\t\t\treturn cloneDeep(props.modelValue)\r\n\t\t\t} else {\r\n\t\t\t\treturn []\r\n\t\t\t}\r\n\t\t},\r\n\t\tset(val) {\r\n\t\t\tif (isEmpty(val)) {\r\n\t\t\t\temit('update:modelValue', null)\r\n\t\t\t\temit('on-name-change', null)\r\n\t\t\t} else {\r\n\t\t\t\tlet l: Record<string, any> = last(val)\r\n\t\t\t\tlet code = ''\r\n\t\t\t\tlet name = ''\r\n\t\t\t\tif (l) {\r\n\t\t\t\t\tcode = l.code\r\n\t\t\t\t}\r\n\t\t\t\tif (code && code.length < 12) {\r\n\t\t\t\t\tlet t: any[] = [...code]\r\n\t\t\t\t\twhile (t.length < 12) {\r\n\t\t\t\t\t\tt.push(0)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcode = t.join('')\r\n\t\t\t\t}\r\n\t\t\t\tif (Array.isArray(val)) {\r\n\t\t\t\t\tname = val\r\n\t\t\t\t\t\t.map((item) => {\r\n\t\t\t\t\t\t\treturn item?.name\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.join(props.separator)\r\n\t\t\t\t}\r\n\t\t\t\tif (code) {\r\n\t\t\t\t\tif (code === props.modelValue) {\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\temit('update:modelValue', code)\r\n\t\t\t\t}\r\n\t\t\t\tif (name) {\r\n\t\t\t\t\temit('on-name-change', name)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n</script>\r\n\r\n<template>\r\n\t<ar-cascader\r\n\t\tv-bind=\"$attrs\"\r\n\t\tclass=\"alCascaderMC\"\r\n\t\tv-model=\"valueT\"\r\n\t\t:level=\"props.level\"\r\n\t\t:disabled=\"props.disabled\"\r\n\t\t:placeholder=\"props.placeholder || t('r.pSelect')\"\r\n\t\t:transfer=\"props.transfer\"\r\n\t\t:searchable=\"props.filterable\"\r\n\t/>\r\n</template>\r\n","/**\r\n * @description 全屏预览，原生dom技术\r\n * @author ricky zhangqingcq@foxmail.com\r\n * @created 2023.08.23\r\n */\r\n\r\nimport { first } from 'lodash-es'\r\nimport { t } from '../locale'\r\n\r\nlet _index = 0\r\n\r\nfunction domHandle(src: any, _i: number, imgEl: any, nameEl: any) {\r\n\tif (nameEl) {\r\n\t\tnameEl.innerHTML = src[_i]?.name ?? ''\r\n\t\tif (src[_i]?.name) {\r\n\t\t\tif (nameEl.classList.contains('hide')) {\r\n\t\t\t\tnameEl.classList.remove('hide')\r\n\t\t\t}\r\n\t\t} else if (!nameEl.classList.contains('hide')) {\r\n\t\t\tnameEl.classList.add('hide')\r\n\t\t}\r\n\t}\r\n\tif (imgEl) {\r\n\t\timgEl.src = src[_i]?.src ?? src[_i]\r\n\t\t_index = _i\r\n\t}\r\n}\r\n\r\nfunction lastImg(arrSrc: boolean, src: any, imgEl: any, nameEl: any) {\r\n\tif (arrSrc) {\r\n\t\tlet _i\r\n\t\tif (_index - 1 < 0) {\r\n\t\t\t_i = src.length - 1\r\n\t\t} else {\r\n\t\t\t_i = _index - 1\r\n\t\t}\r\n\t\tdomHandle(src, _i, imgEl, nameEl)\r\n\t}\r\n}\r\n\r\nfunction nextImg(arrSrc: boolean, src: any, imgEl: any, nameEl: any) {\r\n\tif (arrSrc) {\r\n\t\tlet _i\r\n\t\tif (_index + 1 > src.length - 1) {\r\n\t\t\t_i = 0\r\n\t\t} else {\r\n\t\t\t_i = _index + 1\r\n\t\t}\r\n\t\tdomHandle(src, _i, imgEl, nameEl)\r\n\t}\r\n}\r\n\r\n/**\r\n * 全屏图片预览，支持单张图片预览，或多张图片轮播\r\n * @param {string|Array<string>|Array<Record<string,any>>} src 图片地址，或者地址组成的数组，或包含地址src和名字name的对象组成的数组\r\n * @param {number} index src为数组时默认展示图的索引值，默认：0\r\n */\r\nexport default function fullScreenImgByDom(this: any, src: any, index: number = 0) {\r\n\tconst T = (...arg: Parameters<typeof t>) => t.apply(this, arg)\r\n\r\n\tconst close = T('r.closePreview')\r\n\tconst fullImg = T('r.fullImg')\r\n\tconst last = T('r.last')\r\n\tconst next = T('r.next')\r\n\tlet notice\r\n\r\n\tlet _src\r\n\tlet _name\r\n\t_index = index\r\n\tconst arrSrc = Array.isArray(src)\r\n\tif (arrSrc) {\r\n\t\t_src = src[_index]?.src ?? src[_index]\r\n\t\t_name = src[_index]?.name\r\n\t} else {\r\n\t\t_src = src\r\n\t}\r\n\r\n\tif (arrSrc && src.length > 1) {\r\n\t\tnotice = `${last} ： ←, ↑, A, W | ${next} ： →, ↓, D, S | ${close} ： Esc`\r\n\t} else {\r\n\t\tnotice = `${close} ： Esc`\r\n\t}\r\n\r\n\tlet bodyEl = first(document.getElementsByTagName('body'))\r\n\tlet child = document.createElement('div')\r\n\tchild.setAttribute('class', 'fullScreenImgByDom')\r\n\tchild.innerHTML = `<div class='previewInner'><div class='pageFBt left${\r\n\t\tarrSrc && src.length > 1 ? '' : ' hide'\r\n\t}'><i class='ivu-icon ivu-icon-ios-arrow-back' title='${last}' ></i></div><img src='${_src}' alt='${fullImg}' ><div class='pageFBt right${\r\n\t\tarrSrc && src.length > 1 ? '' : ' hide'\r\n\t}'><i class='ivu-icon ivu-icon-ios-arrow-forward' title='${next}' ></i></div><i class='ivu-icon ivu-icon-md-close' title='${close}' ></i></div><p class='pNotice cannotSelect'>${notice}</p><p class='pName ${\r\n\t\t_name ? '' : 'hide'\r\n\t}'>${_name}</p>`\r\n\r\n\tfunction closeHandler() {\r\n\t\tlet bb = first(document.getElementsByTagName('body'))\r\n\t\tif (bb) {\r\n\t\t\tbb.removeChild(child)\r\n\t\t}\r\n\t\tdocument.removeEventListener('keyup', keyupHandler)\r\n\t}\r\n\r\n\tchild.querySelector('.ivu-icon-md-close')?.addEventListener?.('click', closeHandler)\r\n\tconst imgEl = child.querySelector('img')\r\n\tconst nameEl = child.querySelector('.pName')\r\n\tchild.querySelector('.pageFBt.left')?.addEventListener('click', function () {\r\n\t\tlastImg(arrSrc, src, imgEl, nameEl)\r\n\t})\r\n\tchild.querySelector('.pageFBt.right')?.addEventListener('click', function () {\r\n\t\tnextImg(arrSrc, src, imgEl, nameEl)\r\n\t})\r\n\r\n\tfunction keyupHandler(e: any) {\r\n\t\tif (e.keyCode === 37 || e.keyCode === 38 || e.keyCode === 87 || e.keyCode === 65) {\r\n\t\t\t//上、左、w、a\r\n\t\t\tlastImg(arrSrc, src, imgEl, nameEl)\r\n\t\t} else if (e.keyCode === 39 || e.keyCode === 40 || e.keyCode === 83 || e.keyCode === 68) {\r\n\t\t\t//下、右、s、d\r\n\t\t\tnextImg(arrSrc, src, imgEl, nameEl)\r\n\t\t} else if (e.keyCode === 27) {\r\n\t\t\t//Esc\r\n\t\t\tcloseHandler()\r\n\t\t}\r\n\t}\r\n\r\n\tdocument.addEventListener('keyup', keyupHandler)\r\n\tbodyEl?.appendChild?.(child)\r\n\tchild.focus({ preventScroll: true })\r\n}\r\n","<!--UploadGroup 支持本地上传或直接上传到服务器、上传文件列表展示或缩略图展示或不展示等功能的上传组件\r\n@created 2023.08.23\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script lang=\"ts\" setup>\r\n\timport t from '../../locale/i18nSFC'\r\n\timport { first, cloneDeep, indexOf, last, find, findIndex } from 'lodash-es'\r\n\timport { myTypeof } from '../../utils/globalFunc'\r\n\timport {\r\n\t\tgetFileSrc,\r\n\t\tgetFileTypeByName,\r\n\t\tisImgByFile,\r\n\t\tgetFileTypeIconByName,\r\n\t\tdownloadFileReaderFile\r\n\t} from '../../utils/needImportFunc'\r\n\timport $fetch from '../../utils/fetch.js'\r\n\timport fullScreenImgByDom from '../../utils/fullScreenImgByDom'\r\n\timport $swal from '../../utils/swal'\r\n\r\n\tconst emit = defineEmits(['update:modelValue', 'on-change'])\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\tmodelValue?: number | string | File | any[]\r\n\t\t\turl?: string /*文件上传的地址*/\r\n\t\t\tdata?: Record<string, any> /*文件上传接口其他参数*/\r\n\t\t\tmanualUpload?: boolean\r\n\t\t\tmaxSize?: number\r\n\t\t\tlength?: number\r\n\t\t\tshowUploadList?: boolean\r\n\t\t\twithCredentials?: boolean\r\n\t\t\tmultiple?: boolean\r\n\t\t\tformat?: string[]\r\n\t\t\tshowImg?: boolean\r\n\t\t\tdisabled?: boolean /*禁用，仅展示*/\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\tmodelValue: () => [],\r\n\t\t\turl: window?.g?.mgrURL ? window.g.mgrURL + '/web/v1/fsc/file' : '',\r\n\t\t\tdata: () => ({\r\n\t\t\t\tappId: 0,\r\n\t\t\t\tmoduleId: 0,\r\n\t\t\t\ttypeId: 0\r\n\t\t\t}),\r\n\t\t\tmanualUpload: false,\r\n\t\t\tmaxSize: 0,\r\n\t\t\tlength: 0,\r\n\t\t\tshowUploadList: true,\r\n\t\t\twithCredentials: true,\r\n\t\t\tmultiple: false,\r\n\t\t\tformat: () => [],\r\n\t\t\tshowImg: false,\r\n\t\t\tdisabled: false\r\n\t\t}\r\n\t)\r\n\tconst fileSrcList = shallowRef<any[]>([]) //本地图片模式图片文件地址集合\r\n\tconst fileDefaultList = shallowRef<any[]>([]) //从服务器返回的数据整理完成的文件集合\r\n\tconst localImgSrcList = shallowRef<any[]>([])\r\n\tlet tempStorage: Record<string, any> = {}\r\n\tconst previewType = computed(() => {\r\n\t\tif (!props.manualUpload && props.showImg && fileListItemIsIMG.value) {\r\n\t\t\t//上传到服务器，图片模式\r\n\t\t\treturn 'img'\r\n\t\t} else if (props.manualUpload && props.showImg && fileListItemIsIMG.value) {\r\n\t\t\t//上传到本地，图片模式\r\n\t\t\treturn 'localImg'\r\n\t\t} else if (props.manualUpload && props.showUploadList && (!props.showImg || !fileListItemIsIMG.value)) {\r\n\t\t\t//上传到本地\r\n\t\t\treturn 'localList'\r\n\t\t} else if (!props.manualUpload && props.showUploadList && (!props.showImg || !fileListItemIsIMG.value)) {\r\n\t\t\t//上传到服务器\r\n\t\t\treturn 'list'\r\n\t\t} else {\r\n\t\t\treturn ''\r\n\t\t}\r\n\t})\r\n\tconst urlT = computed(() => {\r\n\t\tif (props.manualUpload) {\r\n\t\t\treturn '//jsonplaceholder.typicode.com/posts/'\r\n\t\t} else {\r\n\t\t\treturn props.url\r\n\t\t}\r\n\t})\r\n\tconst fileList = computed({\r\n\t\t//文件集合\r\n\t\tget() {\r\n\t\t\tif (props.manualUpload) {\r\n\t\t\t\treturn fileIdList.value\r\n\t\t\t} else {\r\n\t\t\t\treturn fileIdList.value.map((e) => ({ id: e }))\r\n\t\t\t}\r\n\t\t},\r\n\t\tset(val) {\r\n\t\t\tif (props.manualUpload) {\r\n\t\t\t\tfileIdList.value = val || []\r\n\t\t\t} else {\r\n\t\t\t\tfileIdList.value = val?.map((e) => e?.id) || []\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\tconst fileIdList = computed({\r\n\t\t//文件ID集合\r\n\t\tget() {\r\n\t\t\tswitch (typeof props.modelValue) {\r\n\t\t\t\tcase 'number':\r\n\t\t\t\t\treturn [props.modelValue]\r\n\t\t\t\tcase 'string':\r\n\t\t\t\t\tif (props.modelValue.indexOf('--') !== -1) {\r\n\t\t\t\t\t\treturn []\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (/^\\d*$/.test(props.modelValue)) {\r\n\t\t\t\t\t\t\treturn [Number(props.modelValue)]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn [props.modelValue]\r\n\t\t\t\t\t}\r\n\t\t\t\tcase 'object':\r\n\t\t\t\t\tif (Array.isArray(props.modelValue)) {\r\n\t\t\t\t\t\treturn props.modelValue.filter((e) => e !== '--')\r\n\t\t\t\t\t} else if (myTypeof(props.modelValue) === 'File') {\r\n\t\t\t\t\t\treturn [props.modelValue]\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn []\r\n\t\t\t\t\t}\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn []\r\n\t\t\t}\r\n\t\t},\r\n\t\tset(val) {\r\n\t\t\tif (props.length === 1) {\r\n\t\t\t\tlet temp = first(val)\r\n\t\t\t\temit('update:modelValue', temp ?? null)\r\n\t\t\t\temit('on-change', temp ?? null)\r\n\t\t\t} else {\r\n\t\t\t\temit('update:modelValue', cloneDeep(val))\r\n\t\t\t\temit('on-change', cloneDeep(val))\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\tconst fileListItemIsIMG = computed(() => {\r\n\t\t//文件集合是否全为图片\r\n\t\tlet temp\r\n\t\tif (props.manualUpload) {\r\n\t\t\ttemp = fileList.value\r\n\t\t} else {\r\n\t\t\ttemp = fileDefaultList.value\r\n\t\t}\r\n\t\tif (!temp) {\r\n\t\t\treturn false\r\n\t\t}\r\n\t\tfor (let item of temp) {\r\n\t\t\tlet type\r\n\t\t\tif (props.manualUpload) {\r\n\t\t\t\ttype = item?.type\r\n\t\t\t} else {\r\n\t\t\t\ttype = item?.mimeType\r\n\t\t\t}\r\n\t\t\tif (!type || (type && !(isImgByFile(type) || type === 'loading'))) {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true\r\n\t})\r\n\r\n\tconst fileDefaultImgList = computed(() => {\r\n\t\t//图片文件集合\r\n\t\treturn fileDefaultList.value.filter((e) => isImgByFile(e?.mimeType))\r\n\t})\r\n\r\n\tconst fileImgSrcList = computed(() => {\r\n\t\t//图片地址、名字集合\r\n\t\treturn fileDefaultImgList.value.map((e: any) => ({\r\n\t\t\tsrc: props.url + '/' + e?.id + '/download?preview=true',\r\n\t\t\tname: e?.name\r\n\t\t}))\r\n\t})\r\n\r\n\tconst localImgList = computed(() => {\r\n\t\t// 本地图片集合\r\n\t\treturn fileList.value.filter((e: any) => isImgByFile(e?.type))\r\n\t})\r\n\r\n\twatch(localImgList, async (after) => {\r\n\t\tlocalImgSrcList.value = await getFileSrcList(after)\r\n\t})\r\n\r\n\twatch(\r\n\t\t() => fileList.value,\r\n\t\tasync (after) => {\r\n\t\t\tif (previewType.value === 'localImg') {\r\n\t\t\t\tif (after?.length) {\r\n\t\t\t\t\tfileSrcList.value = await getFileSrcList(after)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfileSrcList.value = []\r\n\t\t\t\t}\r\n\t\t\t} else if (after?.length && previewType.value !== 'localList') {\r\n\t\t\t\tlet temp: any = cloneDeep(after)\r\n\t\t\t\tconst _fileDefaultList = cloneDeep(fileDefaultList.value)\r\n\t\t\t\tfor (let item of temp) {\r\n\t\t\t\t\tif (item?.name === undefined) {\r\n\t\t\t\t\t\t//根据id获取文件名字\r\n\t\t\t\t\t\tif (item.id) {\r\n\t\t\t\t\t\t\tconst fileT = find(_fileDefaultList, (e) => e?.id === item.id)\r\n\t\t\t\t\t\t\tif (fileT) {\r\n\t\t\t\t\t\t\t\t//本地有名字，在本地拿\r\n\t\t\t\t\t\t\t\titem.name = fileT.name\r\n\t\t\t\t\t\t\t\titem.mimeType = fileT.mimeType\r\n\t\t\t\t\t\t\t} else if (tempStorage.hasOwnProperty(item.id)) {\r\n\t\t\t\t\t\t\t\t//缓存有信息，在缓存拿取\r\n\t\t\t\t\t\t\t\titem.name = tempStorage[item.id].name\r\n\t\t\t\t\t\t\t\titem.mimeType = tempStorage[item.id].mimeType\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t//本地没有，去服务器拿\r\n\t\t\t\t\t\t\t\titem.mimeType = 'loading'\r\n\t\t\t\t\t\t\t\t$fetch\r\n\t\t\t\t\t\t\t\t\t.get(props.url + '/' + item.id)\r\n\t\t\t\t\t\t\t\t\t.then((r: any) => {\r\n\t\t\t\t\t\t\t\t\t\titem.name = r?.data?.returnValue?.[0]?.name || t('r.file') + indexOf(after, item)\r\n\t\t\t\t\t\t\t\t\t\titem.mimeType = r?.data?.returnValue?.[0]?.mimeType || 'unknown'\r\n\t\t\t\t\t\t\t\t\t\ttriggerRef(fileDefaultList)\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t.catch(() => {\r\n\t\t\t\t\t\t\t\t\t\titem.name = t('r.file') + indexOf(temp, item)\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\titem.name = t('r.unknown')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfileDefaultList.value = temp\r\n\t\t\t} else {\r\n\t\t\t\tfileDefaultList.value = []\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\timmediate: true,\r\n\t\t\tdeep: true\r\n\t\t}\r\n\t)\r\n\r\n\tfunction clear() {\r\n\t\tfileList.value = []\r\n\t}\r\n\r\n\tfunction getName(item: any) {\r\n\t\treturn item?.name || (item?.split && last(item.split('/'))) || item\r\n\t}\r\n\r\n\tasync function getFileSrcList(data: any[]) {\r\n\t\tlet temp: any[] = []\r\n\t\tfor (let item of data) {\r\n\t\t\t//图片的 base64 格式, 可以直接当成 img 的 src 属性值\r\n\t\t\tlet src = await getFileSrc(item)\r\n\t\t\ttemp.push(src)\r\n\t\t}\r\n\t\treturn temp\r\n\t}\r\n\r\n\tfunction clearManualItem(index: number) {\r\n\t\tif (!props.disabled) {\r\n\t\t\t//触发computed的set\r\n\t\t\tlet _f = fileList.value\r\n\t\t\t_f?.splice(index, 1)\r\n\t\t\tfileList.value = _f\r\n\t\t}\r\n\t}\r\n\r\n\tfunction downloadDefaultFile(item: Record<string, any>) {\r\n\t\tif (item?.id) {\r\n\t\t\twindow.open(props.url + '/' + item.id + '/download')\r\n\t\t}\r\n\t}\r\n\r\n\tfunction showPreview(file: any) {\r\n\t\tif (props.manualUpload) {\r\n\t\t\treturn file?.type && isImgByFile(file.type)\r\n\t\t}\r\n\t\treturn file?.id && file.mimeType && isImgByFile(file.mimeType)\r\n\t}\r\n\r\n\tasync function listExpand(file: any) {\r\n\t\t//列表图片预览\r\n\t\tif (props.manualUpload) {\r\n\t\t\t//本地上传\r\n\t\t\tlet index\r\n\t\t\tlet tt\r\n\t\t\tif (typeof file === 'number') {\r\n\t\t\t\t//直接传的index预览，本地图片模式\r\n\t\t\t\tindex = file\r\n\t\t\t\ttt = fileSrcList.value\r\n\t\t\t} else if (file) {\r\n\t\t\t\t//传的file对象预览，本地列表\r\n\t\t\t\tindex = findIndex(localImgList.value, (e: any) => e.size === file.size && e.lastModified === file.lastModified)\r\n\t\t\t\ttt = localImgSrcList.value\r\n\t\t\t}\r\n\t\t\tif (!tt) {\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tfullScreenImgByDom(\r\n\t\t\t\ttt.map((e: any, i: number) => ({\r\n\t\t\t\t\tsrc: e,\r\n\t\t\t\t\tname: localImgList.value[i]?.name\r\n\t\t\t\t})),\r\n\t\t\t\tindex\r\n\t\t\t)\r\n\t\t} else if (file?.id) {\r\n\t\t\t//上传到服务器，远程列表模式\r\n\t\t\tconst index = findIndex(fileDefaultImgList.value, (e) => e.id === file.id)\r\n\t\t\tfullScreenImgByDom(fileImgSrcList.value, index)\r\n\t\t}\r\n\t}\r\n\r\n\tfunction downloadManualFile(file: any) {\r\n\t\tif (myTypeof(file) === 'String' && file.indexOf('http') > -1) {\r\n\t\t\twindow.open(file)\r\n\t\t} else if (myTypeof(file) === 'File') {\r\n\t\t\tgetFileSrc(file).then((r: any) => {\r\n\t\t\t\tdownloadFileReaderFile(file.name, r)\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tfunction handelManualUpload(file: any) {\r\n\t\tif (props.manualUpload) {\r\n\t\t\tif (file) {\r\n\t\t\t\tlet type = getFileTypeByName(file.name)\r\n\t\t\t\tif (props.format?.length && props.format.indexOf(type) < 0) {\r\n\t\t\t\t\t$swal(\r\n\t\t\t\t\t\tt('r.wrongFileType'),\r\n\t\t\t\t\t\tt('r.supportType') + ((props.format?.length && String(props.format)) || t('r.none')),\r\n\t\t\t\t\t\t'warning'\r\n\t\t\t\t\t)\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\tif (props.maxSize && file.size > props.maxSize * 1024) {\r\n\t\t\t\t\t$swal(t('r.fileIsBig'), t('r.supportSize') + props.maxSize + 'kb', 'warning')\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\t//触发computed的set\r\n\t\t\t\tlet _f = fileList.value\r\n\t\t\t\t_f?.push(file)\r\n\t\t\t\tfileList.value = _f\r\n\t\t\t}\r\n\t\t\treturn false\r\n\t\t} else {\r\n\t\t\treturn true\r\n\t\t}\r\n\t}\r\n\r\n\tfunction uploadError(error: any) {\r\n\t\tconsole.warn(error)\r\n\t\t$swal(t('r.uploadError'), '', 'error')\r\n\t}\r\n\r\n\tfunction uploadSuccess(response: any, file: any, _fileList: any) {\r\n\t\tif (response?.code === 0) {\r\n\t\t\t//触发computed的set\r\n\t\t\tlet _f = fileList.value\r\n\t\t\tfile.id = response.data?.[0]?.id\r\n\t\t\tfile.name = response.data?.[0]?.name\r\n\t\t\tfile.mimeType = response.data?.[0]?.mimeType //将文件信息存起来，不用再去服务器拉取了\r\n\t\t\ttempStorage[file.id] = { name: file.name, mimeType: file.mimeType }\r\n\t\t\t_f?.push(file)\r\n\t\t\tfileList.value = _f\r\n\t\t} else {\r\n\t\t\t$swal(t('r.uploadFail'), response?.message || '', 'error')\r\n\t\t}\r\n\t}\r\n\r\n\tfunction overSize() {\r\n\t\t$swal(t('r.fileIsBig'), t('r.supportSize') + props.maxSize + ' kb', 'warning')\r\n\t}\r\n\r\n\tfunction onFormatError() {\r\n\t\t$swal(\r\n\t\t\tt('r.wrongFileType'),\r\n\t\t\tt('r.supportType') + ((props.format?.length && String(props.format)) || t('r.none')),\r\n\t\t\t'warning'\r\n\t\t)\r\n\t}\r\n\r\n\tfunction onPreview(file: any) {\r\n\t\tlet id = file?.id\r\n\t\tlet type = file?.mimeType\r\n\t\tif (id) {\r\n\t\t\tif (myTypeof(type) === 'String' && type.indexOf('image') > -1) {\r\n\t\t\t\tfullScreenImgByDom(props.url + '/' + id + '/download?preview=true')\r\n\t\t\t} else {\r\n\t\t\t\twindow.open(props.url + '/' + id + '/download?preview=true')\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction onRemove(file: any) {\r\n\t\tlet id = file?.response?.data?.[0]?.id\r\n\t\tdeleteById(null, id)\r\n\t}\r\n\r\n\tfunction deleteById(e: any, id: any) {\r\n\t\tif (!id && id !== 0) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (!props.disabled && fileIdList.value.indexOf(id) !== -1) {\r\n\t\t\tconst _fileIdList = cloneDeep(fileIdList.value)\r\n\t\t\t//触发computed的set\r\n\t\t\tlet _f = fileList.value\r\n\t\t\t_f?.splice(_fileIdList.indexOf(id), 1)\r\n\t\t\tfileList.value = _f\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<template>\r\n\t<div>\r\n\t\t<Upload\r\n\t\t\tname=\"files\"\r\n\t\t\t:action=\"urlT\"\r\n\t\t\t:before-upload=\"handelManualUpload\"\r\n\t\t\t:on-error=\"uploadError\"\r\n\t\t\t:on-success=\"uploadSuccess\"\r\n\t\t\t:on-exceeded-size=\"overSize\"\r\n\t\t\t:on-preview=\"onPreview\"\r\n\t\t\t:on-remove=\"onRemove\"\r\n\t\t\t:on-format-error=\"onFormatError\"\r\n\t\t\t:data=\"props.data\"\r\n\t\t\t:max-size=\"props.maxSize\"\r\n\t\t\t:show-upload-list=\"false\"\r\n\t\t\t:with-credentials=\"props.withCredentials\"\r\n\t\t\t:format=\"props.format\"\r\n\t\t\t:multiple=\"props.multiple || false\"\r\n\t\t\t:disabled=\"(props.length > 0 && fileList?.length >= props.length) || Boolean(props.disabled)\"\r\n\t\t>\r\n\t\t\t<Button\r\n\t\t\t\ticon=\"md-cloud-upload\"\r\n\t\t\t\t:class=\"{\r\n\t\t\t\t\tdisabledR: (props.length > 0 && fileList?.length >= props.length) || Boolean(props.disabled)\r\n\t\t\t\t}\"\r\n\t\t\t\t>{{ t('r.selectFile') }}\r\n\t\t\t</Button>\r\n\t\t</Upload>\r\n\t\t<div class=\"previewBoxM\" v-show=\"previewType === 'img' && fileDefaultList?.length > 0\">\r\n\t\t\t<template v-for=\"(item, index) of fileDefaultList\" :key=\"item?.id\">\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"previewImg\"\r\n\t\t\t\t\t:class=\"{ previewLoading: item.mimeType === 'loading' }\"\r\n\t\t\t\t\tv-if=\"!props.manualUpload && item?.id !== null\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<div class=\"imgLoading\" v-show=\"item.mimeType === 'loading'\">\r\n\t\t\t\t\t\t<div data-loader=\"circle-side\" class=\"loader-div\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<img\r\n\t\t\t\t\t\t:src=\"url + '/' + item.id + '/download?preview=true'\"\r\n\t\t\t\t\t\t:alt=\"item.name\"\r\n\t\t\t\t\t\tv-show=\"item.mimeType !== 'loading'\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<div class=\"deleteModal\" v-show=\"item.mimeType !== 'loading'\">\r\n\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\ttype=\"ios-expand\"\r\n\t\t\t\t\t\t\tsize=\"40\"\r\n\t\t\t\t\t\t\tclass=\"previewExpand\"\r\n\t\t\t\t\t\t\t:title=\"t('r.fView')\"\r\n\t\t\t\t\t\t\t@click=\"fullScreenImgByDom(fileImgSrcList, index)\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\ttype=\"ios-trash-outline\"\r\n\t\t\t\t\t\t\tsize=\"40\"\r\n\t\t\t\t\t\t\tclass=\"previewDelete\"\r\n\t\t\t\t\t\t\t@click=\"deleteById($event, item.id)\"\r\n\t\t\t\t\t\t\t:title=\"t('r.delete')\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</template>\r\n\t\t</div>\r\n\t\t<div class=\"previewBoxM\" v-show=\"previewType === 'localImg' && fileSrcList?.length > 0\">\r\n\t\t\t<template v-for=\"(item, index) of fileSrcList\" :key=\"'manualImg' + index\">\r\n\t\t\t\t<div class=\"previewImg\" v-if=\"props.manualUpload && item !== null\">\r\n\t\t\t\t\t<img :src=\"item\" :alt=\"'manualImg' + index\" />\r\n\t\t\t\t\t<div class=\"deleteModal\">\r\n\t\t\t\t\t\t<Icon type=\"ios-expand\" size=\"40\" class=\"previewExpand\" @click=\"listExpand(index)\" :title=\"t('r.fView')\" />\r\n\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\ttype=\"ios-trash-outline\"\r\n\t\t\t\t\t\t\tsize=\"40\"\r\n\t\t\t\t\t\t\tclass=\"previewDelete\"\r\n\t\t\t\t\t\t\t@click=\"clearManualItem(index)\"\r\n\t\t\t\t\t\t\t:title=\"t('r.delete')\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</template>\r\n\t\t</div>\r\n\t\t<div class=\"customFileListM\" v-show=\"previewType === 'localList' && fileList?.length > 0\">\r\n\t\t\t<template v-for=\"(item, index) of fileList\" :key=\"'manualItem' + index\">\r\n\t\t\t\t<p class=\"customFileListItem\" v-if=\"props.manualUpload && item !== null\">\r\n\t\t\t\t\t<Icon v-if=\"item.name\" class=\"fileTypeIco\" :type=\"getFileTypeIconByName(item.name)\" size=\"20\" />\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tclass=\"upNameT\"\r\n\t\t\t\t\t\t:class=\"{ previewName: showPreview(item) }\"\r\n\t\t\t\t\t\t@click=\"downloadManualFile(item)\"\r\n\t\t\t\t\t\t:title=\"t('r.download')\"\r\n\t\t\t\t\t\t>{{ getName(item) }}</span\r\n\t\t\t\t\t>\r\n\t\t\t\t\t<span class=\"btBoxJ\">\r\n\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\tv-if=\"showPreview(item)\"\r\n\t\t\t\t\t\t\ttype=\"md-qr-scanner\"\r\n\t\t\t\t\t\t\tsize=\"22\"\r\n\t\t\t\t\t\t\tclass=\"listBtH\"\r\n\t\t\t\t\t\t\t@click=\"listExpand(item)\"\r\n\t\t\t\t\t\t\t:title=\"t('r.fView')\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Icon type=\"md-close\" size=\"22\" class=\"listBtH\" @click=\"clearManualItem(index)\" :title=\"t('r.delete')\" />\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</p>\r\n\t\t\t</template>\r\n\t\t</div>\r\n\t\t<div class=\"customFileListM\" v-show=\"previewType === 'list' && fileDefaultList?.length > 0\">\r\n\t\t\t<template v-for=\"(item, index) of fileDefaultList\" :key=\"'defaultItem' + index\">\r\n\t\t\t\t<div class=\"customFileListItem\" v-if=\"!props.manualUpload && item\">\r\n\t\t\t\t\t<div class=\"listLoading\" v-show=\"item.mimeType === 'loading'\">\r\n\t\t\t\t\t\t<div data-loader=\"circle-side\" class=\"loader-div\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t:type=\"getFileTypeIconByName(item.name)\"\r\n\t\t\t\t\t\tclass=\"fileTypeIco\"\r\n\t\t\t\t\t\tv-show=\"item.mimeType !== 'loading'\"\r\n\t\t\t\t\t\tsize=\"20\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tclass=\"upNameT\"\r\n\t\t\t\t\t\t@click=\"downloadDefaultFile(item)\"\r\n\t\t\t\t\t\t:title=\"t('r.download')\"\r\n\t\t\t\t\t\tv-show=\"item.mimeType !== 'loading'\"\r\n\t\t\t\t\t\t>{{ item.name || t('r.file') + (index + 1) }}</span\r\n\t\t\t\t\t>\r\n\t\t\t\t\t<span class=\"btBoxJ\" v-show=\"item.mimeType !== 'loading'\">\r\n\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\tv-if=\"showPreview(item)\"\r\n\t\t\t\t\t\t\ttype=\"md-qr-scanner\"\r\n\t\t\t\t\t\t\tsize=\"22\"\r\n\t\t\t\t\t\t\tclass=\"listBtH\"\r\n\t\t\t\t\t\t\t@click=\"listExpand(item)\"\r\n\t\t\t\t\t\t\t:title=\"t('r.fView')\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Icon type=\"md-close\" size=\"22\" class=\"listBtH\" @click=\"clearManualItem(index)\" :title=\"t('r.delete')\" />\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\t\t\t</template>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n","<!--MonthRange 月份区间选择器\r\n@created 2023.08.28\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script lang=\"ts\" setup>\r\n\timport t from '../../locale/i18nSFC'\r\n\r\n\tconst emit = defineEmits(['update:modelValue', 'on-change'])\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\tmodelValue?: string[]\r\n\t\t\tplacement?:\r\n\t\t\t\t| 'top'\r\n\t\t\t\t| 'top-start'\r\n\t\t\t\t| 'top-end'\r\n\t\t\t\t| 'bottom'\r\n\t\t\t\t| 'bottom-start'\r\n\t\t\t\t| 'bottom-end'\r\n\t\t\t\t| 'left'\r\n\t\t\t\t| 'left-start'\r\n\t\t\t\t| 'left-end'\r\n\t\t\t\t| 'right'\r\n\t\t\t\t| 'right-start'\r\n\t\t\t\t| 'right-end'\r\n\t\t\tplaceholder?: string\r\n\t\t\toptions1?: Record<string, any>\r\n\t\t\toptions2?: Record<string, any>\r\n\t\t\tdisabled?: boolean\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\tmodelValue: () => ['', ''],\r\n\t\t\tplacement: 'bottom-start',\r\n\t\t\tdisabled: false\r\n\t\t}\r\n\t)\r\n\r\n\tconst openA = ref(false)\r\n\tconst openB = ref(false)\r\n\tconst mouseOver = ref(false)\r\n\r\n\tconst valueA = computed({\r\n\t\tget() {\r\n\t\t\treturn (props.modelValue && props.modelValue[0]) || null\r\n\t\t},\r\n\t\tset(v: any) {\r\n\t\t\temit('update:modelValue', [v, valueB.value])\r\n\t\t\temit('on-change', [v, valueB.value])\r\n\t\t}\r\n\t})\r\n\tconst valueB = computed({\r\n\t\tget() {\r\n\t\t\treturn (props.modelValue && props.modelValue[1]) || null\r\n\t\t},\r\n\t\tset(v: any) {\r\n\t\t\temit('update:modelValue', [valueA.value, v])\r\n\t\t\temit('on-change', [valueA.value, v])\r\n\t\t}\r\n\t})\r\n\tconst valueT = computed(\r\n\t\t() => (valueA.value || '') + (((valueA.value || valueB.value) && ' - ') || '') + (valueB.value || '')\r\n\t)\r\n\r\n\tconst mPickerRef = ref()\r\n\r\n\tonMounted(() => {\r\n\t\tmPickerRef.value.querySelector('.aRoot .ivu-input-suffix').addEventListener('mouseover', () => {\r\n\t\t\tmouseOver.value = true\r\n\t\t})\r\n\t\tmPickerRef.value.querySelector('.aRoot .ivu-input-suffix').addEventListener('mouseout', () => {\r\n\t\t\tmouseOver.value = false\r\n\t\t})\r\n\t\tmPickerRef.value.querySelector('.aRoot .ivu-input-suffix').addEventListener('click', (e: any) => {\r\n\t\t\tif (!props.disabled && (valueA.value || valueB.value)) {\r\n\t\t\t\te?.stopPropagation?.()\r\n\t\t\t\tclear()\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\r\n\tfunction focus() {\r\n\t\tif (!props.disabled) {\r\n\t\t\topenA.value = true\r\n\t\t}\r\n\t}\r\n\r\n\tfunction changeA(d: any) {\r\n\t\tvalueA.value = d\r\n\t\topenA.value = false\r\n\t\topenB.value = true\r\n\t}\r\n\r\n\tfunction changeB(d: any) {\r\n\t\tvalueB.value = d\r\n\t\topenB.value = false\r\n\t}\r\n\r\n\tfunction clear() {\r\n\t\temit('update:modelValue', [null, null])\r\n\t\temit('on-change', [null, null])\r\n\t}\r\n\r\n\tfunction close() {\r\n\t\topenA.value = false\r\n\t\topenB.value = false\r\n\t\tif (valueA.value && valueB.value === null) {\r\n\t\t\tvalueA.value = null\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<template>\r\n\t<div class=\"monthRangeBoxR\" ref=\"mPickerRef\">\r\n\t\t<DatePicker\r\n\t\t\t:open=\"openB\"\r\n\t\t\t:modelValue=\"valueB\"\r\n\t\t\ttransfer\r\n\t\t\ttype=\"month\"\r\n\t\t\t:placement=\"props.placement\"\r\n\t\t\t:options=\"props.options2\"\r\n\t\t\t@on-change=\"changeB\"\r\n\t\t\t@on-clickoutside=\"close\"\r\n\t\t>\r\n\t\t\t<div class=\"bRoot\"></div>\r\n\t\t</DatePicker>\r\n\t\t<DatePicker\r\n\t\t\t:open=\"openA\"\r\n\t\t\t:modelValue=\"valueA\"\r\n\t\t\ttransfer\r\n\t\t\ttype=\"month\"\r\n\t\t\t:placement=\"props.placement\"\r\n\t\t\t:options=\"props.options1\"\r\n\t\t\t@on-change=\"changeA\"\r\n\t\t\t@on-clickoutside=\"close\"\r\n\t\t>\r\n\t\t\t<!--suppress HtmlExtraClosingTag -->\r\n\t\t\t<div @click=\"focus\">\r\n\t\t\t\t<Input\r\n\t\t\t\t\tclass=\"aRoot\"\r\n\t\t\t\t\tv-model=\"valueT\"\r\n\t\t\t\t\treadonly\r\n\t\t\t\t\t:placeholder=\"props.placeholder || t('r.selectDate')\"\r\n\t\t\t\t\t:disabled=\"props.disabled\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<template #suffix>\r\n\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\t:type=\"mouseOver && (valueA || valueB) && !props.disabled ? 'ios-close-circle' : 'ios-calendar-outline'\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</Input>\r\n\t\t\t</div>\r\n\t\t</DatePicker>\r\n\t</div>\r\n</template>\r\n","<!--EditorPro 富文本编辑器\r\n@created 2023.08.28\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script lang=\"ts\" setup>\r\n\t//@ts-ignore\r\n\timport { Editor, Toolbar } from '@wangeditor/editor-for-vue'\r\n\timport t from '../../locale/i18nSFC'\r\n\timport $fetch from '../../utils/fetch'\r\n\timport $swal from '../../utils/swal'\r\n\r\n\tconst emit = defineEmits(['update:modelValue', 'on-change'])\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\tmodelValue?: string\r\n\t\t\ttoolbarConfig?: Record<string, any>\r\n\t\t\teditorConfig?: Record<string, any>\r\n\t\t\tmode?: 'default' | 'simple'\r\n\t\t\theight?: string | number\r\n\t\t\timgUploadUrl?: string\r\n\t\t\tvideoUploadUrl?: string\r\n\t\t\tplaceholder?: string\r\n\t\t\tdisabled?: boolean\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\tmodelValue: '<p></p>',\r\n\t\t\ttoolbarConfig: () => ({}),\r\n\t\t\teditorConfig: () => ({}),\r\n\t\t\tmode: 'default',\r\n\t\t\theight: 300,\r\n\t\t\tplaceholder: '',\r\n\t\t\tdisabled: false\r\n\t\t}\r\n\t)\r\n\r\n\tconst _editor = shallowRef()\r\n\tconst valueT = computed({\r\n\t\tget() {\r\n\t\t\treturn props.modelValue\r\n\t\t},\r\n\t\tset(v: any) {\r\n\t\t\temit('update:modelValue', v)\r\n\t\t\temit('on-change', v)\r\n\t\t}\r\n\t})\r\n\tconst toolbarConfigT = computed(() =>\r\n\t\tObject.assign(\r\n\t\t\t{\r\n\t\t\t\tplaceholder: props.placeholder || t('r.pInput'),\r\n\t\t\t\tinsertKeys: {\r\n\t\t\t\t\tindex: 31,\r\n\t\t\t\t\tkeys: ['previewX']\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tprops.toolbarConfig\r\n\t\t)\r\n\t)\r\n\tconst editorConfigT = computed(() =>\r\n\t\tObject.assign(\r\n\t\t\t{\r\n\t\t\t\treadOnly: props.disabled,\r\n\t\t\t\tMENU_CONF: {\r\n\t\t\t\t\tuploadImage: {\r\n\t\t\t\t\t\tasync customUpload(file: any, insertFn: any) {\r\n\t\t\t\t\t\t\t// file 是 input 中选中的文件列表\r\n\t\t\t\t\t\t\t// insertFn 是获取图片 url 后，插入到编辑器的方法\r\n\t\t\t\t\t\t\t// 自己实现上传，并得到图片 url alt href\r\n\t\t\t\t\t\t\tlet temp = new FormData()\r\n\t\t\t\t\t\t\ttemp.append('files', file)\r\n\t\t\t\t\t\t\tconst n = file.name\r\n\t\t\t\t\t\t\tconst u = props.imgUploadUrl ?? '/node-serve/file'\r\n\t\t\t\t\t\t\t$fetch\r\n\t\t\t\t\t\t\t\t.post(u, temp, null, [], {\r\n\t\t\t\t\t\t\t\t\tspin: true,\r\n\t\t\t\t\t\t\t\t\theaders: {\r\n\t\t\t\t\t\t\t\t\t\t'Content-Type': 'multipart/form-data'\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t.then((r: any) => {\r\n\t\t\t\t\t\t\t\t\tif (r && r.data) {\r\n\t\t\t\t\t\t\t\t\t\tif (Array.isArray(r.data)) {\r\n\t\t\t\t\t\t\t\t\t\t\tfor (let e of r.data) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst url = u + '/' + e?.id + '/download'\r\n\t\t\t\t\t\t\t\t\t\t\t\t// 上传图片，返回结果，将图片插入到编辑器中\r\n\t\t\t\t\t\t\t\t\t\t\t\tinsertFn(url, n, url)\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tconst url = u + '/' + r.data.id + '/download'\r\n\t\t\t\t\t\t\t\t\t\t\t// 上传图片，返回结果，将图片插入到编辑器中\r\n\t\t\t\t\t\t\t\t\t\t\tinsertFn(url, n, url)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t.catch(() => {\r\n\t\t\t\t\t\t\t\t\t$swal(t('r.uploadFail'), '', 'error')\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tuploadVideo: {\r\n\t\t\t\t\t\tasync customUpload(file: any, insertFn: any) {\r\n\t\t\t\t\t\t\t// file 即选中的文件\r\n\t\t\t\t\t\t\t// insertFn 是获取视频 url 后，插入到编辑器的方法\r\n\t\t\t\t\t\t\t// 自己实现上传，并得到视频 url poster(封面地址,可选)\r\n\t\t\t\t\t\t\tlet temp = new FormData()\r\n\t\t\t\t\t\t\ttemp.append('files', file)\r\n\t\t\t\t\t\t\tconst u = props.videoUploadUrl ?? '/node-serve/file'\r\n\t\t\t\t\t\t\t$fetch\r\n\t\t\t\t\t\t\t\t.post(u, temp, null, [], {\r\n\t\t\t\t\t\t\t\t\tspin: true,\r\n\t\t\t\t\t\t\t\t\theaders: {\r\n\t\t\t\t\t\t\t\t\t\t'Content-Type': 'multipart/form-data'\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t.then((r: any) => {\r\n\t\t\t\t\t\t\t\t\tif (r && r.data) {\r\n\t\t\t\t\t\t\t\t\t\tif (Array.isArray(r.data)) {\r\n\t\t\t\t\t\t\t\t\t\t\tfor (let e of r.data) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst url = u + '/' + e?.id + '/download'\r\n\t\t\t\t\t\t\t\t\t\t\t\t// 最后插入视频\r\n\t\t\t\t\t\t\t\t\t\t\t\tinsertFn(url)\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tconst url = u + '/' + r.data.id + '/download'\r\n\t\t\t\t\t\t\t\t\t\t\t// 最后插入视频\r\n\t\t\t\t\t\t\t\t\t\t\tinsertFn(url)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t.catch(() => {\r\n\t\t\t\t\t\t\t\t\t$swal(t('r.uploadFail'), '', 'error')\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tprops.editorConfig\r\n\t\t)\r\n\t)\r\n\tconst editorTextareaStyle = computed(() => ({\r\n\t\theight: typeof props.height === 'number' ? props.height + 'px' : props.height\r\n\t}))\r\n\r\n\tfunction onCreated(d: any) {\r\n\t\t_editor.value = d\r\n\t}\r\n\r\n\twatch(\r\n\t\t() => props.disabled,\r\n\t\t(a: any) => {\r\n\t\t\tif (a) {\r\n\t\t\t\t_editor.value.disable()\r\n\t\t\t} else {\r\n\t\t\t\t_editor.value.enable()\r\n\t\t\t}\r\n\t\t}\r\n\t)\r\n\r\n\tonBeforeUnmount(() => {\r\n\t\tif (!_editor.value) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\t_editor.value.destroy()\r\n\t})\r\n</script>\r\n\r\n<template>\r\n\t<div class=\"editor-pro-root\">\r\n\t\t<Toolbar\r\n\t\t\tclass=\"editor-pro-toolbar\"\r\n\t\t\t:editor=\"_editor\"\r\n\t\t\t:defaultConfig=\"toolbarConfigT\"\r\n\t\t\t:mode=\"mode\"\r\n\t\t\tv-show=\"!disabled\"\r\n\t\t/>\r\n\t\t<Editor\r\n\t\t\tclass=\"editor-pro-editor\"\r\n\t\t\tv-model=\"valueT\"\r\n\t\t\t:defaultConfig=\"editorConfigT\"\r\n\t\t\t:mode=\"mode\"\r\n\t\t\t@onCreated=\"onCreated\"\r\n\t\t\t:style=\"editorTextareaStyle\"\r\n\t\t/>\r\n\t</div>\r\n</template>\r\n","<!--ItemR 表单项组件\r\n@created 2023.08.21\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n<script lang=\"ts\" setup>\r\n\timport t from '../../locale/i18nSFC'\r\n\timport SelectInput from '../SelectInput/SelectInput.vue'\r\n\timport AlCascaderMC from '../AlCascaderMC/AlCascaderMC.vue'\r\n\timport AsyncCascader from '../AsyncCascader/AsyncCascader.vue'\r\n\timport UploadGroup from '../UploadGroup/UploadGroup.vue'\r\n\timport EditorPro from '../EditorPro/EditorPro.vue'\r\n\timport InputMap from '../InputMap/InputMap.vue'\r\n\timport MonthRange from '../MonthRange/MonthRange.vue'\r\n\r\n\tconst emit = defineEmits([\r\n\t\t'item-change',\r\n\t\t're-validate',\r\n\t\t'select-input-change',\r\n\t\t'al-name-change',\r\n\t\t'async-label-change'\r\n\t])\r\n\tconst props = defineProps<{\r\n\t\titem: any\r\n\t\titemStyle: Record<string, any>\r\n\t\tvalGroup: Record<string, any>\r\n\t\ttempKeys: Record<string, any>\r\n\t\tinline: boolean\r\n\t\tdisabled: boolean\r\n\t\tlabelWidth: number\r\n\t\titemWidth: number\r\n\t\tmgrUrl: string\r\n\t\tuploadUrl: string\r\n\t}>()\r\n\r\n\tconst selectContentWidth = computed(() => {\r\n\t\tif (props.inline) {\r\n\t\t\treturn props.itemWidth\r\n\t\t} else {\r\n\t\t\tconst t = props.itemStyle?.width\r\n\t\t\tif (t) {\r\n\t\t\t\tif (t.indexOf('%') > -1) {\r\n\t\t\t\t\tconst p = Number(t.replace('%', ''))\r\n\t\t\t\t\tif (window.isNaN(p)) {\r\n\t\t\t\t\t\treturn `calc(100% - ${props.labelWidth}px)`\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn `calc((100% - ${props.labelWidth}px)*${p / 100})`\r\n\t\t\t\t} else if (t.indexOf('px') > -1) {\r\n\t\t\t\t\treturn t\r\n\t\t\t\t}\r\n\t\t\t\treturn `calc(100% - ${props.labelWidth}px)`\r\n\t\t\t}\r\n\t\t\treturn `calc(100% - ${props.labelWidth}px)`\r\n\t\t}\r\n\t})\r\n\r\n\tfunction itemClass(root: any) {\r\n\t\treturn {\r\n\t\t\twithInfo: Boolean(root.info),\r\n\t\t\twithTitle: Boolean(root.title),\r\n\t\t\tinlineFormItemXN: props.inline,\r\n\t\t\tnoLabel: root.type === 'selectInput',\r\n\t\t\t[root.class]: root.class,\r\n\t\t\tslotInput: root.slotPosition\r\n\t\t}\r\n\t}\r\n\r\n\tfunction itemChange(e: any, root: any) {\r\n\t\temit('item-change', {\r\n\t\t\te,\r\n\t\t\troot\r\n\t\t})\r\n\t}\r\n\r\n\tfunction reValidateAndChangeHandle(e: any, root: any) {\r\n\t\temit('re-validate', {\r\n\t\t\te,\r\n\t\t\troot\r\n\t\t})\r\n\t}\r\n\r\n\tfunction onSelectInputChange(d: any) {\r\n\t\temit('select-input-change', d)\r\n\t}\r\n\r\n\tfunction alNameChange(name: any, root: any) {\r\n\t\temit('al-name-change', {\r\n\t\t\tname,\r\n\t\t\troot\r\n\t\t})\r\n\t}\r\n\r\n\tfunction asyncLabelChange(label: any, root: any) {\r\n\t\temit('async-label-change', {\r\n\t\t\tlabel,\r\n\t\t\troot\r\n\t\t})\r\n\t}\r\n</script>\r\n\r\n<template>\r\n\t<!--suppress HtmlExtraClosingTag -->\r\n\t<FormItem\r\n\t\tv-if=\"props.item\"\r\n\t\t:label=\"props.item.type !== 'radio' && props.item.type !== 'checkbox' ? props.item.label : ' '\"\r\n\t\t:prop=\"props.item.key || ''\"\r\n\t\tclass=\"relativeBox\"\r\n\t\t:class=\"itemClass(props.item)\"\r\n\t>\r\n\t\t<!--纯文本,也可以不传label和val,单纯用来布局占位-->\r\n\t\t<div\r\n\t\t\tv-if=\"props.item.type === 'txt'\"\r\n\t\t\t:style=\"props.itemStyle\"\r\n\t\t\tstyle=\"display: inline-block\"\r\n\t\t\t:class=\"{ likeInputX: props.item.likeInput, disabled: Boolean(props.item.disabled) || props.disabled }\"\r\n\t\t\t>{{ props.item.valKey ? props.valGroup[props.item.valKey] || '无' : props.item.val }}\r\n\t\t</div>\r\n\t\t<!--数字输入框-->\r\n\t\t<InputNumber\r\n\t\t\t:style=\"props.itemStyle\"\r\n\t\t\tv-else-if=\"props.item.type === 'inputNumber'\"\r\n\t\t\tv-model=\"props.tempKeys[props.item.tempKey]\"\r\n\t\t\t:max=\"props.item.max || props.item.max === 0 ? props.item.max : Infinity\"\r\n\t\t\t:min=\"props.item.min || props.item.min === 0 ? props.item.min : -Infinity\"\r\n\t\t\t:precision=\"props.item.precision\"\r\n\t\t\t:step=\"props.item.step || 1\"\r\n\t\t\t:placeholder=\"props.item.placeholder || t('r.pInput')\"\r\n\t\t\t:disabled=\"Boolean(props.item.disabled) || props.disabled\"\r\n\t\t\t:readonly=\"Boolean(props.item.readonly)\"\r\n\t\t\t:editable=\"props.item.editable !== false\"\r\n\t\t\t@on-blur=\"itemChange($event, props.item)\"\r\n\t\t\t:active-change=\"Boolean(props.item.activeChange)\"\r\n\t\t\t:clearable=\"props.item.clearable !== false\"\r\n\t\t/>\r\n\t\t<!--输入框-->\r\n\t\t<Input\r\n\t\t\t:style=\"itemStyle\"\r\n\t\t\tv-else-if=\"props.item.type === 'input'\"\r\n\t\t\tv-model=\"props.tempKeys[props.item.tempKey]\"\r\n\t\t\t:type=\"props.item.inputType ?? (props.item.password ? 'password' : 'text')\"\r\n\t\t\t:maxlength=\"props.item.maxLength || null\"\r\n\t\t\t:password=\"Boolean(props.item.password)\"\r\n\t\t\t:icon=\"props.item.icon\"\r\n\t\t\t:prefix=\"props.item.prefix\"\r\n\t\t\t:suffix=\"props.item.suffix\"\r\n\t\t\t:placeholder=\"props.item.placeholder || t('r.pInput')\"\r\n\t\t\t:disabled=\"Boolean(props.item.disabled) || props.disabled\"\r\n\t\t\t@on-blur=\"itemChange($event, props.item)\"\r\n\t\t\t:clearable=\"!props.item.password && props.item.inputType === 'text' && props.item.clearable !== false\"\r\n\t\t>\r\n\t\t\t<template v-if=\"props.item.slotPosition && props.item.slotName\" #[props.item.slotPosition]>\r\n\t\t\t\t<slot :name=\"props.item.slotName\" :valGroup=\"props.valGroup\" />\r\n\t\t\t</template>\r\n\t\t\t<template v-if=\"props.item.slotPosition !== 'prepend' && props.item.prepend\" #prepend>\r\n\t\t\t\t<span>{{ props.item.prepend }}</span>\r\n\t\t\t</template>\r\n\t\t\t<template v-if=\"props.item.slotPosition !== 'append' && props.item.append\" #append>\r\n\t\t\t\t<span>{{ props.item.append }}</span>\r\n\t\t\t</template>\r\n\t\t</Input>\r\n\t\t<!--下拉框-->\r\n\t\t<Select\r\n\t\t\tv-else-if=\"props.item.type === 'select'\"\r\n\t\t\tv-model=\"tempKeys[props.item.tempKey]\"\r\n\t\t\t:style=\"itemStyle\"\r\n\t\t\t:filterable=\"props.item.filterable === true || props.item.filterable === false ? props.item.filterable : false\"\r\n\t\t\t:disabled=\"Boolean(props.item.disabled) || props.disabled\"\r\n\t\t\t:multiple=\"Boolean(props.item.multiple)\"\r\n\t\t\t:placeholder=\"props.item.placeholder || t('r.pSelect')\"\r\n\t\t\t@on-change=\"itemChange($event, props.item)\"\r\n\t\t\ttransfer\r\n\t\t\t:clearable=\"props.item.clearable !== false\"\r\n\t\t>\r\n\t\t\t<Option\r\n\t\t\t\tv-for=\"(optionItem, i) in props.item.options\"\r\n\t\t\t\t:value=\"optionItem.val\"\r\n\t\t\t\t:label=\"optionItem.label || optionItem.val\"\r\n\t\t\t\t:key=\"'option-' + props.item.key + i\"\r\n\t\t\t\t:disabled=\"!!optionItem.disabled\"\r\n\t\t\t/>\r\n\t\t</Select>\r\n\t\t<!--选择输入框（可以选择输入的key，比如选择是想收集体重还是身高）-->\r\n\t\t<select-input\r\n\t\t\tv-else-if=\"props.item.type === 'selectInput'\"\r\n\t\t\tv-model=\"tempKeys[props.item.tempKey]\"\r\n\t\t\t:label-width=\"labelWidth\"\r\n\t\t\t:item-width=\"selectContentWidth\"\r\n\t\t\t:select-option=\"props.item.options || []\"\r\n\t\t\t:placeholder=\"props.item.placeholder || t('r.pInput')\"\r\n\t\t\t:clearable=\"props.item.clearable !== false\"\r\n\t\t\t:disabled=\"Boolean(props.item.disabled) || props.disabled\"\r\n\t\t\t@on-change=\"onSelectInputChange\"\r\n\t\t/>\r\n\t\t<!--行政区域级联-->\r\n\t\t<al-cascader-m-c\r\n\t\t\t:style=\"itemStyle\"\r\n\t\t\tclass=\"inlineBlock\"\r\n\t\t\tv-else-if=\"props.item.type === 'alCascader'\"\r\n\t\t\tv-model=\"props.valGroup[props.item.key]\"\r\n\t\t\t:level=\"props.item.level || props.item.level === 0 ? props.item.level : 2\"\r\n\t\t\t:disabled=\"Boolean(props.item.disabled) || props.disabled\"\r\n\t\t\t:filterable=\"props.item.filterable !== false\"\r\n\t\t\t:placeholder=\"props.item.placeholder || t('r.pSelect')\"\r\n\t\t\t:change-on-select=\"Boolean(props.item.changeOnSelect)\"\r\n\t\t\t@on-name-change=\"alNameChange($event, props.item)\"\r\n\t\t/>\r\n\t\t<!--远程数据级联-->\r\n\t\t<async-cascader\r\n\t\t\t:style=\"itemStyle\"\r\n\t\t\tv-else-if=\"props.item.type === 'asyncCascader'\"\r\n\t\t\tv-model=\"props.valGroup[props.item.key]\"\r\n\t\t\t:url=\"props.item.url || mgrUrl + '/web/v1/umc/orgs'\"\r\n\t\t\t:option-val=\"props.item.optionVal || 'id'\"\r\n\t\t\t:option-label=\"props.item.optionLabel || 'name'\"\r\n\t\t\t:option-filter=\"props.item.optionFilter || null\"\r\n\t\t\t:only-last-val=\"props.item.onlyLastVal !== false\"\r\n\t\t\t:only-last-label=\"props.item.onlyLastLabel !== false\"\r\n\t\t\t:separator=\"props.item.separator || '/'\"\r\n\t\t\t:placeholder=\"props.item.placeholder || t('r.pSelect')\"\r\n\t\t\t:filterable=\"Boolean(props.item.filterable)\"\r\n\t\t\t:disabled=\"Boolean(props.item.disabled) || props.disabled\"\r\n\t\t\t@on-label-change=\"asyncLabelChange($event, props.item)\"\r\n\t\t/>\r\n\t\t<!--单选（不可取消选择）-->\r\n\t\t<Radio\r\n\t\t\tv-else-if=\"props.item.type === 'radio'\"\r\n\t\t\tv-model=\"props.valGroup[props.item.key]\"\r\n\t\t\t:disabled=\"Boolean(props.item.disabled) || props.disabled\"\r\n\t\t\t@on-change=\"itemChange($event, props.item)\"\r\n\t\t\t>{{ props.item.label }}</Radio\r\n\t\t>\r\n\t\t<!--单选组-->\r\n\t\t<RadioGroup\r\n\t\t\t:style=\"itemStyle\"\r\n\t\t\tv-else-if=\"props.item.type === 'radioGroup'\"\r\n\t\t\t@on-change=\"reValidateAndChangeHandle($event, props.item)\"\r\n\t\t\t:type=\"props.item.buttonType ? 'button' : null\"\r\n\t\t\tv-model=\"tempKeys[props.item.tempKey]\"\r\n\t\t>\r\n\t\t\t<Radio\r\n\t\t\t\tv-for=\"radioItem of props.item.options\"\r\n\t\t\t\t:key=\"'radioItem' + radioItem.val\"\r\n\t\t\t\t:label=\"radioItem.val\"\r\n\t\t\t\t:border=\"Boolean(props.item.itemBorder)\"\r\n\t\t\t\t:disabled=\"Boolean(props.item.disabled) || props.disabled || radioItem.disabled\"\r\n\t\t\t>\r\n\t\t\t\t<Icon v-if=\"radioItem.icon && !props.item.buttonType\" :type=\"radioItem.icon\" />\r\n\t\t\t\t<span>{{ radioItem.label || radioItem.val }}</span>\r\n\t\t\t</Radio>\r\n\t\t</RadioGroup>\r\n\t\t<!--单选（可取消选择）-->\r\n\t\t<Checkbox\r\n\t\t\tv-else-if=\"props.item.type === 'checkbox'\"\r\n\t\t\tv-model=\"props.valGroup[props.item.key]\"\r\n\t\t\t:disabled=\"!!props.item.disabled\"\r\n\t\t\t@on-change=\"itemChange($event, props.item)\"\r\n\t\t\t>{{ props.item.label }}</Checkbox\r\n\t\t>\r\n\t\t<!--多选组-->\r\n\t\t<CheckboxGroup\r\n\t\t\t:style=\"itemStyle\"\r\n\t\t\tv-else-if=\"props.item.type === 'checkboxGroup'\"\r\n\t\t\tv-model=\"tempKeys[props.item.tempKey]\"\r\n\t\t\t@on-change=\"reValidateAndChangeHandle($event, props.item)\"\r\n\t\t>\r\n\t\t\t<Checkbox\r\n\t\t\t\tv-for=\"checkItem of props.item.options\"\r\n\t\t\t\t:key=\"'checkItem' + checkItem.val\"\r\n\t\t\t\t:label=\"checkItem.val\"\r\n\t\t\t\t:disabled=\"Boolean(props.item.disabled) || props.disabled || checkItem.disabled\"\r\n\t\t\t>\r\n\t\t\t\t<Icon v-if=\"checkItem.icon\" :type=\"checkItem.icon\" />\r\n\t\t\t\t<span>{{ checkItem.label || checkItem.val }}</span>\r\n\t\t\t</Checkbox>\r\n\t\t</CheckboxGroup>\r\n\t\t<!--文本框-->\r\n\t\t<!--suppress HtmlWrongAttributeValue -->\r\n\t\t<Input\r\n\t\t\tv-else-if=\"props.item.type === 'textarea'\"\r\n\t\t\ttype=\"textarea\"\r\n\t\t\tv-model=\"tempKeys[props.item.tempKey]\"\r\n\t\t\t:autosize=\"props.item.autosize || { minRows: 2 }\"\r\n\t\t\t:style=\"itemStyle\"\r\n\t\t\t:maxlength=\"props.item.maxLength || null\"\r\n\t\t\t:show-word-limit=\"Boolean(props.item.showWordLimit)\"\r\n\t\t\t:placeholder=\"props.item.placeholder || t('r.pInput')\"\r\n\t\t\t:disabled=\"Boolean(props.item.disabled) || props.disabled\"\r\n\t\t\t@on-blur=\"itemChange($event, props.item)\"\r\n\t\t\t:clearable=\"props.item.clearable !== false\"\r\n\t\t/>\r\n\t\t<!--上传组件-->\r\n\t\t<upload-group\r\n\t\t\t:style=\"itemStyle\"\r\n\t\t\tclass=\"inlineBlock\"\r\n\t\t\tv-else-if=\"props.item.type === 'upload'\"\r\n\t\t\tv-model=\"props.valGroup[props.item.key]\"\r\n\t\t\t:url=\"props.item.url || uploadUrl\"\r\n\t\t\t:manual-upload=\"Boolean(props.item.manualUpload)\"\r\n\t\t\t:format=\"props.item.format || []\"\r\n\t\t\t:data=\"props.item.data\"\r\n\t\t\t:max-size=\"props.item.maxSize || 0\"\r\n\t\t\t:show-img=\"Boolean(props.item.showImg)\"\r\n\t\t\t:length=\"props.item.length || 0\"\r\n\t\t\t:disabled=\"Boolean(props.item.disabled) || props.disabled\"\r\n\t\t\t:with-credentials=\"props.item.withCredentials !== false\"\r\n\t\t\t@on-file-id-change=\"reValidateAndChangeHandle($event, props.item)\"\r\n\t\t/>\r\n\t\t<!--日期选择器-->\r\n\t\t<DatePicker\r\n\t\t\t:style=\"itemStyle\"\r\n\t\t\tv-else-if=\"props.item.type === 'date'\"\r\n\t\t\tv-model=\"tempKeys[props.item.tempKey]\"\r\n\t\t\t:type=\"props.item.dateType\"\r\n\t\t\t:disabled=\"Boolean(props.item.disabled) || props.disabled\"\r\n\t\t\tplacement=\"bottom-end\"\r\n\t\t\t:placeholder=\"props.item.placeholder || t('r.selectDate')\"\r\n\t\t\t:options=\"props.item.dateOptions || null\"\r\n\t\t\t:clearable=\"props.item.clearable !== false\"\r\n\t\t\t:editable=\"false\"\r\n\t\t\ttransfer\r\n\t\t\t@on-change=\"itemChange($event, props.item)\"\r\n\t\t/>\r\n\t\t<!--时间选择器-->\r\n\t\t<TimePicker\r\n\t\t\t:style=\"itemStyle\"\r\n\t\t\tv-else-if=\"props.item.type === 'time'\"\r\n\t\t\tv-model=\"tempKeys[props.item.tempKey]\"\r\n\t\t\t:type=\"props.item.dateType\"\r\n\t\t\t:disabled=\"Boolean(props.item.disabled) || props.disabled\"\r\n\t\t\tplacement=\"bottom-end\"\r\n\t\t\t:placeholder=\"props.item.placeholder || t('r.selectTime')\"\r\n\t\t\t:steps=\"props.item.steps || []\"\r\n\t\t\t:clearable=\"props.item.clearable !== false\"\r\n\t\t\t:editable=\"false\"\r\n\t\t\t:format=\"props.item.format || 'HH:mm:ss'\"\r\n\t\t\ttransfer\r\n\t\t\t@on-change=\"itemChange($event, props.item)\"\r\n\t\t/>\r\n\t\t<!--月份区间选择-->\r\n\t\t<month-range\r\n\t\t\t:style=\"itemStyle\"\r\n\t\t\tv-else-if=\"props.item.type === 'monthRange'\"\r\n\t\t\tv-model=\"tempKeys[props.item.tempKey]\"\r\n\t\t\t:disabled=\"Boolean(props.item.disabled) || props.disabled\"\r\n\t\t\tplacement=\"bottom-end\"\r\n\t\t\t:placeholder=\"props.item.placeholder || t('r.selectDate')\"\r\n\t\t\t:options1=\"props.item.dateOptions1 || null\"\r\n\t\t\t:options2=\"props.item.dateOptions2 || null\"\r\n\t\t\t@on-change=\"itemChange($event, props.item)\"\r\n\t\t/>\r\n\t\t<!--富文本编辑器Pro-->\r\n\t\t<editor-pro\r\n\t\t\tclass=\"inlineBlock\"\r\n\t\t\t:style=\"itemStyle\"\r\n\t\t\tv-else-if=\"props.item.type === 'editorPro'\"\r\n\t\t\tv-model=\"props.valGroup[props.item.key]\"\r\n\t\t\t:placeholder=\"props.item.placeholder || t('r.pInput')\"\r\n\t\t\t:disabled=\"Boolean(props.item.disabled) || props.disabled\"\r\n\t\t\t:toolbar-config=\"props.item.toolbarConfig || {}\"\r\n\t\t\t:editor-config=\"props.item.editorConfig || {}\"\r\n\t\t\t:mode=\"props.item.mode || 'simple'\"\r\n\t\t\t:height=\"props.item.height || 300\"\r\n\t\t\t@input=\"itemChange($event, props.item)\"\r\n\t\t/>\r\n\t\t<input-map\r\n\t\t\tv-else-if=\"props.item.type === 'inputMap'\"\r\n\t\t\tv-model=\"tempKeys[props.item.tempKey]\"\r\n\t\t\t:style=\"itemStyle\"\r\n\t\t\t:placeholder=\"props.item.placeholder || t('r.search')\"\r\n\t\t\t:disabled=\"Boolean(props.item.disabled) || props.disabled\"\r\n\t\t\t:show-map=\"props.item.showMap !== false\"\r\n\t\t\t:height=\"props.item.mapHeight || '250px'\"\r\n\t\t\t@on-change=\"itemChange($event, props.item)\"\r\n\t\t/>\r\n\t\t<div v-else-if=\"props.item.type === 'custom'\" class=\"inlineBlock\" :style=\"itemStyle\">\r\n\t\t\t<slot :name=\"props.item.slotName\" :val-group=\"props.valGroup\" />\r\n\t\t</div>\r\n\t\t<!--表单项提示文字-->\r\n\t\t<div v-if=\"Boolean(props.item.info)\" class=\"formInfoTxtXN\">{{ props.item.info }}</div>\r\n\t\t<!--表单项标题-->\r\n\t\t<div v-if=\"Boolean(props.item.title)\" class=\"formTitleTxtXN\">{{ props.item.title }}</div>\r\n\t</FormItem>\r\n</template>\r\n","<!--FormR 表单组件，支持formData属性定义结构，formRules定义规则，submit方法提交收集到的数据\r\n@created 2023.08.18\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script lang=\"ts\" setup>\r\n\timport { cloneDeep, remove, isEmpty, findIndex } from 'lodash-es'\r\n\timport moment from 'moment'\r\n\timport t from '../../locale/i18nSFC'\r\n\timport { setValue, myTypeof, isValidValue, trimObj, findCollection } from '../../utils/globalFunc'\r\n\timport $fetch from '../../utils/fetch'\r\n\timport { setTimeout } from '../../utils/timer'\r\n\timport type { FormItem } from '../../public'\r\n\timport ItemR from './ItemR.vue'\r\n\r\n\tconst emit = defineEmits(['on-item-change', 'on-reset', 'on-re-render', 'on-submit'])\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\tformData?: Array<FormItem | FormItem[]> /*表单结构数据*/\r\n\t\t\tformRules?: Record<string, any> /*表单结构规则*/\r\n\t\t\tshowMessage?: boolean /*显示校验信息*/\r\n\t\t\tlabelWidth?: number /*表单项标签宽度*/\r\n\t\t\tcontentWidth?: string /*表单项内容宽度，默认70%*/\r\n\t\t\titemWidth?: number /*表单项内容宽度,用于行内表单*/\r\n\t\t\tinline?: boolean /*行内表单*/\r\n\t\t\tshowLongOkBt?: boolean /*是否展示长确定按钮*/\r\n\t\t\tlongOkBtTxt?: string /*长确定按钮内容*/\r\n\t\t\tshowInlineOkBt?: boolean /*是否展示行内短确定按钮*/\r\n\t\t\tinlineOkBtTxt?: string /*短确定按钮内容*/\r\n\t\t\tshowInlineClearBt?: boolean /*是否展示行内短清空按钮*/\r\n\t\t\tinlineClearBtTxt?: string /*短清空按钮内容*/\r\n\t\t\tdisabled?: boolean /*全表禁用，仅展示*/\r\n\t\t\tbtnLoading?: boolean /*提交按钮显示loading*/\r\n\t\t\ttrim?: boolean /*是否去除提交数据中的字符串首尾空格*/\r\n\t\t\tteamClass?: string /*分组表单-组容器class*/\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\tformData: () => [],\r\n\t\t\tformRules: () => ({}),\r\n\t\t\tshowMessage: true,\r\n\t\t\tlabelWidth: 160,\r\n\t\t\tcontentWidth: '70%',\r\n\t\t\titemWidth: 200,\r\n\t\t\tinline: false,\r\n\t\t\tshowLongOkBt: false,\r\n\t\t\tshowInlineOkBt: false,\r\n\t\t\tshowInlineClearBt: false,\r\n\t\t\tdisabled: false,\r\n\t\t\tbtnLoading: false,\r\n\t\t\ttrim: true,\r\n\t\t\tteamClass: 'formTeamBox'\r\n\t\t}\r\n\t)\r\n\tconst formGroupXRef = ref<any>(null)\r\n\r\n\tconst valGroup = ref<Record<string, any>>({}) /*表单项值，对外公开，提交时传递到外层*/\r\n\tconst formDataT = ref<any>([]) /*表单结构数据*/\r\n\tconst tempKeys = ref<Record<string, any>>({}) /*不对外暴露表单项值*/\r\n\tlet watchGroup: any[] = []\r\n\tconst mgrUrl = window?.g?.mgrURL ?? ''\r\n\t/*selectInput的key没有写死在formData中（因为是动态的）,为了在showingKeys中能捕捉到这类组件的key,特声明此变量*/\r\n\tlet selectInputKeys: string[] = []\r\n\tlet hiddenKeys: string[] = []\r\n\tconst showLoading = ref(false)\r\n\tconst formReRenderKey = ref<number>(Math.random() * 100000000 + 1000) /*刷新表单*/\r\n\t/*上传组件的文件上传地址，远程上传（直接上传到服务器）时，如果没设置，则用该地址*/\r\n\tconst uploadUrl = window?.g?.mgrURL ? window.g.mgrURL + '/web/v1/fsc/file' : '/file'\r\n\tlet debounceCount = false\r\n\r\n\tconst formTeam = computed<boolean>(() => Array.isArray(props.formData.length ? props.formData[0] : false))\r\n\tconst formStyle = computed<Record<string, any>>(() =>\r\n\t\tprops.inline\r\n\t\t\t? {\r\n\t\t\t\t\twidth: props.itemWidth + props.labelWidth + 'px'\r\n\t\t\t\t}\r\n\t\t\t: {}\r\n\t)\r\n\tconst itemStyle = computed<Record<string, any>>(() =>\r\n\t\tprops.inline\r\n\t\t\t? {\r\n\t\t\t\t\twidth: '100%'\r\n\t\t\t\t}\r\n\t\t\t: { width: props.contentWidth }\r\n\t)\r\n\t/*计算表单规则*/\r\n\tconst formRulesT = computed<Record<string, any>>(() => {\r\n\t\tlet tr = cloneDeep(props.formRules)\r\n\t\tfor (let k in tr) {\r\n\t\t\tif (tr.hasOwnProperty(k)) {\r\n\t\t\t\tif (Array.isArray(tr[k])) {\r\n\t\t\t\t\tfor (let e of tr[k]) {\r\n\t\t\t\t\t\tif (!e) {\r\n\t\t\t\t\t\t\tcontinue\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (e && !(e.message || e.validator)) {\r\n\t\t\t\t\t\t\te.message = t('r.required')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (myTypeof(tr[k]) === 'Object') {\r\n\t\t\t\t\tif (!(tr[k].message || tr[k].validator)) {\r\n\t\t\t\t\t\ttr[k].message = t('r.required')\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn tr\r\n\t})\r\n\t/*展示的key(需要提交的)*/\r\n\tconst submitKeys = computed<string[]>(() => {\r\n\t\tlet t: string[] = []\r\n\t\tif (formTeam.value) {\r\n\t\t\tfor (let e of formDataT.value) {\r\n\t\t\t\tsubmitItems(e as FormItem[], t)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tsubmitItems(formDataT.value as FormItem[], t)\r\n\t\t}\r\n\t\treturn t.concat(selectInputKeys, hiddenKeys)\r\n\t})\r\n\tconst showingKeys = computed<string[]>(() => {\r\n\t\tlet t: any[] = []\r\n\t\tif (formTeam.value) {\r\n\t\t\tfor (let e of formDataT.value) {\r\n\t\t\t\tshowingItems(e as FormItem[], t)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tshowingItems(formDataT.value as FormItem[], t)\r\n\t\t}\r\n\t\treturn t\r\n\t})\r\n\r\n\tfunction getSlotFormData(d: any[]) {\r\n\t\t/*私有，获取插槽数据*/\r\n\t\treturn d.filter((e: Record<string, any>) => e?.slotName)\r\n\t}\r\n\r\n\t/**\r\n\t * 计算需要提交的key\r\n\t * @param d 表单结构数据\r\n\t * @param t 储存需要提交的key的对象\r\n\t */\r\n\tfunction submitItems(d: FormItem[], t: string[]) {\r\n\t\tfor (let root of d) {\r\n\t\t\tif (root.showing === true && root.key && root.type !== 'selectInput') {\r\n\t\t\t\tt.push(root.key)\r\n\t\t\t\tif (root.key2) {\r\n\t\t\t\t\tt.push(root.key2)\r\n\t\t\t\t}\r\n\t\t\t\tif (root.collectLabel) {\r\n\t\t\t\t\tif (!Array.isArray(root.collectLabel) && root.collectLabel.key) {\r\n\t\t\t\t\t\tt.push(root.collectLabel.key)\r\n\t\t\t\t\t} else if (Array.isArray(root.collectLabel)) {\r\n\t\t\t\t\t\tfor (let l of root.collectLabel) {\r\n\t\t\t\t\t\t\tif (l.key) {\r\n\t\t\t\t\t\t\t\tt.push(l.key)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 计算需要展示的key\r\n\t * @param d 表单结构数据\r\n\t * @param t 储存需要展示的key的对象\r\n\t */\r\n\tfunction showingItems(d: FormItem[], t: string[]) {\r\n\t\tfor (let root of d) {\r\n\t\t\tif (root.showing === true && root.key && root.type !== 'selectInput') {\r\n\t\t\t\tt.push(root.key)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/*重置表单，会清空表单值并刷新表单dom，异步方法（公开）*/\r\n\tfunction resetForm() {\r\n\t\treturn new Promise((r) => {\r\n\t\t\tclearForm()\r\n\t\t\trefreshFormDom().then(() => {\r\n\t\t\t\temit('on-reset')\r\n\t\t\t\tr(true)\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\t/*重新渲染表单，异步方法（公开）*/\r\n\tfunction reRenderForm() {\r\n\t\treturn new Promise((r) => {\r\n\t\t\tfor (let f of watchGroup) {\r\n\t\t\t\tf()\r\n\t\t\t}\r\n\t\t\twatchGroup = []\r\n\t\t\ttempKeys.value = {}\r\n\t\t\tinitValGroup()\r\n\t\t\tinitFormDataT()\r\n\r\n\t\t\trefreshFormDom().then(() => {\r\n\t\t\t\temit('on-re-render')\r\n\t\t\t\tr(true)\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\t/*刷新表单dom，异步方法（公开）*/\r\n\tfunction refreshFormDom() {\r\n\t\treturn new Promise((r) => {\r\n\t\t\tformReRenderKey.value = Math.floor(Math.random() * 100000000 + 1000)\r\n\t\t\t/*刷新表单*/\r\n\t\t\tnextTick(function () {\r\n\t\t\t\tr(true)\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\t/*清空表单值（私有，不推荐直接调用，可以调用resetForm）*/\r\n\tfunction clearForm() {\r\n\t\tlet defaultV = getDefaultValues()\r\n\r\n\t\tfor (let k in valGroup.value) {\r\n\t\t\tif (valGroup.value.hasOwnProperty(k)) {\r\n\t\t\t\tif (isValidValue(defaultV[k])) {\r\n\t\t\t\t\tvalGroup.value[k] = defaultV[k]\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (Array.isArray(valGroup.value[k])) {\r\n\t\t\t\t\t\tvalGroup.value[k] = []\r\n\t\t\t\t\t} else if (myTypeof(valGroup.value[k]) === 'Boolean') {\r\n\t\t\t\t\t\tvalGroup.value[k] = false\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst formItem = findCollection(props.formData, (e) => e?.key === k)\r\n\t\t\t\t\t\tif (formItem && (formItem.type === 'editor' || formItem.type === 'editorPro')) {\r\n\t\t\t\t\t\t\tvalGroup.value[k] = ''\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvalGroup.value[k] = null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tclearTempKeys(defaultV)\r\n\t}\r\n\r\n\t/*清空缓存表单值（私有，不推荐直接调用，可以调用resetForm）*/\r\n\tfunction clearTempKeys(defaultV: Record<string, any>) {\r\n\t\tfor (let k in tempKeys.value) {\r\n\t\t\tif (tempKeys.value.hasOwnProperty(k)) {\r\n\t\t\t\tif (isValidValue(defaultV[k])) {\r\n\t\t\t\t\ttempKeys.value[k] = defaultV[k]\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (Array.isArray(tempKeys.value[k])) {\r\n\t\t\t\t\t\ttempKeys.value[k] = []\r\n\t\t\t\t\t} else if (\r\n\t\t\t\t\t\tmyTypeof(tempKeys.value[k]) === 'Object' &&\r\n\t\t\t\t\t\ttempKeys.value[k].hasOwnProperty('key') &&\r\n\t\t\t\t\t\ttempKeys.value[k].hasOwnProperty('val')\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\t/*selectInput*/\r\n\t\t\t\t\t\ttempKeys.value[k].val = null\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttempKeys.value[k] = null\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/*清空缓存表单项值（私有）*/\r\n\tfunction clearTempKeyItem(k: string) {\r\n\t\tlet defaultV = getDefaultValues()\r\n\t\tif (isValidValue(defaultV[k])) {\r\n\t\t\ttempKeys.value[k] = defaultV[k]\r\n\t\t} else {\r\n\t\t\tif (Array.isArray(tempKeys.value[k])) {\r\n\t\t\t\ttempKeys.value[k] = []\r\n\t\t\t} else {\r\n\t\t\t\ttempKeys.value[k] = null\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/*获取默认值（私有）*/\r\n\tfunction getDefaultValues(): Record<string, any> {\r\n\t\tlet t: Record<string, any> = {}\r\n\t\tif (formTeam.value) {\r\n\t\t\tfor (let e of formDataT.value) {\r\n\t\t\t\tdefaultValItems(e as FormItem[], t)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tdefaultValItems(formDataT.value as FormItem[], t)\r\n\t\t}\r\n\t\treturn t\r\n\t}\r\n\r\n\t/**\r\n\t * 从表单结构数据获取默认值(私有)\r\n\t * @param d 表单结构数据\r\n\t * @param a 储存默认值的对象\r\n\t */\r\n\tfunction defaultValItems(d: FormItem[], a: Record<string, any>) {\r\n\t\tfor (let root of d) {\r\n\t\t\tif (root.tempKey && isValidValue(root.defaultVal)) {\r\n\t\t\t\t/*将默认值转换为表单项绑定值对应的格式*/\r\n\t\t\t\tgetTempKeyDefaultVal(root, a)\r\n\t\t\t}\r\n\t\t\tif (root.key && isValidValue(root.defaultVal)) {\r\n\t\t\t\ta[root.key] = root.defaultVal\r\n\t\t\t}\r\n\t\t\tif (root.key2 && isValidValue(root.defaultVal2)) {\r\n\t\t\t\ta[root.key2] = root.defaultVal2\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 判断是否展示表单项（私有，高频被调用方法，每次表单中有任何值更改，都会被调用formDataT的长度<formDataT.length>次，而且还可能触发连锁反应）\r\n\t * @param root 表单项结构数据\r\n\t */\r\n\tfunction getFormItemIfVal(root: FormItem) {\r\n\t\tif (root.show) {\r\n\t\t\tif (myTypeof(root.show) === 'Object') {\r\n\t\t\t\treturn returnIfVal(root, dealIfItem(root.show))\r\n\t\t\t} else if (Array.isArray(root.show)) {\r\n\t\t\t\tif (root.showOr) {\r\n\t\t\t\t\tfor (let x of root.show) {\r\n\t\t\t\t\t\tif (dealIfItem(x) === true) {\r\n\t\t\t\t\t\t\treturn returnIfVal(root, true)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn returnIfVal(root, false)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor (let x of root.show) {\r\n\t\t\t\t\t\tif (dealIfItem(x) === false) {\r\n\t\t\t\t\t\t\treturn returnIfVal(root, false)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn returnIfVal(root, true)\r\n\t\t\t\t}\r\n\t\t\t} else if (typeof root.show === 'function') {\r\n\t\t\t\treturn returnIfVal(root, root.show(valGroup.value))\r\n\t\t\t}\r\n\t\t} else if (!root.showing) {\r\n\t\t\troot.showing = true\r\n\t\t}\r\n\t\treturn true\r\n\t}\r\n\r\n\t/**\r\n\t * 判断表单项是否展示（私有）\r\n\t * @param show 表单项的展示配置数据\r\n\t */\r\n\tfunction dealIfItem(show: Record<string, any>) {\r\n\t\tif (show.reg && typeof show.reg.test === 'function') {\r\n\t\t\treturn show.reg.test(valGroup.value[show.key])\r\n\t\t} else if (Array.isArray(show.val)) {\r\n\t\t\tfor (let v of show.val) {\r\n\t\t\t\tif (\r\n\t\t\t\t\t(valGroup.value[show.key] || valGroup.value[show.key] === 0 || valGroup.value[show.key] === false) &&\r\n\t\t\t\t\tv === '.'\r\n\t\t\t\t) {\r\n\t\t\t\t\t/*只要控制项有值及展示*/\r\n\t\t\t\t\treturn true\r\n\t\t\t\t} else if (valGroup.value[show.key] === v) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false\r\n\t\t} else {\r\n\t\t\treturn false\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 将是否展示的结果写入表单结构对象，同时处理默认值相关逻辑（私有）\r\n\t * @param root 表单项结构数据\r\n\t * @param {boolean} val 是否展示的结果\r\n\t */\r\n\tfunction returnIfVal(root: FormItem, val: boolean) {\r\n\t\tif (!root.showing && val && root.key) {\r\n\t\t\troot.showing = val\r\n\r\n\t\t\tif (root.defaultVal !== undefined) {\r\n\t\t\t\t/*对之前没展示且没值的表单项赋默认值*/\r\n\t\t\t\tif (root.tempKey) {\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\ttempKeys.value[root.tempKey] === null ||\r\n\t\t\t\t\t\ttempKeys.value[root.tempKey] === undefined ||\r\n\t\t\t\t\t\t((myTypeof(tempKeys.value[root.tempKey]) === 'Object' || Array.isArray(tempKeys.value[root.tempKey])) &&\r\n\t\t\t\t\t\t\tisEmpty(tempKeys.value[root.tempKey]))\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tgetTempKeyDefaultVal(root, tempKeys.value)\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (valGroup.value[root.key] === null || valGroup.value[root.key] === undefined) {\r\n\t\t\t\t\tvalGroup.value[root.key] = root.defaultVal\r\n\t\t\t\t}\r\n\t\t\t\tif (\r\n\t\t\t\t\troot.key2 &&\r\n\t\t\t\t\troot.deafultVal2 !== undefined &&\r\n\t\t\t\t\t(valGroup.value[root.key2] === null || valGroup.value[root.key2] === undefined) &&\r\n\t\t\t\t\troot.type !== 'inputMap'\r\n\t\t\t\t) {\r\n\t\t\t\t\tvalGroup.value[root.key2] = root.defaultVal2\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (root.tempKey) {\r\n\t\t\t\t/*在隐藏表单项展示时把它的值赋给统计对象*/\r\n\t\t\t\ttempKeysWatchHandle(tempKeys.value[root.tempKey], root)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\troot.showing = val\r\n\t\t}\r\n\t\treturn val\r\n\t}\r\n\r\n\t/**\r\n\t * 将使用tempKey的表单项的默认值赋转换成对应格式并储存(私有)\r\n\t * @param root 表单项结构数据\r\n\t * @param a 储存默认值的容器\r\n\t */\r\n\tfunction getTempKeyDefaultVal(root: FormItem, a: Record<string, any>) {\r\n\t\tswitch (root.type) {\r\n\t\t\tcase 'selectInput':\r\n\t\t\t\ta[root.tempKey] = {\r\n\t\t\t\t\tkey: root.key,\r\n\t\t\t\t\tval: root.defaultVal\r\n\t\t\t\t}\r\n\t\t\t\tbreak\r\n\t\t\tcase 'inputMap':\r\n\t\t\t\tif (root.key3) {\r\n\t\t\t\t\ta[root.tempKey] = {\r\n\t\t\t\t\t\tlng: root.defaultVal || 0,\r\n\t\t\t\t\t\tlat: root.defaultVal2 || 0,\r\n\t\t\t\t\t\tname: root.defaultVal3 || ''\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta[root.tempKey] = {\r\n\t\t\t\t\t\tlng: root.defaultVal || 0,\r\n\t\t\t\t\t\tlat: root.defaultVal2 || 0\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tbreak\r\n\t\t\tcase 'input':\r\n\t\t\tcase 'inputNumber':\r\n\t\t\tcase 'textarea':\r\n\t\t\t\ta[root.tempKey] = root.defaultVal\r\n\t\t\t\tbreak\r\n\t\t\tcase 'radioGroup':\r\n\t\t\tcase 'select':\r\n\t\t\tcase 'checkboxGroup':\r\n\t\t\t\tif (root.booleanVal) {\r\n\t\t\t\t\ta[root.tempKey] = Boolean(root.defaultVal) ? 1 : 0\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta[root.tempKey] = root.defaultVal\r\n\t\t\t\t}\r\n\t\t\t\tbreak\r\n\t\t\tcase 'date':\r\n\t\t\tcase 'time':\r\n\t\t\tcase 'monthRange':\r\n\t\t\t\tif (\r\n\t\t\t\t\troot.dateType === 'date' ||\r\n\t\t\t\t\troot.dateType === 'datetime' ||\r\n\t\t\t\t\troot.dateType === 'time' ||\r\n\t\t\t\t\troot.dateType === 'year' ||\r\n\t\t\t\t\troot.dateType === 'month'\r\n\t\t\t\t) {\r\n\t\t\t\t\ta[root.tempKey] = root.defaultVal\r\n\t\t\t\t} else if (\r\n\t\t\t\t\troot.dateType === 'daterange' ||\r\n\t\t\t\t\troot.dateType === 'datetimerange' ||\r\n\t\t\t\t\troot.dateType === 'timerange' ||\r\n\t\t\t\t\troot.type === 'monthRange'\r\n\t\t\t\t) {\r\n\t\t\t\t\ta[root.tempKey] = (root.defaultVal && root.defaultVal2 && [root.defaultVal, root.defaultVal2]) || []\r\n\t\t\t\t}\r\n\t\t\t\tbreak\r\n\t\t}\r\n\t}\r\n\r\n\t/*初始化表单结构（私有）*/\r\n\tfunction initFormDataT() {\r\n\t\tlet t = cloneDeep(props.formData)\r\n\t\tif (formTeam.value) {\r\n\t\t\tfor (let box of t) {\r\n\t\t\t\tinitItems(box as FormItem[])\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tinitItems(t as FormItem[])\r\n\t\t}\r\n\t\tformDataT.value = t\r\n\t}\r\n\r\n\tfunction initItems(d: FormItem[]) {\r\n\t\tfor (let root of d) {\r\n\t\t\tswitch (root.type) {\r\n\t\t\t\tcase 'selectInput':\r\n\t\t\t\t\tconst tempKeyF = 'selectInput' + Math.floor(Math.random() * 100000000)\r\n\t\t\t\t\troot.tempKey = tempKeyF\r\n\t\t\t\t\ttempKeys.value[tempKeyF] = ref<Record<string, any>>({\r\n\t\t\t\t\t\tkey: root.key || null,\r\n\t\t\t\t\t\tval: root.defaultVal || null\r\n\t\t\t\t\t})\r\n\t\t\t\t\twatchGroup.push(\r\n\t\t\t\t\t\twatch(\r\n\t\t\t\t\t\t\t() => tempKeys.value[tempKeyF],\r\n\t\t\t\t\t\t\t(after) => {\r\n\t\t\t\t\t\t\t\ttempKeysWatchHandle(after, root)\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{ immediate: true }\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t)\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase 'inputMap':\r\n\t\t\t\t\tconst tempKeyE = 'inputMap' + Math.floor(Math.random() * 100000000)\r\n\t\t\t\t\tif (root.key) {\r\n\t\t\t\t\t\troot.tempKey = tempKeyE\r\n\t\t\t\t\t\tif (root.key3) {\r\n\t\t\t\t\t\t\ttempKeys.value[tempKeyE] =\r\n\t\t\t\t\t\t\t\troot.defaultVal !== undefined && root.defaultVal2 !== undefined\r\n\t\t\t\t\t\t\t\t\t? {\r\n\t\t\t\t\t\t\t\t\t\t\tlng: root.defaultVal,\r\n\t\t\t\t\t\t\t\t\t\t\tlat: root.defaultVal2,\r\n\t\t\t\t\t\t\t\t\t\t\tname: root.defaultVal3 || ''\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t: {\r\n\t\t\t\t\t\t\t\t\t\t\tlng: null,\r\n\t\t\t\t\t\t\t\t\t\t\tlat: null,\r\n\t\t\t\t\t\t\t\t\t\t\tname: null\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttempKeys.value[tempKeyE] =\r\n\t\t\t\t\t\t\t\troot.defaultVal !== undefined && root.defaultVal2 !== undefined\r\n\t\t\t\t\t\t\t\t\t? {\r\n\t\t\t\t\t\t\t\t\t\t\tlng: root.defaultVal,\r\n\t\t\t\t\t\t\t\t\t\t\tlat: root.defaultVal2\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t: {\r\n\t\t\t\t\t\t\t\t\t\t\tlng: null,\r\n\t\t\t\t\t\t\t\t\t\t\tlat: null\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\twatchGroup.push(\r\n\t\t\t\t\t\t\twatch(\r\n\t\t\t\t\t\t\t\t() => tempKeys.value[tempKeyE],\r\n\t\t\t\t\t\t\t\t(after) => {\r\n\t\t\t\t\t\t\t\t\ttempKeysWatchHandle(after, root)\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{ immediate: true }\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase 'input':\r\n\t\t\t\tcase 'inputNumber':\r\n\t\t\t\tcase 'textarea':\r\n\t\t\t\t\tconst tempKeyD = 'inputT' + Math.floor(Math.random() * 100000000)\r\n\t\t\t\t\tif (root.key) {\r\n\t\t\t\t\t\troot.tempKey = tempKeyD\r\n\t\t\t\t\t\ttempKeys.value[tempKeyD] = root.defaultVal !== undefined ? root.defaultVal : null\r\n\t\t\t\t\t\twatchGroup.push(\r\n\t\t\t\t\t\t\twatch(\r\n\t\t\t\t\t\t\t\t() => tempKeys.value[tempKeyD],\r\n\t\t\t\t\t\t\t\t(after) => {\r\n\t\t\t\t\t\t\t\t\ttempKeysWatchHandle(after, root)\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{ immediate: true }\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase 'select':\r\n\t\t\t\tcase 'radioGroup':\r\n\t\t\t\tcase 'checkboxGroup':\r\n\t\t\t\t\tif (!root.options) {\r\n\t\t\t\t\t\troot.options = []\r\n\t\t\t\t\t}\r\n\t\t\t\t\t/*为checkboxGroup和radioGroup的options做响应式，因为它们和select不同，选项一开始就是展示出来的，大多数时候不会有机会主动重新渲染*/\r\n\t\t\t\t\tif (root.type === 'checkboxGroup' || root.type === 'radioGroup') {\r\n\t\t\t\t\t\troot.options = ref(cloneDeep(root.options))\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (root.asyncOption) {\r\n\t\t\t\t\t\t/*远程待选项*/\r\n\t\t\t\t\t\tif (root.changeOption) {\r\n\t\t\t\t\t\t\t/*待选项会根据条件改变*/\r\n\t\t\t\t\t\t\tif (Array.isArray(root.changeOption)) {\r\n\t\t\t\t\t\t\t\tlet go = true\r\n\t\t\t\t\t\t\t\tfor (let cp of root.changeOption) {\r\n\t\t\t\t\t\t\t\t\t/*检验changeOption参数是否可用*/\r\n\t\t\t\t\t\t\t\t\tif (!cp.valKey || !cp.key) {\r\n\t\t\t\t\t\t\t\t\t\tgo = false\r\n\t\t\t\t\t\t\t\t\t\tbreak\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (go) {\r\n\t\t\t\t\t\t\t\t\twatchGroup.push(\r\n\t\t\t\t\t\t\t\t\t\twatch(\r\n\t\t\t\t\t\t\t\t\t\t\t() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet tUrl = ''\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (Array.isArray(root.changeOption)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfor (let cp of root.changeOption) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet vT = valGroup.value[cp.valKey]\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (vT || vT === 0 || vT === false) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/*如果条件有有效值，则拉取待选项*/\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttUrl += '&' + cp.key + '=' + vT\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else if (!cp.notRequired) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/*条件为必填（notRequired!==true,默认必填），且没有有效值，则不拉取待选项*/\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn tUrl\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t(after) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet tV = cloneDeep(tempKeys.value[root.tempKey])\r\n\t\t\t\t\t\t\t\t\t\t\t\ttempKeys.value[root.tempKey] = null\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (after && root.optionUrl) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet urlT = root.optionUrl.indexOf('?') !== -1 ? root.optionUrl : root.optionUrl + '?'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinitOption((urlT + after).replace(/\\?&/, '?'), root, tV)\r\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (root.localOption) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetValue(root.options, [...root.localOption])\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetValue(root.options, [])\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (isValidValue(tV)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trecoverVal(tV, root)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\timmediate: true\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tif (root.localOption) {\r\n\t\t\t\t\t\t\t\t\t\tsetValue(root.options, [...root.localOption])\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tsetValue(root.options, [])\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else if (typeof root.changeOption === 'object') {\r\n\t\t\t\t\t\t\t\tif (root.changeOption.valKey && root.changeOption.key) {\r\n\t\t\t\t\t\t\t\t\twatchGroup.push(\r\n\t\t\t\t\t\t\t\t\t\twatch(\r\n\t\t\t\t\t\t\t\t\t\t\t() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (typeof root.changeOption === 'object' && !Array.isArray(root.changeOption)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn valGroup.value[root.changeOption.valKey]\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t(after) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet tV = cloneDeep(tempKeys.value[root.tempKey])\r\n\t\t\t\t\t\t\t\t\t\t\t\ttempKeys.value[root.tempKey] = null\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t(after || after === 0 || after === false) &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\troot.optionUrl &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttypeof root.changeOption === 'object' &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t!Array.isArray(root.changeOption)\r\n\t\t\t\t\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet urlT = root.optionUrl.indexOf('?') !== -1 ? root.optionUrl : root.optionUrl + '?'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinitOption((urlT + '&' + root.changeOption.key + '=' + after).replace(/\\?&/, '?'), root, tV)\r\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (root.localOption) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetValue(root.options, [...root.localOption])\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetValue(root.options, [])\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (isValidValue(tV)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trecoverVal(tV, root)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t{ immediate: true }\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else if (myTypeof(root.changeOption) === 'Boolean') {\r\n\t\t\t\t\t\t\t\t/*设置changeOption为true时,当待选项地址改变后重新拉取待选项，在使用该表单组件的地方改变传入的formData对应项的optionUrl*/\r\n\t\t\t\t\t\t\t\twatchGroup.push(\r\n\t\t\t\t\t\t\t\t\twatch(\r\n\t\t\t\t\t\t\t\t\t\t() => {\r\n\t\t\t\t\t\t\t\t\t\t\tconst t = findCollection(props.formData, (e) => e?.key === root.key)\r\n\t\t\t\t\t\t\t\t\t\t\tt.optionUrl = toRef(t.optionUrl)\r\n\t\t\t\t\t\t\t\t\t\t\treturn t.optionUrl.value\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t(after) => {\r\n\t\t\t\t\t\t\t\t\t\t\tlet tV = cloneDeep(tempKeys.value[root.tempKey])\r\n\t\t\t\t\t\t\t\t\t\t\ttempKeys.value[root.tempKey] = null\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif (after) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tinitOption(after, root, tV)\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (root.localOption) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetValue(root.options, [...root.localOption])\r\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetValue(root.options, [])\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (isValidValue(tV)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\trecoverVal(tV, root)\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\timmediate: true\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (root.optionUrl) {\r\n\t\t\t\t\t\t\tinitOption(root.optionUrl, root)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (myTypeof(root.borrowOption) === 'String') {\r\n\t\t\t\t\t\t/*借用待选项*/\r\n\t\t\t\t\t\tnextTick(function () {\r\n\t\t\t\t\t\t\troot.options = findCollection(formDataT.value, (e) => e?.key === root.borrowOption).options\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst tempKeyC = 'opEle' + Math.floor(Math.random() * 100000000)\r\n\t\t\t\t\tif (root.key) {\r\n\t\t\t\t\t\troot.tempKey = tempKeyC\r\n\t\t\t\t\t\tif ((root.type === 'select' && root.multiple) || root.type === 'checkboxGroup') {\r\n\t\t\t\t\t\t\ttempKeys.value[tempKeyC] = root.defaultVal !== undefined ? root.defaultVal : []\r\n\t\t\t\t\t\t} else if (root.booleanVal) {\r\n\t\t\t\t\t\t\ttempKeys.value[tempKeyC] = root.defaultVal !== undefined ? (Boolean(root.defaultVal) ? 1 : 0) : null\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttempKeys.value[tempKeyC] = root.defaultVal !== undefined ? root.defaultVal : null\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\twatchGroup.push(\r\n\t\t\t\t\t\t\twatch(\r\n\t\t\t\t\t\t\t\t() => tempKeys.value[tempKeyC],\r\n\t\t\t\t\t\t\t\t(after) => {\r\n\t\t\t\t\t\t\t\t\ttempKeysWatchHandle(after, root)\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\timmediate: true\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase 'date':\r\n\t\t\t\tcase 'time':\r\n\t\t\t\tcase 'monthRange':\r\n\t\t\t\t\tconst tempKeyB = 'date' + Math.floor(Math.random() * 100000000)\r\n\t\t\t\t\troot.tempKey = tempKeyB\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\troot.dateType === 'date' ||\r\n\t\t\t\t\t\troot.dateType === 'datetime' ||\r\n\t\t\t\t\t\troot.dateType === 'time' ||\r\n\t\t\t\t\t\troot.dateType === 'year' ||\r\n\t\t\t\t\t\troot.dateType === 'month'\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\ttempKeys.value[tempKeyB] = root.defaultVal || null\r\n\t\t\t\t\t} else if (\r\n\t\t\t\t\t\troot.dateType === 'daterange' ||\r\n\t\t\t\t\t\troot.dateType === 'datetimerange' ||\r\n\t\t\t\t\t\troot.dateType === 'timerange' ||\r\n\t\t\t\t\t\troot.type === 'monthRange'\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\ttempKeys.value[tempKeyB] =\r\n\t\t\t\t\t\t\t(root.defaultVal && root.defaultVal2 && [root.defaultVal, root.defaultVal2]) || []\r\n\t\t\t\t\t}\r\n\t\t\t\t\twatchGroup.push(\r\n\t\t\t\t\t\twatch(\r\n\t\t\t\t\t\t\t() => tempKeys.value[tempKeyB],\r\n\t\t\t\t\t\t\t(after) => {\r\n\t\t\t\t\t\t\t\ttempKeysWatchHandle(after, root)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t)\r\n\t\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 初始化表单项的选项，如下拉选项，多选、单选组选项（私有）\r\n\t * @param url 远程选项接口地址\r\n\t * @param root 表单项结构数据对象\r\n\t * @param itemVal 缓存的表单项旧值\r\n\t */\r\n\tfunction initOption(url: string, root: FormItem, itemVal?: any) {\r\n\t\t$fetch\r\n\t\t\t.get(url)\r\n\t\t\t.then((r: any) => {\r\n\t\t\t\tlet o\r\n\t\t\t\tif (isRef(root.options)) {\r\n\t\t\t\t\to = root.options.value\r\n\t\t\t\t} else {\r\n\t\t\t\t\to = root.options\r\n\t\t\t\t}\r\n\t\t\t\tif (!o) {\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tlet tOption = r?.data?.records || r?.data || r || []\r\n\t\t\t\tif (Array.isArray(tOption)) {\r\n\t\t\t\t\tif (root.optionFilter && myTypeof(root.optionFilter) === 'Function') {\r\n\t\t\t\t\t\ttOption = root.optionFilter(tOption)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (root.optionLabel && root.optionVal) {\r\n\t\t\t\t\t\t/*label由多个字段组合成*/\r\n\t\t\t\t\t\to.length = 0\r\n\t\t\t\t\t\to.push(\r\n\t\t\t\t\t\t\t...tOption.map((eP: Record<string, any>) => {\r\n\t\t\t\t\t\t\t\tlet rP: Record<string, any>\r\n\t\t\t\t\t\t\t\tif (Array.isArray(root.optionLabel)) {\r\n\t\t\t\t\t\t\t\t\t/*组合成的label*/\r\n\t\t\t\t\t\t\t\t\tlet rL = ''\r\n\t\t\t\t\t\t\t\t\troot.optionLabel.forEach((v, i) => {\r\n\t\t\t\t\t\t\t\t\t\t/*需要在label中显示的字段的值*/\r\n\t\t\t\t\t\t\t\t\t\tlet lVal = String(eP[v])\r\n\t\t\t\t\t\t\t\t\t\tif (i === 1) {\r\n\t\t\t\t\t\t\t\t\t\t\trL += '（' + lVal\r\n\t\t\t\t\t\t\t\t\t\t} else if (i > 1) {\r\n\t\t\t\t\t\t\t\t\t\t\trL += '、' + lVal\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\trL += lVal\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\trP = {\r\n\t\t\t\t\t\t\t\t\t\tlabel: rL + '）',\r\n\t\t\t\t\t\t\t\t\t\tval: root.optionVal && eP[root.optionVal]\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\trP = {\r\n\t\t\t\t\t\t\t\t\t\tlabel: root.optionLabel && eP[root.optionLabel],\r\n\t\t\t\t\t\t\t\t\t\tval: root.optionVal && eP[root.optionVal]\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t/*除了要收集绑定值，还要一并收集其他字段,则将其他字段加入到待选列表项*/\r\n\t\t\t\t\t\t\t\tif (root.collectLabel) {\r\n\t\t\t\t\t\t\t\t\tif (Array.isArray(root.collectLabel)) {\r\n\t\t\t\t\t\t\t\t\t\tfor (let tC of root.collectLabel) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (tC.valKey && tC.valKey !== 'label') {\r\n\t\t\t\t\t\t\t\t\t\t\t\trP[tC.valKey] = eP[tC.valKey]\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tif (root.collectLabel.valKey && root.collectLabel.valKey !== 'label') {\r\n\t\t\t\t\t\t\t\t\t\t\trP[root.collectLabel.valKey] = eP[root.collectLabel.valKey]\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (rP.val !== null && rP.val !== undefined) {\r\n\t\t\t\t\t\t\t\t\treturn rP\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\to.length = 0\r\n\t\t\t\t\t\to.push(...tOption)\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\to.length = 0\r\n\t\t\t\t}\r\n\t\t\t\tif (root.localOption) {\r\n\t\t\t\t\to.unshift(...root.localOption)\r\n\t\t\t\t}\r\n\t\t\t\tif (isValidValue(itemVal)) {\r\n\t\t\t\t\trecoverVal(itemVal, root)\r\n\t\t\t\t}\r\n\r\n\t\t\t\t/*待选项禁用*/\r\n\t\t\t\tif (root.disableOptionByOthers) {\r\n\t\t\t\t\tif (myTypeof(root.disableOptionByOthers) === 'String') {\r\n\t\t\t\t\t\twatchGroup.push(\r\n\t\t\t\t\t\t\twatch(\r\n\t\t\t\t\t\t\t\t() => valGroup.value[root.disableOptionByOthers],\r\n\t\t\t\t\t\t\t\t(after) => {\r\n\t\t\t\t\t\t\t\t\tclearTempKeyItem(root.tempKey)\r\n\t\t\t\t\t\t\t\t\tif (!o) {\r\n\t\t\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tfor (let iP of o) {\r\n\t\t\t\t\t\t\t\t\t\tif (iP.disabled) {\r\n\t\t\t\t\t\t\t\t\t\t\tiP.disabled = false\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (after || after === 0 || after === false) {\r\n\t\t\t\t\t\t\t\t\t\tfor (let iP of o) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (iP.val === after) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tiP.disabled = true\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\timmediate: true\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t} else if (Array.isArray(root.disableOptionByOthers)) {\r\n\t\t\t\t\t\twatchGroup.push(\r\n\t\t\t\t\t\t\twatch(\r\n\t\t\t\t\t\t\t\t() => {\r\n\t\t\t\t\t\t\t\t\treturn root.disableOptionByOthers.filter((e: any) => e).map((e: string) => valGroup.value[e])\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t(after) => {\r\n\t\t\t\t\t\t\t\t\tclearTempKeyItem(root.tempKey)\r\n\t\t\t\t\t\t\t\t\tif (!o) {\r\n\t\t\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tfor (let iP of o) {\r\n\t\t\t\t\t\t\t\t\t\tif (iP.disabled) {\r\n\t\t\t\t\t\t\t\t\t\t\tiP.disabled = false\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (after) {\r\n\t\t\t\t\t\t\t\t\t\tfor (let iP of o) {\r\n\t\t\t\t\t\t\t\t\t\t\tfor (let i = 0; i < after.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (iP.val === after[i]) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tiP.disabled = true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tafter.splice(i, 1)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\timmediate: true\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch(() => {\r\n\t\t\t\tconsole.warn('拉取选项出错')\r\n\t\t\t})\r\n\t}\r\n\r\n\t/**\r\n\t * 如果options中选项的值和缓存的表单项旧值相等,则为表单项恢复之前因待选项改变而清除的值（私有）\r\n\t * @param itemVal 缓存的旧值\r\n\t * @param root 表单项结构数据对象\r\n\t */\r\n\tfunction recoverVal(itemVal: any, root: FormItem) {\r\n\t\tif (Array.isArray(toValue(root.options))) {\r\n\t\t\tif (findIndex(toValue(root.options), { val: itemVal }) !== -1) {\r\n\t\t\t\ttempKeys.value[root.tempKey] = itemVal\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/*初始化表单项值（私有）*/\r\n\tfunction initValGroup() {\r\n\t\tvalGroup.value = {}\r\n\t\tif (formTeam.value) {\r\n\t\t\tfor (let e of props.formData) {\r\n\t\t\t\tinitValItems(e as FormItem[])\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tinitValItems(props.formData as FormItem[])\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 根据表单结构数据，初始化valGroup（私有）\r\n\t * @param d 表单结构数据\r\n\t */\r\n\tfunction initValItems(d: FormItem[]) {\r\n\t\tfor (let root of d) {\r\n\t\t\tif (root.key) {\r\n\t\t\t\tif (root.type === 'checkboxGroup' || (root.type === 'select' && root.multiple)) {\r\n\t\t\t\t\tvalGroup.value[root.key] = root.defaultVal !== undefined && root.show === undefined ? root.defaultVal : []\r\n\t\t\t\t} else if (root.type === 'editor' || root.type === 'editorPro') {\r\n\t\t\t\t\tvalGroup.value[root.key] = root.defaultVal !== undefined && root.show === undefined ? root.defaultVal : ''\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvalGroup.value[root.key] = root.defaultVal !== undefined && root.show === undefined ? root.defaultVal : null\r\n\t\t\t\t\tif (root.key2) {\r\n\t\t\t\t\t\tvalGroup.value[root.key2] =\r\n\t\t\t\t\t\t\troot.defaultVal2 !== undefined && root.show === undefined ? root.defaultVal2 : null\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/*将缓存表单值给统计对象（私有）*/\r\n\tfunction tempKeysWatchHandle(after: any, root: FormItem) {\r\n\t\tif (root.showing) {\r\n\t\t\tswitch (root.type) {\r\n\t\t\t\tcase 'selectInput':\r\n\t\t\t\t\tif (after) {\r\n\t\t\t\t\t\tif (after.beforeKey) {\r\n\t\t\t\t\t\t\tdelete valGroup.value[after.beforeKey]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvalGroup.value[after.key] = after.val\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase 'inputMap':\r\n\t\t\t\t\tif (!root.key || !root.key2) {\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (after) {\r\n\t\t\t\t\t\tvalGroup.value[root.key] = after.lng\r\n\t\t\t\t\t\tvalGroup.value[root.key2] = after.lat\r\n\t\t\t\t\t\tif (root.key3) {\r\n\t\t\t\t\t\t\tvalGroup.value[root.key3] = after.name\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvalGroup.value[root.key] = null\r\n\t\t\t\t\t\tvalGroup.value[root.key2] = null\r\n\t\t\t\t\t\tif (root.key3) {\r\n\t\t\t\t\t\t\tvalGroup.value[root.key3] = null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase 'input':\r\n\t\t\t\tcase 'inputNumber':\r\n\t\t\t\tcase 'textarea':\r\n\t\t\t\t\tif (!root.key) {\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (after || after === 0) {\r\n\t\t\t\t\t\tlet reg = /^-?\\d+(.\\d+)?$/\r\n\t\t\t\t\t\tif (root.numberVal && reg.test(after)) {\r\n\t\t\t\t\t\t\tvalGroup.value[root.key] = Number(after)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvalGroup.value[root.key] = after\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvalGroup.value[root.key] = null\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase 'select':\r\n\t\t\t\tcase 'radioGroup':\r\n\t\t\t\tcase 'checkboxGroup':\r\n\t\t\t\t\tif (!root.key) {\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (root.booleanVal && !root.multiple) {\r\n\t\t\t\t\t\tvalGroup.value[root.key] = after === undefined || after === '' || after === null ? null : Boolean(after)\r\n\t\t\t\t\t} else if (root.multiple || root.type === 'checkboxGroup') {\r\n\t\t\t\t\t\tvalGroup.value[root.key] = Object.assign([], after)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvalGroup.value[root.key] = after\r\n\t\t\t\t\t}\r\n\t\t\t\t\t/*除了要收集绑定值，还要一并收集其他字段*/\r\n\t\t\t\t\tif (root.collectLabel) {\r\n\t\t\t\t\t\tconst targetOption = findOptions(root, after)\r\n\r\n\t\t\t\t\t\tif (Array.isArray(root.collectLabel)) {\r\n\t\t\t\t\t\t\tfor (let l of root.collectLabel) {\r\n\t\t\t\t\t\t\t\tif (l?.key && l.valKey) {\r\n\t\t\t\t\t\t\t\t\tconst collectTempKey = findTempKey(l.key)\r\n\t\t\t\t\t\t\t\t\tlet t: any = null\r\n\r\n\t\t\t\t\t\t\t\t\tif (Array.isArray(targetOption)) {\r\n\t\t\t\t\t\t\t\t\t\tt = targetOption.map((e) => e[l.valKey])\r\n\t\t\t\t\t\t\t\t\t\tvalGroup.value[l.key] = t\r\n\t\t\t\t\t\t\t\t\t\tif (collectTempKey) {\r\n\t\t\t\t\t\t\t\t\t\t\ttempKeys.value[collectTempKey] = t\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tif (targetOption && isValidValue(targetOption[l.valKey])) {\r\n\t\t\t\t\t\t\t\t\t\t\tt = targetOption[l.valKey]\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tvalGroup.value[l.key] = t\r\n\t\t\t\t\t\t\t\t\t\tif (collectTempKey) {\r\n\t\t\t\t\t\t\t\t\t\t\ttempKeys.value[collectTempKey] = t\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tlet sameKeyCom = findCollection(formDataT.value, (e) => e?.key === l.key)\r\n\t\t\t\t\t\t\t\t\tif (sameKeyCom && sameKeyCom.tempKey) {\r\n\t\t\t\t\t\t\t\t\t\ttempKeys.value[sameKeyCom.tempKey] = valGroup.value[l.key]\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (typeof root.collectLabel === 'object') {\r\n\t\t\t\t\t\t\tif (root.collectLabel.key && root.collectLabel.valKey) {\r\n\t\t\t\t\t\t\t\tconst collectTempKey = findTempKey(root.collectLabel.key)\r\n\t\t\t\t\t\t\t\tlet t: any = null\r\n\t\t\t\t\t\t\t\tif (Array.isArray(targetOption)) {\r\n\t\t\t\t\t\t\t\t\tt = targetOption.map(\r\n\t\t\t\t\t\t\t\t\t\t(e) => root.collectLabel && !Array.isArray(root.collectLabel) && e[root.collectLabel.valKey]\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\tvalGroup.value[root.collectLabel.key] = t\r\n\t\t\t\t\t\t\t\t\tif (collectTempKey) {\r\n\t\t\t\t\t\t\t\t\t\ttempKeys.value[collectTempKey] = t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tif (targetOption && isValidValue(targetOption[root.collectLabel.valKey])) {\r\n\t\t\t\t\t\t\t\t\t\tt = targetOption[root.collectLabel.valKey]\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tvalGroup.value[root.collectLabel.key] = t\r\n\t\t\t\t\t\t\t\t\tif (collectTempKey) {\r\n\t\t\t\t\t\t\t\t\t\ttempKeys.value[collectTempKey] = t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tlet sameKeyCom = findCollection(\r\n\t\t\t\t\t\t\t\t\tformDataT.value,\r\n\t\t\t\t\t\t\t\t\t(e) =>\r\n\t\t\t\t\t\t\t\t\t\t(root.collectLabel && !Array.isArray(root.collectLabel) && e?.key === root.collectLabel.key) ||\r\n\t\t\t\t\t\t\t\t\t\tfalse\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\tif (sameKeyCom && sameKeyCom.tempKey) {\r\n\t\t\t\t\t\t\t\t\ttempKeys.value[sameKeyCom.tempKey] = valGroup.value[root.collectLabel.key]\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase 'date':\r\n\t\t\t\tcase 'time':\r\n\t\t\t\tcase 'monthRange':\r\n\t\t\t\t\tif (!root.key) {\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet tp = root.dateType\r\n\r\n\t\t\t\t\tconst fm: Record<string, any> = {\r\n\t\t\t\t\t\tdate: 'YYYY-MM-DD',\r\n\t\t\t\t\t\tdaterange: 'YYYY-MM-DD',\r\n\t\t\t\t\t\tdatetime: 'YYYY-MM-DD HH:mm:ss',\r\n\t\t\t\t\t\tdatetimerange: 'YYYY-MM-DD HH:mm:ss',\r\n\t\t\t\t\t\tyear: 'YYYY',\r\n\t\t\t\t\t\tmonth: 'YYYY-MM'\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (tp === 'date' || tp === 'datetime' || tp === 'time' || tp === 'year' || tp === 'month') {\r\n\t\t\t\t\t\tif (after) {\r\n\t\t\t\t\t\t\tif (tp === 'time') {\r\n\t\t\t\t\t\t\t\tvalGroup.value[root.key] = after\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tvalGroup.value[root.key] = moment(after).format(typeof root.format === 'string' ? root.format : fm[tp])\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (tp === 'date' && root.addTime) {\r\n\t\t\t\t\t\t\t\tvalGroup.value[root.key] += ' 00:00:00'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvalGroup.value[root.key] = null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (root.type === 'monthRange' || tp === 'daterange' || tp === 'datetimerange' || tp === 'timerange') {\r\n\t\t\t\t\t\tif (!root.key2) {\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (after && after[0] && after[1]) {\r\n\t\t\t\t\t\t\tif (tp === 'timerange') {\r\n\t\t\t\t\t\t\t\tvalGroup.value[root.key] = after[0]\r\n\t\t\t\t\t\t\t\tvalGroup.value[root.key2] = after[1]\r\n\t\t\t\t\t\t\t} else if (root.type === 'monthRange') {\r\n\t\t\t\t\t\t\t\tvalGroup.value[root.key] =\r\n\t\t\t\t\t\t\t\t\t(typeof root.format === 'string' && moment(after[0]).format(root.format)) || after[0]\r\n\t\t\t\t\t\t\t\tvalGroup.value[root.key2] =\r\n\t\t\t\t\t\t\t\t\t(typeof root.format === 'string' && root.format && moment(after[1]).format(root.format)) || after[1]\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tvalGroup.value[root.key] = moment(after[0]).format(root.format || (tp && fm[tp]))\r\n\t\t\t\t\t\t\t\tvalGroup.value[root.key2] = moment(after[1]).format(root.format || (tp && fm[tp]))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (tp === 'daterange' && root.addTime) {\r\n\t\t\t\t\t\t\t\tvalGroup.value[root.key] += ' 00:00:00'\r\n\t\t\t\t\t\t\t\tvalGroup.value[root.key2] += ' 23:59:59'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvalGroup.value[root.key] = null\r\n\t\t\t\t\t\t\tvalGroup.value[root.key2] = null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/*collectLabel时找出选中的选项（私有）*/\r\n\tfunction findOptions(root: FormItem, after: any) {\r\n\t\tconst o = toValue(root.options)\r\n\t\tif (!o) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (root?.multiple || root.type === 'checkboxGroup') {\r\n\t\t\tif (after) {\r\n\t\t\t\tlet t: any[] = []\r\n\t\t\t\tfor (let e of o) {\r\n\t\t\t\t\tif (after.indexOf(e?.val) !== -1) {\r\n\t\t\t\t\t\tt.push(e)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn t\r\n\t\t\t}\r\n\t\t\treturn false\r\n\t\t} else {\r\n\t\t\tif (after || after === 0 || after === false) {\r\n\t\t\t\tfor (let e of o) {\r\n\t\t\t\t\tif (e?.val === after) {\r\n\t\t\t\t\t\treturn e\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false\r\n\t\t}\r\n\t}\r\n\r\n\t/*找到需要收集的key对应的tempKey(私有)*/\r\n\tfunction findTempKey(k: string) {\r\n\t\tif (formTeam.value) {\r\n\t\t\tfor (let e of formDataT.value) {\r\n\t\t\t\tconst t = findTempKeyItem(e as FormItem[], k)\r\n\t\t\t\tif (t) {\r\n\t\t\t\t\treturn t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false\r\n\t\t}\r\n\t\treturn findTempKeyItem(formDataT.value as FormItem[], k)\r\n\t}\r\n\r\n\tfunction findTempKeyItem(d: FormItem[], k: string) {\r\n\t\tfor (let root of d) {\r\n\t\t\tif (root.key === k) {\r\n\t\t\t\treturn root.tempKey\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false\r\n\t}\r\n\r\n\t/*设置表单项的值（可添加新字段，例如添加隐藏字段，需要提交这个值，但页面不展示，公开）*/\r\n\tfunction setItemToValGroup(data: Record<string, any>, notClearOthers?: boolean) {\r\n\t\tlet t: Record<string, any> = {}\r\n\t\tfor (let k in valGroup.value) {\r\n\t\t\tif (valGroup.value.hasOwnProperty(k) && data[k] !== undefined) {\r\n\t\t\t\tt[k] = data[k]\r\n\t\t\t\tdelete data[k]\r\n\t\t\t}\r\n\t\t}\r\n\t\tupdateValGroup(t, notClearOthers)\r\n\t\tfor (let kk in data) {\r\n\t\t\t/*用Object.assign出错，只有第一次能正常合并*/\r\n\t\t\tif (data.hasOwnProperty(kk)) {\r\n\t\t\t\tif (hiddenKeys.indexOf(kk) < 0) {\r\n\t\t\t\t\thiddenKeys.push(kk)\r\n\t\t\t\t}\r\n\t\t\t\tvalGroup.value[kk] = data[kk]\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 获取需要校验的表单项的key（私有）\r\n\t * @param d 更新的数据对象\r\n\t */\r\n\tfunction getValidateKeys(d: Record<string, any>) {\r\n\t\tlet t = cloneDeep(d)\r\n\t\tif (formTeam.value) {\r\n\t\t\tlet r: any[] = []\r\n\t\t\tfor (let e of props.formData) {\r\n\t\t\t\tr.push(...getValidateItems(e as FormItem[], t))\r\n\t\t\t}\r\n\t\t\treturn r\r\n\t\t}\r\n\t\treturn getValidateItems(props.formData as FormItem[], t)\r\n\t}\r\n\r\n\t/**\r\n\t * 获取需要校验的表单项的key（私有）\r\n\t * @param a 表单结构数据\r\n\t * @param d 更新的数据对象\r\n\t */\r\n\tfunction getValidateItems(a: FormItem[], d: Record<string, any>) {\r\n\t\treturn a\r\n\t\t\t.filter((e) => {\r\n\t\t\t\tfor (let k of Object.keys(d)) {\r\n\t\t\t\t\t/*需要校验的表单项满足条件：1.在更新队列；2.没有处于隐藏状态；3.不能是手动置空的表单项；*/\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\te?.key === k &&\r\n\t\t\t\t\t\tshowingKeys.value.indexOf(k) > -1 &&\r\n\t\t\t\t\t\t!(d[k] === null || ((Array.isArray(d[k]) || myTypeof(d[k]) === 'Object') && isEmpty(d[k])))\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tdelete d[k]\r\n\t\t\t\t\t\treturn true\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false\r\n\t\t\t})\r\n\t\t\t.map((e) => e?.key)\r\n\t}\r\n\r\n\t/**\r\n\t * 更新表单项的值（只能更新已有字段，公开）\r\n\t * @param data 新数据\r\n\t * @param notClearOthers 是否清空其他表单项，默认清空\r\n\t */\r\n\tfunction updateValGroup(data: Record<string, any>, notClearOthers: boolean = false) {\r\n\t\tlet t = cloneDeep(data)\r\n\t\tupdateTempKeys(data, notClearOthers)\r\n\t\t/*先更新tempKeys再更新valGroup 避免更新同key的tempKeys元素清空valGroup元素*/\r\n\t\tfor (let k in valGroup.value) {\r\n\t\t\tif (valGroup.value.hasOwnProperty(k) && data[k] !== undefined && data[k] !== '--') {\r\n\t\t\t\tif (Array.isArray(data[k])) {\r\n\t\t\t\t\tdata[k] = data[k].filter((e: any) => e !== '--')\r\n\t\t\t\t} else if (myTypeof(data[k]) === 'Object') {\r\n\t\t\t\t\tfor (let n in data[k]) {\r\n\t\t\t\t\t\tif (data[k].hasOwnProperty(n) && data[k][n] === '--') {\r\n\t\t\t\t\t\t\tdata[k][n] = null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvalGroup.value[k] = data[k]\r\n\t\t\t} else if (!notClearOthers) {\r\n\t\t\t\tvalGroup.value[k] = Array.isArray(valGroup.value[k]) ? [] : null\r\n\t\t\t}\r\n\t\t}\r\n\t\tnextTick(function () {\r\n\t\t\tvalidateFields(getValidateKeys(t))\r\n\t\t})\r\n\t}\r\n\r\n\t/**\r\n\t * 更新未暴露表单项值（私有）\r\n\t * @param data 新数据\r\n\t * @param notClearOthers 是否清空其他表单项，默认清空\r\n\t */\r\n\tfunction updateTempKeys(data: Record<string, any>, notClearOthers: boolean = false) {\r\n\t\tif (formTeam.value) {\r\n\t\t\tfor (let t of formDataT.value) {\r\n\t\t\t\tupdateTempKeyItem(t as FormItem[], data, notClearOthers)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tupdateTempKeyItem(formDataT.value as FormItem[], data, notClearOthers)\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 更新tampKey\r\n\t * @param a 表单结构数据\r\n\t * @param d 新数据\r\n\t * @param notClearOthers 是否清空其他表单项，默认清空\r\n\t */\r\n\tfunction updateTempKeyItem(a: FormItem[], d: Record<string, any>, notClearOthers: boolean = false) {\r\n\t\tfor (let root of a) {\r\n\t\t\tif (!root.key) {\r\n\t\t\t\tcontinue\r\n\t\t\t}\r\n\t\t\tif (\r\n\t\t\t\t((notClearOthers && (d[root.key] !== undefined || (root.key2 && d[root.key2] !== undefined))) ||\r\n\t\t\t\t\t!notClearOthers) &&\r\n\t\t\t\troot.tempKey\r\n\t\t\t) {\r\n\t\t\t\tswitch (root.type) {\r\n\t\t\t\t\tcase 'inputMap':\r\n\t\t\t\t\t\tif (!root.key2) {\r\n\t\t\t\t\t\t\tcontinue\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (myTypeof(d[root.key]) === 'Number' && myTypeof(d[root.key2] === 'Number')) {\r\n\t\t\t\t\t\t\tif (root.key3) {\r\n\t\t\t\t\t\t\t\ttempKeys.value[root.tempKey] = {\r\n\t\t\t\t\t\t\t\t\tlng: d[root.key],\r\n\t\t\t\t\t\t\t\t\tlat: d[root.key2],\r\n\t\t\t\t\t\t\t\t\tname: d[root.key3]\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttempKeys.value[root.tempKey] = {\r\n\t\t\t\t\t\t\t\t\tlng: d[root.key],\r\n\t\t\t\t\t\t\t\t\tlat: d[root.key2]\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (root.key3) {\r\n\t\t\t\t\t\t\t\ttempKeys.value[root.tempKey] = {\r\n\t\t\t\t\t\t\t\t\tlng: null,\r\n\t\t\t\t\t\t\t\t\tlat: null,\r\n\t\t\t\t\t\t\t\t\tname: null\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttempKeys.value[root.tempKey] = {\r\n\t\t\t\t\t\t\t\t\tlng: null,\r\n\t\t\t\t\t\t\t\t\tlat: null\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\tcase 'input':\r\n\t\t\t\t\tcase 'inputNumber':\r\n\t\t\t\t\tcase 'textarea':\r\n\t\t\t\t\t\tif ((d[root.key] && d[root.key] !== '--') || d[root.key] === 0) {\r\n\t\t\t\t\t\t\ttempKeys.value[root.tempKey] = d[root.key]\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttempKeys.value[root.tempKey] = null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\tcase 'select':\r\n\t\t\t\t\tcase 'radioGroup':\r\n\t\t\t\t\tcase 'checkboxGroup':\r\n\t\t\t\t\t\tif ((d[root.key] && d[root.key] !== '--') || d[root.key] === 0 || d[root.key] === false) {\r\n\t\t\t\t\t\t\tif (root.multiple || root.type === 'checkboxGroup') {\r\n\t\t\t\t\t\t\t\ttempKeys.value[root.tempKey] = [...d[root.key]]\r\n\t\t\t\t\t\t\t} else if (root.booleanVal) {\r\n\t\t\t\t\t\t\t\ttempKeys.value[root.tempKey] = Boolean(d[root.key]) ? 1 : 0\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttempKeys.value[root.tempKey] = d[root.key]\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (root.multiple || root.type === 'checkboxGroup') {\r\n\t\t\t\t\t\t\t\t/*当notClearOthers为false时用来清空*/\r\n\t\t\t\t\t\t\t\ttempKeys.value[root.tempKey] = []\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttempKeys.value[root.tempKey] = null\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\tcase 'date':\r\n\t\t\t\t\tcase 'time':\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\troot.dateType === 'date' ||\r\n\t\t\t\t\t\t\troot.dateType === 'datetime' ||\r\n\t\t\t\t\t\t\troot.dateType === 'year' ||\r\n\t\t\t\t\t\t\troot.dateType === 'month' ||\r\n\t\t\t\t\t\t\troot.dateType === 'time'\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\ttempKeys.value[root.tempKey] = d[root.key] && d[root.key] !== '--' ? d[root.key] : null\r\n\t\t\t\t\t\t} else if (\r\n\t\t\t\t\t\t\troot.dateType === 'daterange' ||\r\n\t\t\t\t\t\t\troot.dateType === 'datetimerange' ||\r\n\t\t\t\t\t\t\troot.dateType === 'timerange'\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tif (!root.key2) {\r\n\t\t\t\t\t\t\t\tcontinue\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttempKeys.value[root.tempKey] =\r\n\t\t\t\t\t\t\t\t(d[root.key] &&\r\n\t\t\t\t\t\t\t\t\td[root.key] !== '--' &&\r\n\t\t\t\t\t\t\t\t\td[root.key2] &&\r\n\t\t\t\t\t\t\t\t\td[root.key2] !== '--' && [d[root.key], d[root.key2]]) ||\r\n\t\t\t\t\t\t\t\t[]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 更新表单结构，例如设置或取消禁用,或者给type为txt的表单项（没有key）赋值（公开）；\r\n\t * @param {Object|Array} d 为对象（改变单个）或数组（改变多个），支持的属性：index（必填）-需要改变的formData项的索引值、\r\n\t * indexB-当表单为`分组表单`时必填（表示表单项的二位数组索引第二位）、需要改变的属性，如要改变第二个表单组件的label和title,\r\n\t * 则为:{index:1,label:XXX,title:XXX}\r\n\t */\r\n\tfunction updateFormDataT(d: Record<string, any> | Record<string, any>[]) {\r\n\t\tif (Array.isArray(d)) {\r\n\t\t\tfor (let e of d) {\r\n\t\t\t\tchangeDataHandle(e)\r\n\t\t\t}\r\n\t\t} else if (myTypeof(d) === 'Object') {\r\n\t\t\tchangeDataHandle(d)\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 改变表单结构（私有）\r\n\t * @param d 同updateFormDataT的 d\r\n\t */\r\n\tfunction changeDataHandle(d: Record<string, any>) {\r\n\t\tconst { index, indexB, key, val } = d\r\n\t\tif (typeof index !== 'number') {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (Array.isArray(formDataT.value[index])) {\r\n\t\t\tif (typeof indexB === 'number') {\r\n\t\t\t\tif (key && d.hasOwnProperty('val')) {\r\n\t\t\t\t\tformDataT.value[index][indexB][key] = val\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor (let k of Object.keys(d)) {\r\n\t\t\t\t\t\tif (k !== 'index' && key !== 'indexB') {\r\n\t\t\t\t\t\t\tformDataT.value[index][indexB][k] = d[k]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (key && d.hasOwnProperty('val')) {\r\n\t\t\t\tformDataT.value[index][key] = val\r\n\t\t\t} else {\r\n\t\t\t\tfor (let k of Object.keys(d)) {\r\n\t\t\t\t\tif (k !== 'index') {\r\n\t\t\t\t\t\tformDataT.value[index][k] = d[k]\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/*更新远程数据级联名称（私有）*/\r\n\tfunction asyncLabelChange({ label, root }: { label: string; root: FormItem }) {\r\n\t\tif (root.key2) {\r\n\t\t\tvalGroup.value[root.key2] = label\r\n\t\t}\r\n\t\titemChange({\r\n\t\t\te: label,\r\n\t\t\troot\r\n\t\t})\r\n\t}\r\n\r\n\t/*更新选择输入框值（私有）*/\r\n\tfunction onSelectInputChange(d: any) {\r\n\t\tif (d.beforeKey) {\r\n\t\t\tremove(selectInputKeys, (o) => o === d.beforeKey)\r\n\t\t}\r\n\t\tif (d.key) {\r\n\t\t\tif (selectInputKeys.indexOf(d.key) === -1) {\r\n\t\t\t\tselectInputKeys.push(d.key)\r\n\t\t\t}\r\n\t\t\titemChange({\r\n\t\t\t\te: null,\r\n\t\t\t\troot: d\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t/*更新行政区域名称（私有）*/\r\n\tfunction alNameChange({ name, root }: { name: string; root: FormItem }) {\r\n\t\tif (root.key2) {\r\n\t\t\tvalGroup.value[root.key2] = name\r\n\t\t}\r\n\t\titemChange({\r\n\t\t\te: name,\r\n\t\t\troot\r\n\t\t})\r\n\t}\r\n\r\n\t/**\r\n\t * 重新校验（私有）\r\n\t * @param e 事件的$event对象，一般是组件change事件的值\r\n\t * @param root 表单项结构数据\r\n\t */\r\n\tfunction reValidateAndChangeHandle({ e, root }: { e: any; root: FormItem }) {\r\n\t\titemChange({\r\n\t\t\te: e,\r\n\t\t\troot\r\n\t\t})\r\n\t\tnextTick(function () {\r\n\t\t\tformGroupXRef.value?.validateField?.(root.key)\r\n\t\t})\r\n\t}\r\n\r\n\t/**\r\n\t * 表单项值更新（私有）\r\n\t * @param e 事件的$event对象，一般是组件change事件的值\r\n\t * @param root 表单项结构数据\r\n\t */\r\n\tfunction itemChange({ e, root }: { e: any; root: FormItem }) {\r\n\t\tsetTimeout(() => {\r\n\t\t\tlet d: Record<string, any> = {\r\n\t\t\t\tevent: e\r\n\t\t\t}\r\n\t\t\tif (root.key) {\r\n\t\t\t\td[root.key] = valGroup.value[root.key]\r\n\t\t\t}\r\n\t\t\tif (root.key2) {\r\n\t\t\t\td[root.key2] = valGroup.value[root.key2]\r\n\t\t\t}\r\n\t\t\tif (Array.isArray(root.collectLabel)) {\r\n\t\t\t\tfor (let l of root.collectLabel) {\r\n\t\t\t\t\td[l.key] = valGroup.value[l.key]\r\n\t\t\t\t}\r\n\t\t\t} else if (root.collectLabel && root.collectLabel.key) {\r\n\t\t\t\td[root.collectLabel.key] = valGroup.value[root.collectLabel.key]\r\n\t\t\t}\r\n\t\t\temit('on-item-change', d)\r\n\t\t}, 300)\r\n\t}\r\n\r\n\t/**\r\n\t * 获取需要提交的数据(私有)\r\n\t */\r\n\tfunction getValGroup() {\r\n\t\tlet t: Record<string, any> = {}\r\n\t\tfor (let e of submitKeys.value) {\r\n\t\t\tt[e] = valGroup.value[e]\r\n\t\t}\r\n\t\tif (props.trim) {\r\n\t\t\tt = trimObj(t)\r\n\t\t}\r\n\t\treturn t\r\n\t}\r\n\r\n\t/*主动验证整个表单（公开）*/\r\n\tfunction validate() {\r\n\t\tformGroupXRef.value?.validate?.()\r\n\t}\r\n\r\n\t/**\r\n\t * 手动验证表单项（公开）\r\n\t * @param prop 需要校验的表单项(rules中对应的key)\r\n\t */\r\n\tfunction reValidate(prop: any) {\r\n\t\tsetTimeout(() => {\r\n\t\t\tformGroupXRef.value?.validateField?.(prop, () => {})\r\n\t\t}, 10)\r\n\t}\r\n\r\n\t/**\r\n\t * 批量校验部分表单\r\n\t * @param {Array} props 需要校验的表单prop集合\r\n\t */\r\n\tfunction validateFields(props: any[]) {\r\n\t\tsetTimeout(() => {\r\n\t\t\tif (Array.isArray(props)) {\r\n\t\t\t\tfor (let e of props) {\r\n\t\t\t\t\tformGroupXRef.value?.validateField?.(e, () => {})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}, 10)\r\n\t}\r\n\r\n\t/*主动改变表单按钮loading状态（在开启btnLoading的前提下，公开）*/\r\n\tfunction changeLoading(v: any) {\r\n\t\tif (v === undefined) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tshowLoading.value = Boolean(v)\r\n\t}\r\n\r\n\t/*触发提交事件（一般不需要调用，会通过插件内部提交按钮触发，公开）*/\r\n\tfunction submit() {\r\n\t\tif (props.disabled) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tformGroupXRef.value?.validate?.((valid: any) => {\r\n\t\t\tif (!debounceCount) {\r\n\t\t\t\tdebounceCount = true\r\n\t\t\t\tif (valid) {\r\n\t\t\t\t\tshowLoading.value = true\r\n\r\n\t\t\t\t\temit('on-submit', getValGroup())\r\n\t\t\t\t}\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tdebounceCount = false\r\n\t\t\t\t}, 2000)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tonMounted(() => {\r\n\t\tinitValGroup()\r\n\t\tinitFormDataT()\r\n\t})\r\n\r\n\tdefineExpose({\r\n\t\tresetForm,\r\n\t\trefreshFormDom,\r\n\t\treRenderForm,\r\n\t\tsetItemToValGroup,\r\n\t\tupdateValGroup,\r\n\t\tupdateFormDataT,\r\n\t\tvalidate,\r\n\t\treValidate,\r\n\t\tchangeLoading,\r\n\t\tgetValGroup,\r\n\t\tsubmit\r\n\t})\r\n</script>\r\n\r\n<template>\r\n\t<Form\r\n\t\tref=\"formGroupXRef\"\r\n\t\t:model=\"valGroup\"\r\n\t\t:rules=\"formRulesT\"\r\n\t\t:label-width=\"props.labelWidth\"\r\n\t\t:inline=\"props.inline\"\r\n\t\t:show-message=\"props.showMessage\"\r\n\t\tclass=\"formXN\"\r\n\t\t:key=\"formReRenderKey\"\r\n\t>\r\n\t\t<!--解决form只有一个input时enter触发页面刷新的问题-->\r\n\t\t<FormItem style=\"display: none\"><input type=\"text\" /></FormItem>\r\n\t\t<div v-for=\"(box, n) of formDataT\" v-if=\"formTeam\" :class=\"[teamClass, 'formTeamBox' + n]\" :key=\"'formTeamBox' + n\">\r\n\t\t\t<template v-for=\"(item, i) of box\" :key=\"'formItem' + i\">\r\n\t\t\t\t<item-r\r\n\t\t\t\t\t:item=\"item\"\r\n\t\t\t\t\tv-if=\"getFormItemIfVal(item)\"\r\n\t\t\t\t\t:style=\"formStyle\"\r\n\t\t\t\t\t:item-style=\"itemStyle\"\r\n\t\t\t\t\t:val-group=\"valGroup\"\r\n\t\t\t\t\t:temp-keys=\"tempKeys\"\r\n\t\t\t\t\t:inline=\"props.inline\"\r\n\t\t\t\t\t:disabled=\"props.disabled\"\r\n\t\t\t\t\t:label-width=\"props.labelWidth\"\r\n\t\t\t\t\t:item-width=\"props.itemWidth\"\r\n\t\t\t\t\t:mgr-url=\"mgrUrl\"\r\n\t\t\t\t\t:upload-url=\"uploadUrl\"\r\n\t\t\t\t\t@item-change=\"itemChange\"\r\n\t\t\t\t\t@re-validate=\"reValidateAndChangeHandle\"\r\n\t\t\t\t\t@clear-temp-key-item=\"clearTempKeyItem\"\r\n\t\t\t\t\t@select-input-change=\"onSelectInputChange\"\r\n\t\t\t\t\t@al-name-change=\"alNameChange\"\r\n\t\t\t\t\t@async-label-change=\"asyncLabelChange\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<template #[s.slotName]=\"slotProps\" v-for=\"s in getSlotFormData(box)\">\r\n\t\t\t\t\t\t<slot :name=\"s.slotName\" :val-group=\"slotProps.valGroup\" />\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</item-r>\r\n\t\t\t</template>\r\n\t\t</div>\r\n\t\t<template v-for=\"(item, i) of formDataT\" :key=\"'formItem' + i\">\r\n\t\t\t<item-r\r\n\t\t\t\t:item=\"item\"\r\n\t\t\t\tv-if=\"!formTeam && getFormItemIfVal(item)\"\r\n\t\t\t\t:style=\"formStyle\"\r\n\t\t\t\t:item-style=\"itemStyle\"\r\n\t\t\t\t:val-group=\"valGroup\"\r\n\t\t\t\t:temp-keys=\"tempKeys\"\r\n\t\t\t\t:inline=\"props.inline\"\r\n\t\t\t\t:disabled=\"props.disabled\"\r\n\t\t\t\t:label-width=\"props.labelWidth\"\r\n\t\t\t\t:item-width=\"props.itemWidth\"\r\n\t\t\t\t:mgr-url=\"mgrUrl\"\r\n\t\t\t\t:upload-url=\"uploadUrl\"\r\n\t\t\t\t@item-change=\"itemChange\"\r\n\t\t\t\t@re-validate=\"reValidateAndChangeHandle\"\r\n\t\t\t\t@clear-temp-key-item=\"clearTempKeyItem\"\r\n\t\t\t\t@select-input-change=\"onSelectInputChange\"\r\n\t\t\t\t@al-name-change=\"alNameChange\"\r\n\t\t\t\t@async-label-change=\"asyncLabelChange\"\r\n\t\t\t>\r\n\t\t\t\t<template #[s.slotName]=\"slotProps\" v-for=\"s in getSlotFormData(formData)\">\r\n\t\t\t\t\t<slot :name=\"s.slotName\" :val-group=\"slotProps.valGroup\" />\r\n\t\t\t\t</template>\r\n\t\t\t</item-r>\r\n\t\t</template>\r\n\t\t<!--长提交按钮-->\r\n\t\t<FormItem v-if=\"props.showLongOkBt\">\r\n\t\t\t<!--suppress HtmlWrongAttributeValue -->\r\n\t\t\t<Button\r\n\t\t\t\t@click=\"submit\"\r\n\t\t\t\t:style=\"itemStyle\"\r\n\t\t\t\ttype=\"primary\"\r\n\t\t\t\t:loading=\"props.btnLoading && showLoading\"\r\n\t\t\t\t:disabled=\"props.disabled\"\r\n\t\t\t\t>{{ props.longOkBtTxt || t('r.confirm') }}\r\n\t\t\t</Button>\r\n\t\t</FormItem>\r\n\t\t<div class=\"inlineBlock\">\r\n\t\t\t<!--短提交按钮（查询）-->\r\n\t\t\t<!--suppress HtmlWrongAttributeValue -->\r\n\t\t\t<Button\r\n\t\t\t\tv-if=\"props.showInlineOkBt\"\r\n\t\t\t\ttype=\"primary\"\r\n\t\t\t\t:class=\"{ inlineFormBtXN: props.inline, okBtnXN: true }\"\r\n\t\t\t\t@click=\"submit\"\r\n\t\t\t\t:loading=\"props.btnLoading && showLoading\"\r\n\t\t\t\t:disabled=\"props.disabled\"\r\n\t\t\t\t>{{ props.inlineOkBtTxt || t('r.confirm') }}\r\n\t\t\t</Button>\r\n\t\t\t<!--取消按钮（清除）-->\r\n\t\t\t<!--suppress HtmlWrongAttributeValue -->\r\n\t\t\t<Button v-if=\"props.showInlineClearBt\" @click=\"resetForm\" :class=\"{ inlineFormBtXN: props.inline }\" type=\"dashed\"\r\n\t\t\t\t>{{ props.inlineClearBtTxt || t('r.clear') }}\r\n\t\t\t</Button>\r\n\t\t</div>\r\n\t</Form>\r\n</template>\r\n","<!--FormGroup 表单群组件，表单相关用法参考FormR,组件自带确定和取消按钮\r\n@created 2023.08.30\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script lang=\"ts\" setup>\r\n\timport FormR from '../FormR/FormR.vue'\r\n\timport t from '../../locale/i18nSFC'\r\n\timport { setTimeout } from '../../utils/timer'\r\n\timport type { FormItem } from '../../public'\r\n\timport Proxy from '../../utils/proxy'\r\n\r\n\tconst emit = defineEmits(['on-cancel'])\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\tformData?: Array<FormItem | FormItem[]>\r\n\t\t\twith?: string\r\n\t\t\tlabelWidth?: number\r\n\t\t\tcontentWidth?: string\r\n\t\t\titemWidth?: number\r\n\t\t\tshowOkBt?: boolean\r\n\t\t\tshowCancelBt?: boolean\r\n\t\t\tokBtTxt?: string\r\n\t\t\tcancelBtTxt?: string\r\n\t\t\tbtnLoading?: boolean\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\tformData: () => [],\r\n\t\t\twith: () => Proxy().formGroupWidth,\r\n\t\t\tlabelWidth: () => Proxy().formGroupLabelWidth,\r\n\t\t\tcontentWidth: '70%',\r\n\t\t\titemWidth: 200,\r\n\t\t\tshowOkBt: true,\r\n\t\t\tshowCancelBt: true,\r\n\t\t\tbtnLoading: false\r\n\t\t}\r\n\t)\r\n\r\n\tconst formGroupStyle = ref({ width: props.with })\r\n\tconst showLoading = ref(false)\r\n\tconst formRRef = ref()\r\n\tconst formDataC = computed(() => {\r\n\t\tif (Array.isArray(props.formData)) {\r\n\t\t\tif (Array.isArray(props.formData[0])) {\r\n\t\t\t\tlet t: any[] = []\r\n\t\t\t\tfor (let f of props.formData) {\r\n\t\t\t\t\tif (!f) {\r\n\t\t\t\t\t\tcontinue\r\n\t\t\t\t\t}\r\n\t\t\t\t\tt = t.concat(\r\n\t\t\t\t\t\tf.filter((e: any) => e?.type === 'custom' || (e?.type === 'input' && e.slotName && e.slotPosition))\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t\treturn t\r\n\t\t\t} else {\r\n\t\t\t\treturn props.formData?.filter?.(\r\n\t\t\t\t\t(e: any) => e?.type === 'custom' || (e?.type === 'input' && e.slotName && e.slotPosition)\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn []\r\n\t})\r\n\r\n\tfunction resetForm() {\r\n\t\t/*重置表单，会清空表单值并刷新表单dom，异步方法，公开*/\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tformRRef.value.resetForm?.().then((r: any) => {\r\n\t\t\t\tresolve(r)\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\tfunction refreshFormDom() {\r\n\t\t/*刷新表单dom，公开*/\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tformRRef.value.refreshFormDom?.().then((r: any) => {\r\n\t\t\t\tresolve(r)\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\tfunction reRenderForm() {\r\n\t\t/*重新渲染表单，异步方法（公开）*/\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tformRRef.value.reRenderForm?.().then((r: any) => {\r\n\t\t\t\tresolve(r)\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\tfunction setItemToValGroup(data: Record<string, any>, notClearOthers: boolean) {\r\n\t\t/*设置表单项的值（可添加新字段，例如添加隐藏字段，需要提交这个值，但页面不展示），公开*/\r\n\t\tformRRef.value.setItemToValGroup?.(data, notClearOthers)\r\n\t}\r\n\r\n\tfunction updateValGroup(data: Record<string, any>, notClearOthers: boolean) {\r\n\t\t/*更新表单项的值（只能更新已有字段），公开*/\r\n\t\tformRRef.value.updateValGroup?.(data, notClearOthers)\r\n\t}\r\n\r\n\tfunction updateFormDataT(data: Record<string, any> | Record<string, any>[]) {\r\n\t\t/*更新表单结构，例如设置或取消禁用，公开*/\r\n\t\tformRRef.value.updateFormDataT?.(data)\r\n\t}\r\n\r\n\tfunction validate() {\r\n\t\t/*验证表单，公开*/\r\n\t\tformRRef.value.validate?.()\r\n\t}\r\n\r\n\tfunction reValidate(prop: any) {\r\n\t\t/*手动验证表单项（公开）*/\r\n\t\tformRRef.value.reValidate?.(prop)\r\n\t}\r\n\r\n\tfunction changeLoading(val: any) {\r\n\t\t/*改变确定按钮loading状态，私有*/\r\n\t\tif (val === undefined) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tshowLoading.value = Boolean(val)\r\n\t\tformRRef.value.changeLoading?.(showLoading.value)\r\n\t}\r\n\r\n\tfunction getValGroup() {\r\n\t\t/*获取用户已填数据，公开*/\r\n\t\treturn formRRef.value.getValGroup?.()\r\n\t}\r\n\r\n\tfunction onSubmit() {\r\n\t\t/*响应提交事件提交数据，私有*/\r\n\t\tshowLoading.value = true\r\n\t}\r\n\r\n\tfunction submit() {\r\n\t\t/*触发提交事件，公开*/\r\n\t\tformRRef.value.submit?.()\r\n\t}\r\n\r\n\tfunction close() {\r\n\t\t/*触发取消按钮点击事件，公开*/\r\n\t\temit('on-cancel')\r\n\t\tsetTimeout(() => {\r\n\t\t\tshowLoading.value = false\r\n\t\t\tformRRef.value.changeLoading?.(false)\r\n\t\t}, 1000)\r\n\t}\r\n\r\n\tdefineExpose({\r\n\t\tresetForm,\r\n\t\trefreshFormDom,\r\n\t\treRenderForm,\r\n\t\tsetItemToValGroup,\r\n\t\tupdateValGroup,\r\n\t\tupdateFormDataT,\r\n\t\tvalidate,\r\n\t\treValidate,\r\n\t\tchangeLoading,\r\n\t\tgetValGroup,\r\n\t\tsubmit,\r\n\t\tclose\r\n\t})\r\n</script>\r\n\r\n<template>\r\n\t<div :style=\"formGroupStyle\" class=\"formGroupBoxVM\">\r\n\t\t<form-r\r\n\t\t\tref=\"formRRef\"\r\n\t\t\tv-bind=\"$attrs\"\r\n\t\t\t:form-data=\"props.formData\"\r\n\t\t\t:label-width=\"props.labelWidth\"\r\n\t\t\t:content-width=\"props.contentWidth\"\r\n\t\t\t:item-width=\"props.itemWidth\"\r\n\t\t\t:btnLoading=\"props.btnLoading\"\r\n\t\t\t@on-submit=\"onSubmit\"\r\n\t\t>\r\n\t\t\t<template #[item.slotName]=\"{ valGroup }\" v-for=\"item in formDataC\">\r\n\t\t\t\t<slot :name=\"item.slotName\" :val-group=\"valGroup\" />\r\n\t\t\t</template>\r\n\t\t</form-r>\r\n\t\t<div\r\n\t\t\tclass=\"formFooterVM\"\r\n\t\t\tv-show=\"props.showOkBt || props.showCancelBt\"\r\n\t\t\t:style=\"{ marginLeft: props.labelWidth + 'px' }\"\r\n\t\t>\r\n\t\t\t<div :style=\"{ width: props.contentWidth }\" class=\"btnBoxKAL\">\r\n\t\t\t\t<Button\r\n\t\t\t\t\t@click=\"submit\"\r\n\t\t\t\t\tclass=\"form-save-btn\"\r\n\t\t\t\t\tv-if=\"props.showOkBt\"\r\n\t\t\t\t\t:loading=\"props.btnLoading && showLoading\"\r\n\t\t\t\t\t>{{ props.okBtTxt || t('r.confirm') }}</Button\r\n\t\t\t\t>\r\n\t\t\t\t<Button @click=\"close\" class=\"form-cancel-btn\" v-if=\"props.showCancelBt\">{{\r\n\t\t\t\t\tprops.cancelBtTxt || t('r.cancel')\r\n\t\t\t\t}}</Button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n","<!--SearchForm 页面条件查询表单（行内）组件，一般配合btTablePage组件使用，自带查询按钮和清空按钮，用户只需要监听on-search事件取得表单采集的数据进行处理即可\r\n@created 2023.08.31\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script lang=\"ts\" setup>\r\n\timport FormR from '../FormR/FormR.vue'\r\n\timport t from '../../locale/i18nSFC'\r\n\timport Proxy from '../../utils/proxy'\r\n\timport type { FormItem } from '../../public'\r\n\r\n\tconst emit = defineEmits(['on-search'])\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\tformData?: Array<FormItem | FormItem[]> /*搜索表单结构数据*/\r\n\t\t\tlabelWidth?: number /*表单项标签宽度*/\r\n\t\t\titemWidth?: number /*表单项内容宽度,用于行内表单*/\r\n\t\t\tshowInlineOkBt?: boolean /*显示搜索按钮*/\r\n\t\t\tshowInlineClearBt?: boolean /*显示清空按钮*/\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\tformData: () => [],\r\n\t\t\tlabelWidth: () => Proxy().searchFormLabelWidth,\r\n\t\t\titemWidth: () => Proxy().searchFormItemWidth,\r\n\t\t\tshowInlineOkBt: true,\r\n\t\t\tshowInlineClearBt: true\r\n\t\t}\r\n\t)\r\n\r\n\tconst formRRef = ref()\r\n\r\n\tconst formDataC = computed(() => {\r\n\t\tif (Array.isArray(props.formData[0])) {\r\n\t\t\tlet t: any[] = []\r\n\t\t\tfor (let f of props.formData) {\r\n\t\t\t\tif (!f) {\r\n\t\t\t\t\tcontinue\r\n\t\t\t\t}\r\n\t\t\t\tt = t.concat(\r\n\t\t\t\t\tf.filter((e: any) => e?.type === 'custom' || (e?.type === 'input' && e.slotName && e.slotPosition))\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\treturn t\r\n\t\t}\r\n\t\treturn props.formData?.filter?.(\r\n\t\t\t(e: any) => e?.type === 'custom' || (e?.type === 'input' && e.slotName && e.slotPosition)\r\n\t\t)\r\n\t})\r\n\r\n\tfunction resetForm() {\r\n\t\t/*重置表单，会清空表单值并刷新表单dom，异步方法，公开*/\r\n\t\treturn new Promise((resolve: any) => {\r\n\t\t\tformRRef.value.resetForm?.().then(() => {\r\n\t\t\t\tresolve()\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\tfunction refreshFormDom() {\r\n\t\t/*刷新表单dom，公开*/\r\n\t\treturn new Promise((resolve: any) => {\r\n\t\t\tformRRef.value.refreshFormDom?.().then(() => {\r\n\t\t\t\tresolve()\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\tfunction reRenderForm() {\r\n\t\t/*重新渲染表单，异步方法（公开）*/\r\n\t\treturn new Promise((resolve: any) => {\r\n\t\t\tformRRef.value.reRenderForm?.().then(() => {\r\n\t\t\t\tresolve()\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\tfunction setItemToValGroup(data: Record<string, any>, notClearOthers: boolean) {\r\n\t\t/*设置表单项的值（可添加新字段，例如添加隐藏字段，需要提交这个值，但页面不展示），公开*/\r\n\t\tformRRef.value.setItemToValGroup?.(data, notClearOthers)\r\n\t}\r\n\r\n\tfunction updateValGroup(data: Record<string, any>, notClearOthers: boolean) {\r\n\t\t/*更新表单项的值（只能更新已有字段），公开*/\r\n\t\tformRRef.value.updateValGroup?.(data, notClearOthers)\r\n\t}\r\n\r\n\tfunction updateFormDataT(data: Record<string, any> | Record<string, any>[]) {\r\n\t\t/*更新表单结构，例如设置或取消禁用，公开*/\r\n\t\tformRRef.value.updateFormDataT?.(data)\r\n\t}\r\n\r\n\tfunction validate() {\r\n\t\t/*验证表单，公开*/\r\n\t\tformRRef.value.validate?.()\r\n\t}\r\n\r\n\tfunction reValidate(prop: any) {\r\n\t\t/*手动验证表单项（公开）*/\r\n\t\tformRRef.value.reValidate?.(prop)\r\n\t}\r\n\r\n\tfunction changeLoading(val: any) {\r\n\t\t/*改变弹框loading状态，私有*/\r\n\t\tformRRef.value.changeLoading?.(val === undefined ? false : val)\r\n\t}\r\n\r\n\tfunction getValGroup() {\r\n\t\t/*获取用户已填数据，公开*/\r\n\t\treturn formRRef.value.getValGroup?.()\r\n\t}\r\n\r\n\tfunction onSubmit(data: any) {\r\n\t\t/*响应提交事件提交数据，私有*/\r\n\t\temit('on-search', data)\r\n\t}\r\n\r\n\tfunction submit() {\r\n\t\t/*触发提交事件，公开*/\r\n\t\tformRRef.value.submit?.()\r\n\t}\r\n\r\n\tonMounted(() => {\r\n\t\tconst el = formRRef.value.$el\r\n\t\tif (el?.parentNode) {\r\n\t\t\tel.parentNode.addEventListener('keyup', (e: any) => {\r\n\t\t\t\tif (e?.keyCode === 13) {\r\n\t\t\t\t\t//回车\r\n\t\t\t\t\tsubmit()\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t})\r\n\r\n\tdefineExpose({\r\n\t\tresetForm,\r\n\t\trefreshFormDom,\r\n\t\treRenderForm,\r\n\t\tsetItemToValGroup,\r\n\t\tupdateValGroup,\r\n\t\tupdateFormDataT,\r\n\t\tvalidate,\r\n\t\treValidate,\r\n\t\tchangeLoading,\r\n\t\tgetValGroup,\r\n\t\tsubmit\r\n\t})\r\n</script>\r\n\r\n<template>\r\n\t<form-r\r\n\t\tref=\"formRRef\"\r\n\t\tv-bind=\"$attrs\"\r\n\t\t:form-data=\"props.formData\"\r\n\t\t:label-width=\"props.labelWidth\"\r\n\t\t:item-width=\"props.itemWidth\"\r\n\t\tinline\r\n\t\t:show-long-ok-bt=\"false\"\r\n\t\t:show-inline-ok-bt=\"props.showInlineOkBt\"\r\n\t\t:inline-ok-bt-txt=\"t('r.check')\"\r\n\t\t:show-inline-clear-bt=\"props.showInlineClearBt\"\r\n\t\t:show-message=\"false\"\r\n\t\t@on-submit=\"onSubmit\"\r\n\t>\r\n\t\t<template #[item.slotName]=\"{ valGroup }\" v-for=\"item in formDataC\">\r\n\t\t\t<slot :name=\"item.slotName\" :val-group=\"valGroup\" />\r\n\t\t</template>\r\n\t</form-r>\r\n</template>\r\n","<!--FormModal 表单和弹框的组合组件，表单相关用法参考FormR，弹框支持调用方法开关，通过属性配置等，常被当作新增、编辑弹框使用\r\n@created 2023.08.31\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script lang=\"ts\" setup>\r\n\timport t from '../../locale/i18nSFC'\r\n\timport Proxy from '../../utils/proxy'\r\n\timport { setTimeout } from '../../utils/timer'\r\n\timport FormR from '../FormR/FormR.vue'\r\n\timport type { FormItem } from '../../public'\r\n\r\n\tconst emit = defineEmits(['on-close', 'on-open'])\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\ttitle?: string /*弹框标题*/\r\n\t\t\tformData?: Array<FormItem | FormItem[]> /*弹框结构数据*/\r\n\t\t\twidth?: number | string /*弹框宽度*/\r\n\t\t\tlabelWidth?: number /*表单项标签宽度*/\r\n\t\t\tokBtTxt?: string /*确定按钮内容*/\r\n\t\t\tcancelBtTxt?: string /*取消按钮内容*/\r\n\t\t\thideCancelBt?: boolean /*隐藏取消按钮（只显示确定按钮，点击确定关闭弹框，如“查看”弹框）*/\r\n\t\t\thideFooter?: boolean /*隐藏底栏*/\r\n\t\t\tbtnLoading?: boolean /*提交按钮显示loading*/\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\tformData: () => [],\r\n\t\t\twidth: () => Proxy().formModalWidth,\r\n\t\t\tlabelWidth: () => Proxy().formModalLabelWidth,\r\n\t\t\thideCancelBt: false,\r\n\t\t\thideFooter: false,\r\n\t\t\tbtnLoading: false\r\n\t\t}\r\n\t)\r\n\r\n\tconst formRRef = ref()\r\n\tconst openModal = ref(false)\r\n\tconst showLoading = ref(false)\r\n\r\n\tconst formDataC = computed(() => {\r\n\t\tif (Array.isArray(props.formData[0])) {\r\n\t\t\tlet t: any[] = []\r\n\t\t\tfor (let f of props.formData) {\r\n\t\t\t\tif (!f) {\r\n\t\t\t\t\tcontinue\r\n\t\t\t\t}\r\n\t\t\t\tt = t.concat(\r\n\t\t\t\t\tf.filter((e: any) => e?.type === 'custom' || (e?.type === 'input' && e.slotName && e.slotPosition))\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\treturn t\r\n\t\t}\r\n\t\treturn props.formData?.filter?.(\r\n\t\t\t(e: any) => e?.type === 'custom' || (e?.type === 'input' && e.slotName && e.slotPosition)\r\n\t\t)\r\n\t})\r\n\r\n\tfunction resetForm() {\r\n\t\t/*重置表单，会清空表单值并刷新表单dom，异步方法，公开*/\r\n\t\treturn new Promise((resolve: any) => {\r\n\t\t\tformRRef.value.resetForm?.().then(() => {\r\n\t\t\t\tresolve()\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\tfunction refreshFormDom() {\r\n\t\t/*刷新表单dom，公开*/\r\n\t\treturn new Promise((resolve: any) => {\r\n\t\t\tformRRef.value.refreshFormDom?.().then(() => {\r\n\t\t\t\tresolve()\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\tfunction reRenderForm() {\r\n\t\t/*重新渲染表单，异步方法（公开）*/\r\n\t\treturn new Promise((resolve: any) => {\r\n\t\t\tformRRef.value.reRenderForm?.().then(() => {\r\n\t\t\t\tresolve()\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\tfunction setItemToValGroup(data: Record<string, any>, notClearOthers: boolean) {\r\n\t\t/*设置表单项的值（公开，可添加新字段，例如添加隐藏字段，需要提交这个值，但页面不展示）*/\r\n\t\tformRRef.value.setItemToValGroup?.(data, notClearOthers)\r\n\t}\r\n\r\n\tfunction updateValGroup(data: Record<string, any>, notClearOthers: boolean) {\r\n\t\t/*更新表单项的值（公开，只能更新已有字段）*/\r\n\t\tformRRef.value.updateValGroup?.(data, notClearOthers)\r\n\t}\r\n\r\n\tfunction updateFormDataT(data: Record<string, any> | Record<string, any>[]) {\r\n\t\t/*更新表单结构，例如设置或取消禁用，公开*/\r\n\t\tformRRef.value.updateFormDataT?.(data)\r\n\t}\r\n\r\n\tfunction validate() {\r\n\t\t/*验证表单，公开*/\r\n\t\tformRRef.value.validate?.()\r\n\t}\r\n\r\n\tfunction reValidate(prop: any) {\r\n\t\t/*手动验证表单项（公开）*/\r\n\t\tformRRef.value.reValidate?.(prop)\r\n\t}\r\n\r\n\tfunction changeLoading(val: any) {\r\n\t\t/*改变弹框loading状态，私有*/\r\n\t\tif (val === undefined) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tshowLoading.value = Boolean(val)\r\n\t\tformRRef.value.changeLoading?.(showLoading.value)\r\n\t}\r\n\r\n\tfunction getValGroup() {\r\n\t\t/*获取用户已填数据，公开*/\r\n\t\treturn formRRef.value.getValGroup?.()\r\n\t}\r\n\r\n\tfunction onSubmit() {\r\n\t\t/*响应提交事件提交数据，私有*/\r\n\t\tshowLoading.value = true\r\n\t}\r\n\r\n\tfunction submit() {\r\n\t\t/*触发提交事件，公开*/\r\n\t\tif (props.hideCancelBt) {\r\n\t\t\tclose()\r\n\t\t} else {\r\n\t\t\tformRRef.value.submit?.()\r\n\t\t}\r\n\t}\r\n\r\n\tfunction open() {\r\n\t\t/*触发打开弹框事件，公开*/\r\n\t\topenModal.value = true\r\n\t}\r\n\r\n\tfunction close() {\r\n\t\t/*触发关闭弹框事件，公开*/\r\n\t\topenModal.value = false\r\n\t\tsetTimeout(() => {\r\n\t\t\tshowLoading.value = false\r\n\t\t\tformRRef.value.changeLoading?.(false)\r\n\t\t}, 1000)\r\n\t}\r\n\r\n\tfunction handleVisibleChange(show: any) {\r\n\t\t/*弹框开关状况改变处理，私有*/\r\n\t\tif (!show) {\r\n\t\t\temit('on-close')\r\n\t\t} else {\r\n\t\t\temit('on-open')\r\n\t\t}\r\n\t}\r\n\r\n\tdefineExpose({\r\n\t\tresetForm,\r\n\t\trefreshFormDom,\r\n\t\treRenderForm,\r\n\t\tsetItemToValGroup,\r\n\t\tupdateValGroup,\r\n\t\tupdateFormDataT,\r\n\t\tvalidate,\r\n\t\treValidate,\r\n\t\tchangeLoading,\r\n\t\tgetValGroup,\r\n\t\tsubmit,\r\n\t\topen,\r\n\t\tclose\r\n\t})\r\n</script>\r\n\r\n<template>\r\n\t<Modal\r\n\t\tclass=\"formModal\"\r\n\t\t:title=\"props.title || t('r.title')\"\r\n\t\tv-model=\"openModal\"\r\n\t\t:mask-closable=\"false\"\r\n\t\t:footer-hide=\"props.hideFooter\"\r\n\t\t:class=\"{ hideFooter: props.hideFooter }\"\r\n\t\t:width=\"props.width\"\r\n\t\t@on-visible-change=\"handleVisibleChange\"\r\n\t>\r\n\t\t<form-r\r\n\t\t\tref=\"formRRef\"\r\n\t\t\tv-bind=\"$attrs\"\r\n\t\t\t:form-data=\"props.formData\"\r\n\t\t\t:label-width=\"props.labelWidth\"\r\n\t\t\t:btnLoading=\"props.btnLoading\"\r\n\t\t\t@on-submit=\"onSubmit\"\r\n\t\t>\r\n\t\t\t<template #[item.slotName]=\"{ valGroup }\" v-for=\"item in formDataC\">\r\n\t\t\t\t<slot :name=\"item.slotName\" :val-group=\"valGroup\" />\r\n\t\t\t</template>\r\n\t\t</form-r>\r\n\t\t<template #footer>\r\n\t\t\t<Button @click=\"submit\" class=\"modal-save-btn\" :loading=\"props.btnLoading && showLoading\">{{\r\n\t\t\t\tprops.okBtTxt || t('r.confirm')\r\n\t\t\t}}</Button>\r\n\t\t\t<Button @click=\"close\" class=\"modal-cancel-btn\" v-if=\"!props.hideCancelBt\">{{\r\n\t\t\t\tprops.cancelBtTxt || t('r.cancel')\r\n\t\t\t}}</Button>\r\n\t\t</template>\r\n\t</Modal>\r\n</template>\r\n","<!--CheckboxTree 复选框树，支持v-model，可自定义label和v-model收集字段，可定义v-model只收集叶子节点数据或全部选中的节点数据\r\n@created 2023.09.01\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script lang=\"ts\" setup>\r\n\timport { setValByOption } from '../../utils/globalFunc'\r\n\timport { findIndex, find, cloneDeep } from 'lodash-es'\r\n\r\n\tconst emit = defineEmits(['update:modelValue', 'on-change'])\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\tmodelValue?: any[] /*选中的节点的集合（内容依据collectVal中的字段）*/\r\n\t\t\tdata?: any[] /*树结构数据*/\r\n\t\t\texpandAll?: boolean /*是否默认全部展开*/\r\n\t\t\tlabel?: string /*节点的标签*/\r\n\t\t\tcollectVal?: string | string[] /*v-model收集节点的哪些字段*/\r\n\t\t\tleaf?: boolean /*叶子节点模式，v-model只返回叶子节点数据，任何选择操作都会选择叶子节点*/\r\n\t\t\tinlineLeaf?: boolean /*叶子节点为行内模式，横向排列*/\r\n\t\t\tdisabled?: boolean /*禁用整颗树的checkbox选择功能*/\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\tmodelValue: () => [],\r\n\t\t\tdata: () => [],\r\n\t\t\texpandAll: false,\r\n\t\t\tlabel: 'name',\r\n\t\t\tcollectVal: 'id',\r\n\t\t\tleaf: true,\r\n\t\t\tinlineLeaf: false,\r\n\t\t\tdisabled: false\r\n\t\t}\r\n\t)\r\n\r\n\tconst initTree = ref(true)\r\n\tconst dataT = ref<any[]>([])\r\n\tconst id = 'CKT' + Math.floor(Math.random() * 10000000 + 10000000)\r\n\tlet valueE: any[] = []\r\n\tconst collectValT = computed(() => {\r\n\t\tif (Array.isArray(props.collectVal)) {\r\n\t\t\treturn props.collectVal\r\n\t\t} else if (typeof props.collectVal === 'string') {\r\n\t\t\treturn [props.collectVal]\r\n\t\t}\r\n\t\treturn []\r\n\t})\r\n\tconst valueT = computed(() => {\r\n\t\tif (Array.isArray(props.modelValue)) {\r\n\t\t\treturn props.modelValue\r\n\t\t}\r\n\t\treturn []\r\n\t})\r\n\r\n\twatch(\r\n\t\t() => props.data,\r\n\t\t(after: any) => {\r\n\t\t\tinitTree.value = false\r\n\t\t\tlet temp: any[] = []\r\n\t\t\tinitData(after, temp)\r\n\t\t\tdataT.value = temp\r\n\t\t\tnextTick(function () {\r\n\t\t\t\tinitTree.value = true\r\n\r\n\t\t\t\tif (props.inlineLeaf) {\r\n\t\t\t\t\tnextTick(changeStyle)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t{\r\n\t\t\timmediate: true,\r\n\t\t\tdeep: true\r\n\t\t}\r\n\t)\r\n\r\n\twatch(\r\n\t\t() => valueT.value,\r\n\t\t(after: any) => {\r\n\t\t\tlet key: string\r\n\t\t\tlet type = 's'\r\n\t\t\tif (Array.isArray(props.collectVal)) {\r\n\t\t\t\tkey = props.collectVal[0] || ''\r\n\t\t\t\ttype = 'a'\r\n\t\t\t} else {\r\n\t\t\t\tkey = props.collectVal\r\n\t\t\t}\r\n\t\t\tif (!key || JSON.stringify(after) === JSON.stringify(valueE)) {\r\n\t\t\t\tvalueE = []\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\t/*清空dataT已选*/\r\n\t\t\tsetValByOption({\r\n\t\t\t\tgroup: dataT.value,\r\n\t\t\t\tcondition: (e: any) => e?.checked === true,\r\n\t\t\t\tkey: 'checked',\r\n\t\t\t\tval: false\r\n\t\t\t})\r\n\t\t\t/*根据value设置dataT的已选*/\r\n\t\t\tif (type === 'a') {\r\n\t\t\t\tsetValByOption({\r\n\t\t\t\t\tgroup: dataT.value,\r\n\t\t\t\t\tcondition: (e) => findIndex(after, [key, e?.[key]]) !== -1,\r\n\t\t\t\t\tkey: 'checked',\r\n\t\t\t\t\tval: true\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tsetValByOption({\r\n\t\t\t\t\tgroup: dataT.value,\r\n\t\t\t\t\tcondition: (e) => after.indexOf(e?.[key]) !== -1,\r\n\t\t\t\t\tkey: 'checked',\r\n\t\t\t\t\tval: true\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t)\r\n\r\n\twatch(\r\n\t\t() => props.disabled,\r\n\t\t(after: any) => {\r\n\t\t\tsetValByOption({\r\n\t\t\t\tgroup: dataT.value,\r\n\t\t\t\tcondition: (e) => e && e.disableCheckbox !== after,\r\n\t\t\t\tkey: 'disableCheckbox',\r\n\t\t\t\tval: after\r\n\t\t\t})\r\n\t\t\tif (props.inlineLeaf) {\r\n\t\t\t\tnextTick(changeStyle)\r\n\t\t\t}\r\n\t\t},\r\n\t\t{ immediate: true }\r\n\t)\r\n\r\n\tfunction initData(data: any[], root: any[] = []) {\r\n\t\tfor (let item of data) {\r\n\t\t\tlet checked = false\r\n\t\t\tif (collectValT.value.length > 1) {\r\n\t\t\t\t/*valueT的元素为Object*/\r\n\t\t\t\tchecked = find(valueT.value, (e: any) => e[collectValT.value[0]] === item[collectValT.value[0]]) !== undefined\r\n\t\t\t} else {\r\n\t\t\t\tchecked = collectValT.value[0] ? valueT.value.indexOf(item[collectValT.value[0]]) !== -1 : false\r\n\t\t\t}\r\n\t\t\tlet temp: Record<string, any> = {\r\n\t\t\t\tname: item?.[props.label],\r\n\t\t\t\texpand: Boolean(props.expandAll || item?.expand),\r\n\t\t\t\tchecked: checked,\r\n\t\t\t\tdisableCheckbox: props.disabled\r\n\t\t\t}\r\n\t\t\tfor (let keyI of collectValT.value) {\r\n\t\t\t\ttemp[keyI] = item[keyI]\r\n\t\t\t}\r\n\t\t\troot.push(temp)\r\n\t\t\tif (item?.children && item.children.length > 0) {\r\n\t\t\t\ttemp.children = []\r\n\t\t\t\tinitDataB(item.children, temp.children)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction initDataB(data: any[], root: any[] = []) {\r\n\t\tfor (let item of data) {\r\n\t\t\tlet checked = false\r\n\t\t\tif (collectValT.value.length > 1) {\r\n\t\t\t\t/*valueT的元素为Object*/\r\n\t\t\t\tchecked = find(valueT.value, (e) => e[collectValT.value[0]] === item[collectValT.value[0]]) !== undefined\r\n\t\t\t} else {\r\n\t\t\t\tchecked = collectValT.value[0] ? valueT.value.indexOf(item[collectValT.value[0]]) !== -1 : false\r\n\t\t\t}\r\n\t\t\tlet temp: Record<string, any> = {\r\n\t\t\t\tname: item?.[props.label],\r\n\t\t\t\texpand: Boolean(props.expandAll || item?.expand),\r\n\t\t\t\tchecked: checked,\r\n\t\t\t\tdisableCheckbox: props.disabled\r\n\t\t\t}\r\n\t\t\tfor (let keyI of collectValT.value) {\r\n\t\t\t\ttemp[keyI] = item[keyI]\r\n\t\t\t}\r\n\t\t\troot.push(temp)\r\n\t\t\tif (item?.children && item.children.length > 0) {\r\n\t\t\t\ttemp.children = []\r\n\t\t\t\tinitData(item.children, temp.children)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction renderContent(\r\n\t\th: any,\r\n\t\t{\r\n\t\t\tdata\r\n\t\t}: {\r\n\t\t\tdata: any\r\n\t\t}\r\n\t) {\r\n\t\tlet classA = ''\r\n\t\tlet isLeaf = true\r\n\t\tif (data.children && data.children.length > 0) {\r\n\t\t\tfor (let ii of data.children) {\r\n\t\t\t\tif (ii.children !== undefined) {\r\n\t\t\t\t\tisLeaf = false\r\n\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (isLeaf && props.inlineLeaf) {\r\n\t\t\t\tclassA = 'inlineChildXA'\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn h(\r\n\t\t\t'div',\r\n\t\t\t{\r\n\t\t\t\tstyle: {\r\n\t\t\t\t\tdisplay: 'inline-block',\r\n\t\t\t\t\twidth: '100%'\r\n\t\t\t\t},\r\n\t\t\t\tclass: classA\r\n\t\t\t},\r\n\t\t\t[\r\n\t\t\t\th(\r\n\t\t\t\t\t'span',\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\tfontWeight: data.children ? 'bold' : 'normal'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdata.name\r\n\t\t\t\t)\r\n\t\t\t]\r\n\t\t)\r\n\t}\r\n\r\n\tfunction changeStyle(data?: Record<string, any>) {\r\n\t\tif (data) {\r\n\t\t\tif (data.expand) {\r\n\t\t\t\tnextTick(changeStyle)\r\n\t\t\t}\r\n\t\t\treturn\r\n\t\t}\r\n\t\tlet arr = document.querySelectorAll('#' + id + ' .inlineChildXA')\r\n\t\tif (arr.length > 0) {\r\n\t\t\tfor (let item of arr) {\r\n\t\t\t\tlet parent = item?.parentElement\r\n\t\t\t\tlet tt = parent?.nextElementSibling\r\n\t\t\t\tif (!tt) {\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tif (tt.tagName !== 'BR') {\r\n\t\t\t\t\tlet grandParent = parent?.parentElement\r\n\t\t\t\t\tlet br = document.createElement('br')\r\n\t\t\t\t\tgrandParent?.insertBefore(br, tt)\r\n\t\t\t\t\ttt = br.nextElementSibling\r\n\t\t\t\t\tif (tt?.className.indexOf('inlineTreeNodeF') === -1) {\r\n\t\t\t\t\t\ttt.setAttribute('class', tt.className + ' inlineTreeNodeF')\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\twhile (tt?.nextElementSibling) {\r\n\t\t\t\t\ttt = tt.nextElementSibling\r\n\t\t\t\t\tif (tt.className.indexOf('inlineTreeNodeF') === -1) {\r\n\t\t\t\t\t\ttt.setAttribute('class', tt.className + ' inlineTreeNodeF')\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction updateVal(data: any[]) {\r\n\t\tlet temp: any[] = []\r\n\t\tif (props.leaf) {\r\n\t\t\tfor (let item of data) {\r\n\t\t\t\tif (!item.children) {\r\n\t\t\t\t\tif (Array.isArray(props.collectVal)) {\r\n\t\t\t\t\t\tlet valT: Record<string, any> = {}\r\n\t\t\t\t\t\tfor (let keyI of props.collectVal) {\r\n\t\t\t\t\t\t\tvalT[keyI] = item[keyI]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttemp.push(valT)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttemp.push(item[props.collectVal])\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tfor (let item of data) {\r\n\t\t\t\tif (Array.isArray(props.collectVal)) {\r\n\t\t\t\t\tlet valT: Record<string, any> = {}\r\n\t\t\t\t\tfor (let keyI of props.collectVal) {\r\n\t\t\t\t\t\tvalT[keyI] = item[keyI]\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttemp.push(valT)\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttemp.push(item[props.collectVal])\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvalueE = temp\r\n\t\temit('update:modelValue', temp)\r\n\t\temit('on-change', cloneDeep(temp))\r\n\t}\r\n</script>\r\n\r\n<template>\r\n\t<Tree\r\n\t\t:id=\"id\"\r\n\t\tclass=\"checkboxTreeGA\"\r\n\t\tv-if=\"initTree\"\r\n\t\t:data=\"dataT\"\r\n\t\t:render=\"renderContent\"\r\n\t\t@on-check-change=\"updateVal\"\r\n\t\t@on-toggle-expand=\"changeStyle\"\r\n\t\tshow-checkbox\r\n\t/>\r\n</template>\r\n","<!--TransferBox 穿梭框，左右两套由筛选表单-表格-页签集成的UI组件之间的数据穿梭，左右表格数据皆来自接口，穿梭时自动请求接口，然后自动刷新数据\r\n@created 2023.09.04\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n<script lang=\"ts\" setup>\r\n\timport { isEmpty } from 'lodash-es'\r\n\timport t from '../../locale/i18nSFC'\r\n\timport $fetch from '../../utils/fetch'\r\n\timport $swal from '../../utils/swal'\r\n\timport ShowHidePanel from '../ShowHidePanel/ShowHidePanel.vue'\r\n\timport SearchForm from '../SearchForm/SearchForm.vue'\r\n\timport BtTablePage from '../BtTablePage/BtTablePage.vue'\r\n\timport Proxy from '../../utils/proxy'\r\n\r\n\tconst emit = defineEmits(['transferred', 'on-data-change-l', 'on-data-change-r'])\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\ttitleLeft?: string\r\n\t\t\ttitleRight?: string\r\n\t\t\tformDataLeft?: any[]\r\n\t\t\tformDataRight?: any[]\r\n\t\t\tformRulesLeft?: Record<string, any>\r\n\t\t\tformRulesRight?: Record<string, any>\r\n\t\t\tconstSearchDataLeft?: Record<string, any>\r\n\t\t\tconstSearchDataRight?: Record<string, any>\r\n\t\t\tleftTableColumns?: any[]\r\n\t\t\trightTableColumns?: any[]\r\n\t\t\tleftTableUrl?: string\r\n\t\t\trightTableUrl?: string\r\n\t\t\taddUrl?: string\r\n\t\t\tdeleteUrl?: string\r\n\t\t\taddAllUrl?: string\r\n\t\t\tdeleteAllUrl?: string\r\n\t\t\taddParamsHandle?: (d: any) => any\r\n\t\t\tdeleteParamsHandle?: (d: any) => any\r\n\t\t\taddAllParamsHandle?: (d: any) => any\r\n\t\t\tdeleteAllParamsHandle?: (d: any) => any\r\n\t\t\taddMethod?: 'post' | 'put' | 'get'\r\n\t\t\taddAllMethod?: 'post' | 'put' | 'get'\r\n\t\t\tdeleteMethod?: 'delete' | 'post' | 'put' | 'get'\r\n\t\t\tdeleteAllMethod?: 'delete' | 'post' | 'put' | 'get'\r\n\t\t\tsearchFormLabelWith?: number\r\n\t\t\tusePagePro?: boolean /*是否使用pagePro组件作为页签*/\r\n\t\t\tshowTotal?: boolean /*page是否展示total*/\r\n\t\t\tshowSizer?: boolean /*page是否展示sizer*/\r\n\t\t\tleftSearchDataFilter?: (d: any) => any\r\n\t\t\trightSearchDataFilter?: (d: any) => any\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\tformDataLeft: () => [],\r\n\t\t\tformDataRight: () => [],\r\n\t\t\tformRulesLeft: () => ({}),\r\n\t\t\tformRulesRight: () => ({}),\r\n\t\t\tconstSearchDataLeft: () => ({}),\r\n\t\t\tconstSearchDataRight: () => ({}),\r\n\t\t\tleftTableColumns: () => [],\r\n\t\t\trightTableColumns: () => [],\r\n\t\t\taddParamsHandle: (selection: any[]) => selection.map((e: any) => e?.id),\r\n\t\t\tdeleteParamsHandle: (selection: any[]) => selection.map((e: any) => e?.id),\r\n\t\t\taddAllParamsHandle: (searchData: Record<string, any>) => searchData,\r\n\t\t\tdeleteAllParamsHandle: (searchData: Record<string, any>) => searchData,\r\n\t\t\taddMethod: 'post',\r\n\t\t\taddAllMethod: 'post',\r\n\t\t\tdeleteMethod: 'delete',\r\n\t\t\tdeleteAllMethod: 'delete',\r\n\t\t\tusePagePro: () => Proxy()?.btTablePageUsePagePro,\r\n\t\t\tshowTotal: () => Proxy()?.pageShowTotal,\r\n\t\t\tshowSizer: () => Proxy()?.pageShowSizer\r\n\t\t}\r\n\t)\r\n\r\n\tlet searchDataLeft = ref<Record<string, any>>({})\r\n\tlet searchDataRight = ref<Record<string, any>>({})\r\n\tlet lSelection = ref<any[]>([])\r\n\tlet rSelection = ref<any[]>([])\r\n\tlet leftTotal = ref(0)\r\n\tlet rightTotal = ref(0)\r\n\r\n\tconst leftTableSearchData = computed(() => ({ ...props.constSearchDataLeft, ...searchDataLeft.value }))\r\n\tconst rightTableSearchData = computed(() => ({ ...props.constSearchDataRight, ...searchDataRight.value }))\r\n\tconst delAllDis = computed(() => leftTotal.value < 1)\r\n\tconst deleteDis = computed(() => lSelection.value.length < 1)\r\n\tconst addDis = computed(() => rSelection.value.length < 1)\r\n\tconst addAllDis = computed(() => rightTotal.value < 1)\r\n\r\n\tconst leftFormRef = ref()\r\n\tconst rightFormRef = ref()\r\n\tconst lTabRef = ref()\r\n\tconst rTabRef = ref()\r\n\r\n\t/*重置穿梭框（公开）*/\r\n\tfunction reset() {\r\n\t\tleftFormRef.value.resetForm()\r\n\t\trightFormRef.value.resetForm()\r\n\t\tif (!isEmpty(searchDataLeft.value)) {\r\n\t\t\tsearchDataLeft.value = {}\r\n\t\t}\r\n\t\tif (!isEmpty(searchDataRight.value)) {\r\n\t\t\tsearchDataRight.value = {}\r\n\t\t}\r\n\t\tlTabRef.value.clearSelect()\r\n\t\trTabRef.value.clearSelect()\r\n\t}\r\n\r\n\t/*主动触发筛选/刷新数据（公开）*/\r\n\tfunction search() {\r\n\t\tlTabRef.value.search()\r\n\t\trTabRef.value.search()\r\n\t}\r\n\r\n\t/*私有*/\r\n\tfunction lSelectionChange(s: any) {\r\n\t\tlSelection.value = s\r\n\t}\r\n\r\n\t/*私有*/\r\n\tfunction rSelectionChange(s: any) {\r\n\t\trSelection.value = s\r\n\t}\r\n\r\n\t/*私有*/\r\n\tfunction dataChangeL(d: Record<string, any>) {\r\n\t\tleftTotal.value = d?.data?.page?.total || d?.data?.data?.total || d?.data?.total || d?.total || 0\r\n\t\temit('on-data-change-l', d)\r\n\t}\r\n\r\n\t/*私有*/\r\n\tfunction dataChangeR(d: Record<string, any>) {\r\n\t\trightTotal.value = d?.data?.page?.total || d?.data?.data?.total || d?.data?.total || d?.total || 0\r\n\t\temit('on-data-change-r', d)\r\n\t}\r\n\r\n\t/*私有*/\r\n\tfunction searchLeft(d: any) {\r\n\t\tif (typeof props.leftSearchDataFilter === 'function') {\r\n\t\t\tsearchDataLeft.value = props.leftSearchDataFilter(d)\r\n\t\t} else {\r\n\t\t\tsearchDataLeft.value = d\r\n\t\t}\r\n\t}\r\n\r\n\t/*私有*/\r\n\tfunction searchRight(d: any) {\r\n\t\tif (typeof props.rightSearchDataFilter === 'function') {\r\n\t\t\tsearchDataRight.value = props.rightSearchDataFilter(d)\r\n\t\t} else {\r\n\t\t\tsearchDataRight.value = d\r\n\t\t}\r\n\t}\r\n\r\n\t/*私有*/\r\n\tfunction add() {\r\n\t\tif (props.addUrl) {\r\n\t\t\tfetchX('add')\r\n\t\t}\r\n\t}\r\n\r\n\t/*私有*/\r\n\tfunction remove() {\r\n\t\tif (props.deleteUrl) {\r\n\t\t\tfetchX('delete')\r\n\t\t}\r\n\t}\r\n\r\n\t/*私有*/\r\n\tfunction addAll() {\r\n\t\tif (props.addAllUrl && props.addUrl) {\r\n\t\t\tfetchX('addAll')\r\n\t\t}\r\n\t}\r\n\r\n\t/*私有*/\r\n\tfunction removeAll() {\r\n\t\tif (props.deleteAllUrl) {\r\n\t\t\tfetchX('deleteAll')\r\n\t\t}\r\n\t}\r\n\r\n\t/*私有*/\r\n\tfunction fetchX(action: 'add' | 'delete' | 'addAll' | 'deleteAll') {\r\n\t\tlet method\r\n\t\tlet url\r\n\t\tlet data: Record<string, any> = {}\r\n\t\tlet msg = ''\r\n\t\tswitch (action) {\r\n\t\t\tcase 'add':\r\n\t\t\t\tmethod = props.addMethod\r\n\t\t\t\turl = props.addUrl\r\n\t\t\t\tdata = props.addParamsHandle(rSelection.value)\r\n\t\t\t\tmsg = t('r.add')\r\n\t\t\t\tbreak\r\n\t\t\tcase 'delete':\r\n\t\t\t\tmethod = props.deleteMethod\r\n\t\t\t\turl = props.deleteUrl\r\n\t\t\t\tdata = props.deleteParamsHandle(lSelection.value)\r\n\t\t\t\tmsg = t('r.remove')\r\n\t\t\t\tbreak\r\n\t\t\tcase 'addAll':\r\n\t\t\t\tmethod = props.addAllMethod\r\n\t\t\t\turl = props.addAllUrl\r\n\t\t\t\tdata = props.addAllParamsHandle(rightTableSearchData.value)\r\n\t\t\t\tmsg = t('r.addAll')\r\n\t\t\t\tbreak\r\n\t\t\tcase 'deleteAll':\r\n\t\t\t\tmethod = props.deleteAllMethod\r\n\t\t\t\turl = props.deleteAllUrl\r\n\t\t\t\tdata = props.deleteAllParamsHandle(leftTableSearchData.value)\r\n\t\t\t\tmsg = t('r.removeAll')\r\n\t\t\t\tbreak\r\n\t\t}\r\n\t\tif (url && method) {\r\n\t\t\t$fetch[method](url, data, null, [], { spin: true }, false)\r\n\t\t\t\t.then((r: any) => {\r\n\t\t\t\t\tif (r?.code === 0) {\r\n\t\t\t\t\t\t$swal(msg + t('r.success'), r?.message || '', 'success')\r\n\t\t\t\t\t\tif (lTabRef.value) {\r\n\t\t\t\t\t\t\tlTabRef.value.getTableData()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (rTabRef.value) {\r\n\t\t\t\t\t\t\trTabRef.value.getTableData()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\temit('transferred')\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$swal(msg + t('r.failed'), r?.message || '', 'error')\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.catch(() => {\r\n\t\t\t\t\t$swal(msg + t('r.error'), '', 'error')\r\n\t\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tdefineExpose({\r\n\t\treset,\r\n\t\tsearch\r\n\t})\r\n</script>\r\n\r\n<template>\r\n\t<div class=\"transferBoxRL\">\r\n\t\t<div class=\"leftBoxLLL\">\r\n\t\t\t<div class=\"fullHeight flexColumnBox\">\r\n\t\t\t\t<div class=\"notGrow\">\r\n\t\t\t\t\t<div class=\"titleLLL\">{{ props.titleLeft || t('r.added') }}</div>\r\n\t\t\t\t\t<show-hide-panel>\r\n\t\t\t\t\t\t<search-form\r\n\t\t\t\t\t\t\tref=\"leftFormRef\"\r\n\t\t\t\t\t\t\t:form-data=\"props.formDataLeft\"\r\n\t\t\t\t\t\t\t:form-rules=\"props.formRulesLeft\"\r\n\t\t\t\t\t\t\t:label-width=\"props.searchFormLabelWith\"\r\n\t\t\t\t\t\t\t@on-search=\"searchLeft\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</show-hide-panel>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"growFlexItem\">\r\n\t\t\t\t\t<bt-table-page\r\n\t\t\t\t\t\tref=\"lTabRef\"\r\n\t\t\t\t\t\t:columns=\"props.leftTableColumns\"\r\n\t\t\t\t\t\t:url=\"props.leftTableUrl\"\r\n\t\t\t\t\t\t:search-data=\"leftTableSearchData\"\r\n\t\t\t\t\t\t@on-selection-change=\"lSelectionChange\"\r\n\t\t\t\t\t\t@on-data-change=\"dataChangeL\"\r\n\t\t\t\t\t\t:init-data=\"Boolean(isEmpty(props.constSearchDataLeft) && props.leftTableUrl)\"\r\n\t\t\t\t\t\tget-data-loading\r\n\t\t\t\t\t\tselection\r\n\t\t\t\t\t\t:usePagePro=\"props.usePagePro\"\r\n\t\t\t\t\t\t:showTotal=\"props.showTotal\"\r\n\t\t\t\t\t\t:showSizer=\"props.showSizer\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"middleBoxLLL\">\r\n\t\t\t<Button class=\"middleBtLLL\" type=\"default\" @click=\"removeAll\" :disabled=\"delAllDis\"\r\n\t\t\t\t>{{ t('r.removeAll') }}\r\n\t\t\t\t<Icon type=\"ios-arrow-forward\" />\r\n\t\t\t</Button>\r\n\t\t\t<Button class=\"middleBtLLL\" type=\"default\" @click=\"remove\" :disabled=\"deleteDis\"\r\n\t\t\t\t>{{ t('r.remove') }}\r\n\t\t\t\t<Icon type=\"ios-arrow-forward\" />\r\n\t\t\t</Button>\r\n\t\t\t<Button class=\"middleBtLLL\" type=\"primary\" @click=\"add\" :disabled=\"addDis\">\r\n\t\t\t\t<Icon type=\"ios-arrow-back\" />\r\n\t\t\t\t{{ t('r.add') }}</Button\r\n\t\t\t>\r\n\t\t\t<Button class=\"middleBtLLL\" type=\"primary\" @click=\"addAll\" :disabled=\"addAllDis\">\r\n\t\t\t\t<Icon type=\"ios-arrow-back\" />\r\n\t\t\t\t{{ t('r.addAll') }}</Button\r\n\t\t\t>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"rightBoxLLL\">\r\n\t\t\t<div class=\"fullHeight flexColumnBox\">\r\n\t\t\t\t<div class=\"notGrow\">\r\n\t\t\t\t\t<div class=\"titleLLL\">{{ props.titleRight || t('r.notAdded') }}</div>\r\n\r\n\t\t\t\t\t<show-hide-panel>\r\n\t\t\t\t\t\t<search-form\r\n\t\t\t\t\t\t\tref=\"rightFormRef\"\r\n\t\t\t\t\t\t\t:form-data=\"props.formDataRight\"\r\n\t\t\t\t\t\t\t:form-rules=\"props.formRulesRight\"\r\n\t\t\t\t\t\t\t:label-width=\"props.searchFormLabelWith\"\r\n\t\t\t\t\t\t\t@on-search=\"searchRight\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</show-hide-panel>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"growFlexItem\">\r\n\t\t\t\t\t<bt-table-page\r\n\t\t\t\t\t\tref=\"rTabRef\"\r\n\t\t\t\t\t\t:columns=\"props.rightTableColumns\"\r\n\t\t\t\t\t\t:url=\"props.rightTableUrl\"\r\n\t\t\t\t\t\t:search-data=\"rightTableSearchData\"\r\n\t\t\t\t\t\t@on-selection-change=\"rSelectionChange\"\r\n\t\t\t\t\t\t@on-data-change=\"dataChangeR\"\r\n\t\t\t\t\t\t:init-data=\"Boolean(isEmpty(props.constSearchDataRight) && props.rightTableUrl)\"\r\n\t\t\t\t\t\tget-data-loading\r\n\t\t\t\t\t\tselection\r\n\t\t\t\t\t\t:usePagePro=\"props.usePagePro\"\r\n\t\t\t\t\t\t:showTotal=\"props.showTotal\"\r\n\t\t\t\t\t\t:showSizer=\"props.showSizer\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n","<!--CheckboxGroupTwoClass 二级复选框组，支持v-model，可自定义label和v-model收集字段，可定义v-model只收集叶子节点数据或全部选中的节点数据\r\n@created 2023.10.17\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script lang=\"ts\" setup>\r\n\timport { cloneDeep, isEmpty, isEqual } from 'lodash-es'\r\n\timport { myTypeof } from '../../utils/globalFunc'\r\n\timport t from '../../locale/i18nSFC'\r\n\timport type { TreeNode } from '../../public'\r\n\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\tmodelValue?: any[]\r\n\t\t\tdata?: TreeNode[]\r\n\t\t\tfirstTitle?: string\r\n\t\t\tsecondTitle?: string\r\n\t\t\tlabel?: string /*节点的标签*/\r\n\t\t\tcollectVal?: string | string[] /*v-model收集节点的哪些字段*/\r\n\t\t\tleaf?: boolean /*叶子节点模式，v-model只返回叶子节点数据，任何选择操作都会选择叶子节点*/\r\n\t\t\tdisabled?: boolean /*禁用整颗树的checkbox选择功能*/\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\tmodelValue: () => [],\r\n\t\t\tdata: () => [],\r\n\t\t\tlabel: 'name',\r\n\t\t\tcollectVal: 'id',\r\n\t\t\tleaf: true\r\n\t\t}\r\n\t)\r\n\tconst emit = defineEmits(['update:modelValue', 'on-change'])\r\n\tconst leafChecked = ref<any[]>([])\r\n\tconst dataT = computed(() => {\r\n\t\tlet temp = cloneDeep(props.data)\r\n\t\tlet valTemp = cloneDeep(leafChecked.value)\r\n\t\tfor (let item of temp) {\r\n\t\t\t/*遍历data添加勾选信息*/\r\n\t\t\tlet checkCount = 0\r\n\t\t\tif (item?.children && !isEmpty(item.children)) {\r\n\t\t\t\tfor (let secItem of item.children) {\r\n\t\t\t\t\t/*更深一层遍历children*/\r\n\t\t\t\t\tfor (let valIndex = 0, len = valTemp?.length; valIndex < len; valIndex++) {\r\n\t\t\t\t\t\t/*遍历继承的value*/\r\n\t\t\t\t\t\tif (Array.isArray(props.collectVal)) {\r\n\t\t\t\t\t\t\t/*收集多个字段的情况*/\r\n\t\t\t\t\t\t\tlet equalI = true\r\n\t\t\t\t\t\t\tfor (let collectKey of props.collectVal) {\r\n\t\t\t\t\t\t\t\tif (valTemp[valIndex]?.[collectKey] !== secItem?.[collectKey]) {\r\n\t\t\t\t\t\t\t\t\t/*遍历中当前节点和value的当前遍历元素不等（收集字段对应的值有不等的），判断为当前节点没有被选中，不在判断其他收集字段，跳出循环*/\r\n\t\t\t\t\t\t\t\t\tequalI = false\r\n\t\t\t\t\t\t\t\t\tbreak\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t/*循环结束，如果equalI的值没被改为false,则表示当前节点被选中*/\r\n\t\t\t\t\t\t\tif (equalI) {\r\n\t\t\t\t\t\t\t\t/*如果当前节点被选中，当前父级中选中的子节点数加一，不在遍历value其他元素，跳出循环*/\r\n\t\t\t\t\t\t\t\tsecItem.checked = true\r\n\t\t\t\t\t\t\t\tcheckCount++\r\n\t\t\t\t\t\t\t\tvalTemp.splice(valIndex, 1)\r\n\t\t\t\t\t\t\t\tbreak\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (valTemp[valIndex] === secItem[props.collectVal]) {\r\n\t\t\t\t\t\t\t/*收集单个字段且当前节点的对应字段的值和value中当前遍历元素相等,判断为选中，不在遍历value其他元素，跳出循环*/\r\n\t\t\t\t\t\t\tsecItem.checked = true\r\n\t\t\t\t\t\t\tcheckCount++\r\n\t\t\t\t\t\t\tvalTemp.splice(valIndex, 1)\r\n\t\t\t\t\t\t\tbreak\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t/*避免checked为Undefined*/\r\n\t\t\t\t\t!secItem.checked && (secItem.checked = false)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (checkCount === 0) {\r\n\t\t\t\titem.checked = false\r\n\t\t\t\titem.indeterminate = false\r\n\t\t\t} else if (item.children && checkCount === item.children.length) {\r\n\t\t\t\titem.checked = true\r\n\t\t\t\titem.indeterminate = false\r\n\t\t\t} else {\r\n\t\t\t\titem.checked = false\r\n\t\t\t\titem.indeterminate = true\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn temp\r\n\t})\r\n\r\n\twatch(\r\n\t\t() => props.modelValue,\r\n\t\t(after, before) => {\r\n\t\t\tif (isEqual(leafChecked.value, after) || isEqual(after, before)) {\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tleafChecked.value = after\r\n\t\t},\r\n\t\t{\r\n\t\t\timmediate: true,\r\n\t\t\tdeep: true\r\n\t\t}\r\n\t)\r\n\r\n\tfunction checkAll(root: TreeNode, isCheck: boolean) {\r\n\t\tif (root.children) {\r\n\t\t\tfor (let item of root.children) {\r\n\t\t\t\titem.checked = isCheck\r\n\t\t\t}\r\n\t\t}\r\n\t\tupdateDataT()\r\n\t}\r\n\r\n\tfunction updateDataT() {\r\n\t\tgetLeafChecked(dataT.value, true)\r\n\t}\r\n\r\n\tfunction getLeafChecked(val: TreeNode[], isLeaf?: boolean) {\r\n\t\tlet temp: any[] = []\r\n\t\tfor (let item of val) {\r\n\t\t\tif (!isLeaf && !props.leaf && item.checked && item.indeterminate === false) {\r\n\t\t\t\t/*非叶子节点模式且需要获取parent节点时，如果当前parent节点所有子节点都选中，在value中带上parent节点*/\r\n\t\t\t\tif (Array.isArray(props.collectVal)) {\r\n\t\t\t\t\tlet ttO: Record<string, any> = {}\r\n\t\t\t\t\tfor (let keyI of props.collectVal) {\r\n\t\t\t\t\t\tttO[keyI] = item[keyI]\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttemp.push(ttO)\r\n\t\t\t\t} else if (myTypeof(props.collectVal) === 'String') {\r\n\t\t\t\t\ttemp.push(item[props.collectVal])\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (item.children) {\r\n\t\t\t\tfor (let secItem of item.children) {\r\n\t\t\t\t\tif (secItem.checked) {\r\n\t\t\t\t\t\tif (Array.isArray(props.collectVal)) {\r\n\t\t\t\t\t\t\tlet ttO: Record<string, any> = {}\r\n\t\t\t\t\t\t\tfor (let keyI of props.collectVal) {\r\n\t\t\t\t\t\t\t\tttO[keyI] = secItem[keyI]\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttemp.push(ttO)\r\n\t\t\t\t\t\t} else if (myTypeof(props.collectVal) === 'String') {\r\n\t\t\t\t\t\t\ttemp.push(secItem[props.collectVal])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (isLeaf) {\r\n\t\t\tleafChecked.value = temp\r\n\t\t\tif (props.leaf) {\r\n\t\t\t\temit('update:modelValue', temp)\r\n\t\t\t\temit('on-change', cloneDeep(temp))\r\n\t\t\t} else {\r\n\t\t\t\tnextTick(function () {\r\n\t\t\t\t\tgetLeafChecked(dataT.value)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\temit('update:modelValue', temp)\r\n\t\t\temit('on-change', cloneDeep(temp))\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<template>\r\n\t<div class=\"boxLPA\">\r\n\t\t<div class=\"headerJ\">\r\n\t\t\t<div class=\"firstT borderBoxAS\">{{ firstTitle || t('r.level.1') }}</div>\r\n\t\t\t<div class=\"secondT borderBoxAS\">{{ secondTitle || t('r.level.2') }}</div>\r\n\t\t</div>\r\n\t\t<div class=\"bodyJ\" v-for=\"(item, index) in dataT\" :key=\"'checkboxJ' + index\">\r\n\t\t\t<div class=\"firstCol borderBoxAS\">\r\n\t\t\t\t<Checkbox\r\n\t\t\t\t\tv-model=\"item.checked\"\r\n\t\t\t\t\t:indeterminate=\"item.indeterminate\"\r\n\t\t\t\t\t@on-change=\"checkAll(item, $event)\"\r\n\t\t\t\t\t:disabled=\"disabled\"\r\n\t\t\t\t\t>{{ item[label] }}</Checkbox\r\n\t\t\t\t>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"secondCol borderBoxAS\">\r\n\t\t\t\t<div class=\"secItem\" v-for=\"(secItem, indexSec) in item.children\" :key=\"'secItem' + indexSec\">\r\n\t\t\t\t\t<Checkbox v-model=\"secItem.checked\" @on-change=\"updateDataT\" :disabled=\"disabled\">{{\r\n\t\t\t\t\t\tsecItem[label]\r\n\t\t\t\t\t}}</Checkbox>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n","<!--CheckboxGroupThreeClass 三级复选框组，支持v-model，可自定义label和v-model收集字段，可定义v-model只收集叶子节点数据或全部选中的节点数据\r\n@created 2023.10.24\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script lang=\"ts\" setup>\r\n\timport { cloneDeep, isEmpty, isEqual } from 'lodash-es'\r\n\timport { myTypeof } from '../../utils/globalFunc'\r\n\timport t from '../../locale/i18nSFC'\r\n\timport type { TreeNode } from '../../public'\r\n\r\n\tconst emit = defineEmits(['update:modelValue', 'on-change'])\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\tmodelValue?: any[]\r\n\t\t\tdata?: TreeNode[]\r\n\t\t\tfirstTitle?: string\r\n\t\t\tsecondTitle?: string\r\n\t\t\tthirdTitle?: string\r\n\t\t\tlabel?: string /*节点的标签*/\r\n\t\t\tcollectVal?: string | string[] /*v-model收集节点的哪些字段*/\r\n\t\t\tleaf?: boolean /*叶子节点模式，v-model只返回叶子节点数据，任何选择操作都会选择叶子节点*/\r\n\t\t\tdisabled?: boolean /*禁用整颗树的checkbox选择功能*/\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\tmodelValue: () => [],\r\n\t\t\tdata: () => [],\r\n\t\t\tlabel: 'name',\r\n\t\t\tcollectVal: 'id',\r\n\t\t\tleaf: true,\r\n\t\t\tdisabled: false\r\n\t\t}\r\n\t)\r\n\tconst leafChecked = ref<any[]>([])\r\n\tconst dataT = computed(() => {\r\n\t\tlet temp = cloneDeep(props.data)\r\n\t\tlet valTemp = cloneDeep(leafChecked.value)\r\n\t\tfor (let item of temp) {\r\n\t\t\t/*遍历data添加勾选信息(1级)*/\r\n\t\t\tlet checkCount = 0\r\n\t\t\tlet indeterminateCount = 0\r\n\t\t\tif (item?.children && !isEmpty(item.children)) {\r\n\t\t\t\tfor (let secItem of item.children) {\r\n\t\t\t\t\t/*更深一层遍历children（2级）*/\r\n\t\t\t\t\tlet checkCountB = 0\r\n\t\t\t\t\tif (secItem.children && !isEmpty(secItem.children)) {\r\n\t\t\t\t\t\tfor (let thirdItem of secItem.children) {\r\n\t\t\t\t\t\t\t/*更深一层遍历children（3级）*/\r\n\t\t\t\t\t\t\tfor (let valIndex = 0, len = valTemp.length; valIndex < len; valIndex++) {\r\n\t\t\t\t\t\t\t\t/*遍历继承的value*/\r\n\t\t\t\t\t\t\t\tif (Array.isArray(props.collectVal)) {\r\n\t\t\t\t\t\t\t\t\t/*收集多个字段的情况*/\r\n\t\t\t\t\t\t\t\t\tlet equalI = true\r\n\t\t\t\t\t\t\t\t\tfor (let collectKey of props.collectVal) {\r\n\t\t\t\t\t\t\t\t\t\tif (valTemp[valIndex][collectKey] !== thirdItem[collectKey]) {\r\n\t\t\t\t\t\t\t\t\t\t\t/*遍历中当前节点和value的当前遍历元素不等（收集字段对应的值有不等的），判断为当前节点没有被选中，不在判断其他收集字段，跳出循环*/\r\n\t\t\t\t\t\t\t\t\t\t\tequalI = false\r\n\t\t\t\t\t\t\t\t\t\t\tbreak\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t/*循环结束，如果equalI的值没被改为false,则表示当前节点被选中*/\r\n\t\t\t\t\t\t\t\t\tif (equalI) {\r\n\t\t\t\t\t\t\t\t\t\t/*如果当前节点被选中，当前父级中选中的子节点数加一，不在遍历value其他元素，跳出循环*/\r\n\t\t\t\t\t\t\t\t\t\tthirdItem.checked = true\r\n\t\t\t\t\t\t\t\t\t\tcheckCountB++\r\n\t\t\t\t\t\t\t\t\t\tvalTemp.splice(valIndex, 1)\r\n\t\t\t\t\t\t\t\t\t\tbreak\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else if (valTemp[valIndex] === thirdItem[props.collectVal]) {\r\n\t\t\t\t\t\t\t\t\t/*收集单个字段且当前节点的对应字段的值和value中当前遍历元素相等,判断为选中，不在遍历value其他元素，跳出循环*/\r\n\t\t\t\t\t\t\t\t\tthirdItem.checked = true\r\n\t\t\t\t\t\t\t\t\tcheckCountB++\r\n\t\t\t\t\t\t\t\t\tvalTemp.splice(valIndex, 1)\r\n\t\t\t\t\t\t\t\t\tbreak\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t/*避免checked为Undefined*/\r\n\t\t\t\t\t\t\t!thirdItem.checked && (thirdItem.checked = false)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (checkCountB === 0) {\r\n\t\t\t\t\t\tsecItem.checked = false\r\n\t\t\t\t\t\tsecItem.indeterminate = false\r\n\t\t\t\t\t} else if (secItem.children && checkCountB === secItem.children.length) {\r\n\t\t\t\t\t\tsecItem.checked = true\r\n\t\t\t\t\t\tsecItem.indeterminate = false\r\n\t\t\t\t\t\tcheckCount++\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsecItem.checked = false\r\n\t\t\t\t\t\tsecItem.indeterminate = true\r\n\t\t\t\t\t\tindeterminateCount++\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (checkCount === 0 && indeterminateCount === 0) {\r\n\t\t\t\titem.checked = false\r\n\t\t\t\titem.indeterminate = false\r\n\t\t\t} else if (item.children && checkCount === item.children.length) {\r\n\t\t\t\titem.checked = true\r\n\t\t\t\titem.indeterminate = false\r\n\t\t\t} else {\r\n\t\t\t\titem.checked = false\r\n\t\t\t\titem.indeterminate = true\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn temp\r\n\t})\r\n\r\n\twatch(\r\n\t\t() => props.modelValue,\r\n\t\t(after, before) => {\r\n\t\t\tif (isEqual(leafChecked.value, after) || isEqual(after, before)) {\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tleafChecked.value = after\r\n\t\t},\r\n\t\t{\r\n\t\t\timmediate: true,\r\n\t\t\tdeep: true\r\n\t\t}\r\n\t)\r\n\r\n\tfunction checkChangeFirst(root: TreeNode, isCheck: boolean) {\r\n\t\tif (root.children) {\r\n\t\t\tfor (let item of root.children) {\r\n\t\t\t\titem.checked = isCheck\r\n\t\t\t\tif (item.children) {\r\n\t\t\t\t\tfor (let itemB of item.children) {\r\n\t\t\t\t\t\titemB.checked = isCheck\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tupdateDataT()\r\n\t}\r\n\r\n\tfunction checkChangeSecond(root: TreeNode, isCheck: boolean) {\r\n\t\tif (root.children) {\r\n\t\t\tfor (let item of root.children) {\r\n\t\t\t\titem.checked = isCheck\r\n\t\t\t}\r\n\t\t}\r\n\t\tupdateDataT()\r\n\t}\r\n\r\n\tfunction updateDataT() {\r\n\t\tgetLeafChecked(dataT.value, true)\r\n\t}\r\n\r\n\tfunction getLeafChecked(val: TreeNode[], isLeaf?: boolean) {\r\n\t\tlet temp: any[] = []\r\n\t\tfor (let item of val) {\r\n\t\t\tif (!isLeaf && !props.leaf && item?.checked && item.indeterminate === false) {\r\n\t\t\t\t/*非叶子节点模式且需要获取parent节点时，如果当前parent节点所有子节点都选中，在value中带上parent节点*/\r\n\t\t\t\tif (Array.isArray(props.collectVal)) {\r\n\t\t\t\t\tlet ttO: Record<string, any> = {}\r\n\t\t\t\t\tfor (let keyI of props.collectVal) {\r\n\t\t\t\t\t\tttO[keyI] = item[keyI]\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttemp.push(ttO)\r\n\t\t\t\t} else if (myTypeof(props.collectVal) === 'String') {\r\n\t\t\t\t\ttemp.push(item[props.collectVal])\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (item?.children) {\r\n\t\t\t\tfor (let secItem of item.children) {\r\n\t\t\t\t\tif (!isLeaf && !props.leaf && secItem.checked && secItem.indeterminate === false) {\r\n\t\t\t\t\t\t/*非叶子节点模式且需要获取parent节点时，如果当前parent节点所有子节点都选中，在value中带上parent节点*/\r\n\t\t\t\t\t\tif (Array.isArray(props.collectVal)) {\r\n\t\t\t\t\t\t\tlet ttO: Record<string, any> = {}\r\n\t\t\t\t\t\t\tfor (let keyI of props.collectVal) {\r\n\t\t\t\t\t\t\t\tttO[keyI] = secItem[keyI]\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttemp.push(ttO)\r\n\t\t\t\t\t\t} else if (myTypeof(props.collectVal) === 'String') {\r\n\t\t\t\t\t\t\ttemp.push(secItem[props.collectVal])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (secItem.children) {\r\n\t\t\t\t\t\tfor (let thirdItem of secItem.children) {\r\n\t\t\t\t\t\t\tif (thirdItem.checked) {\r\n\t\t\t\t\t\t\t\tif (Array.isArray(props.collectVal)) {\r\n\t\t\t\t\t\t\t\t\tlet ttO: Record<string, any> = {}\r\n\t\t\t\t\t\t\t\t\tfor (let keyI of props.collectVal) {\r\n\t\t\t\t\t\t\t\t\t\tttO[keyI] = thirdItem[keyI]\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\ttemp.push(ttO)\r\n\t\t\t\t\t\t\t\t} else if (myTypeof(props.collectVal) === 'String') {\r\n\t\t\t\t\t\t\t\t\ttemp.push(thirdItem[props.collectVal])\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (isLeaf) {\r\n\t\t\tleafChecked.value = temp\r\n\t\t\tif (props.leaf) {\r\n\t\t\t\temit('update:modelValue', temp)\r\n\t\t\t\temit('on-change', cloneDeep(temp))\r\n\t\t\t} else {\r\n\t\t\t\tnextTick(function () {\r\n\t\t\t\t\tgetLeafChecked(dataT.value)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\temit('update:modelValue', temp)\r\n\t\t\temit('on-change', cloneDeep(temp))\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<template>\r\n\t<div class=\"boxLPB\">\r\n\t\t<div class=\"headerF\">\r\n\t\t\t<div class=\"firstT borderBoxKa\">{{ firstTitle || t('r.level.1') }}</div>\r\n\t\t\t<div class=\"secondT borderBoxKa\">{{ secondTitle || t('r.level.2') }}</div>\r\n\t\t\t<div class=\"thirdT borderBoxKa\">{{ thirdTitle || t('r.level.3') }}</div>\r\n\t\t</div>\r\n\t\t<div class=\"bodyF\" v-for=\"(item, index) in dataT\" :key=\"'checkboxJ' + index\">\r\n\t\t\t<div class=\"firstCol borderBoxKa\">\r\n\t\t\t\t<Checkbox\r\n\t\t\t\t\tv-model=\"item.checked\"\r\n\t\t\t\t\t:indeterminate=\"item.indeterminate\"\r\n\t\t\t\t\t@on-change=\"checkChangeFirst(item, $event)\"\r\n\t\t\t\t\t:disabled=\"disabled\"\r\n\t\t\t\t\t>{{ item[label] }}</Checkbox\r\n\t\t\t\t>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"rightBoxAL\">\r\n\t\t\t\t<div class=\"rightBoxInner\" v-for=\"(secItem, indexSec) in item.children\" :key=\"'secItem' + indexSec\">\r\n\t\t\t\t\t<div class=\"secondCol borderBoxKa\">\r\n\t\t\t\t\t\t<Checkbox\r\n\t\t\t\t\t\t\tv-model=\"secItem.checked\"\r\n\t\t\t\t\t\t\t:indeterminate=\"secItem.indeterminate\"\r\n\t\t\t\t\t\t\t@on-change=\"checkChangeSecond(secItem, $event)\"\r\n\t\t\t\t\t\t\t:disabled=\"disabled\"\r\n\t\t\t\t\t\t\t>{{ secItem[label] }}</Checkbox\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"thirdCol borderBoxKa\">\r\n\t\t\t\t\t\t<div class=\"thirdItem\" v-for=\"(thirdItem, indexThird) in secItem.children\" :key=\"'thirdItem' + indexThird\">\r\n\t\t\t\t\t\t\t<Checkbox v-model=\"thirdItem.checked\" @on-change=\"updateDataT\" :disabled=\"disabled\">{{\r\n\t\t\t\t\t\t\t\tthirdItem[label]\r\n\t\t\t\t\t\t\t}}</Checkbox>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n","<!--WellCard 带标题和顶部按钮的卡片，全局组件,直接使用\r\n@created 2023.11.16\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n<script lang=\"ts\" setup>\r\n\timport t from '../../locale/i18nSFC'\r\n\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\ttitle?: string\r\n\t\t\tfitToContent?: boolean /*卡片组件尺寸会根据内容改变，该模式下`width`和`height`不再生效，无需再传*/\r\n\t\t\twidth?: number | string\r\n\t\t\theight?: number | string\r\n\t\t\tinline?: boolean\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\tfitToContent: false,\r\n\t\t\twidth: '100%',\r\n\t\t\theight: '100%',\r\n\t\t\tinline: false\r\n\t\t}\r\n\t)\r\n\r\n\tconst wellStyle = computed(() => {\r\n\t\tlet temp: Record<string, any> = {\r\n\t\t\twidth: props.fitToContent ? 'fit-content' : props.width,\r\n\t\t\theight: props.fitToContent ? 'fit-content' : props.height\r\n\t\t}\r\n\t\tif (props.inline) {\r\n\t\t\ttemp.display = 'inline-block'\r\n\t\t}\r\n\t\tfor (let k in temp) {\r\n\t\t\tif (temp.hasOwnProperty(k) && typeof temp[k] === 'number' && temp[k] > 0) {\r\n\t\t\t\ttemp[k] += 'px'\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn temp\r\n\t})\r\n</script>\r\n\r\n<template>\r\n\t<div :style=\"wellStyle\">\r\n\t\t<div :class=\"['wellCardR', { flexColumnBox: !props.fitToContent }]\">\r\n\t\t\t<div :class=\"['panelHeader', { notGrow: !props.fitToContent }]\">\r\n\t\t\t\t<div class=\"fl\" style=\"font-weight: bold\">{{ props.title || t('r.title') }}</div>\r\n\t\t\t\t<div class=\"btsF\">\r\n\t\t\t\t\t<slot name=\"bts\" />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div v-if=\"props.fitToContent\">\r\n\t\t\t\t<slot />\r\n\t\t\t</div>\r\n\t\t\t<div v-else class=\"growFlexItem relativeBox\">\r\n\t\t\t\t<div class=\"fullFlowContent\">\r\n\t\t\t\t\t<slot />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n","<!--SelectScrollMore 远程下拉选择框，下拉滚动加载更多选项，支持筛选\r\n@created 2023.11.28\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script setup lang=\"ts\">\r\n\timport { debounce, isEmpty, cloneDeep, isString } from 'lodash-es'\r\n\timport { isValidValue, myTypeof } from '../../utils/globalFunc'\r\n\timport $fetch from '../../utils/fetch'\r\n\timport { Message } from 'view-ui-plus'\r\n\timport t from '../../locale/i18nSFC'\r\n\r\n\tconst emit = defineEmits(['update:modelValue', 'on-change', 'update-option-finish'])\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\tmodelValue?: string | number | any[] /*插件值，支持双向绑定v-model*/\r\n\t\t\turl: string /*待选项接口地址，不带条件*/\r\n\t\t\tsearchData?: Record<string, any> /*待选项接口条件*/\r\n\t\t\tgetOptions?: boolean /*是否拉取待选项,false:不拉取，并清空待选项和值*/\r\n\t\t\toptionFilter?: (d: any) => any /*接口返回数据处理函数，传入接口返回的数据，返回处理后的数据*/\r\n\t\t\toptionsLabelKey?: string | string[] /*待选项label取接口数据中哪个字段*/\r\n\t\t\toptionsValKey?: string /*待选项value取接口数据中哪个字段*/\r\n\t\t\tsearchKey?: string /*搜索框的值在拉取待选项数据的条件中对应的key*/\r\n\t\t\tsearchWordsRequired?: boolean /*只有在searchKey对应字段有值时（用户输入内容搜索时）拉取数据*/\r\n\t\t\tcollectLabel?: boolean /*需要在选中时返回出value以外其他字段*/\r\n\t\t\tplaceholder?: string\r\n\t\t\tdisabled?: boolean\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\tsearchData: () => ({ size: 10 }),\r\n\t\t\tgetOptions: true,\r\n\t\t\toptionsLabelKey: 'name',\r\n\t\t\toptionsValKey: 'id',\r\n\t\t\tsearchKey: 'name',\r\n\t\t\tsearchWordsRequired: false,\r\n\t\t\tcollectLabel: false,\r\n\t\t\tdisabled: false\r\n\t\t}\r\n\t)\r\n\r\n\tlet current = ref(1)\r\n\tlet pages = 1\r\n\tconst searchStr = ref('')\r\n\tconst options = shallowRef<Record<string, any>[]>([])\r\n\tlet historyData: Record<string, any> = {}\r\n\tlet isFresh = true\r\n\tlet urlChanged = false\r\n\tconst transferClass = 'scm' + Math.random()\r\n\r\n\tconst placeholderT = computed(() => {\r\n\t\treturn searchStr.value ? t('r.searchFor') + searchStr.value : props.placeholder || t('r.pInput')\r\n\t})\r\n\r\n\tconst valueT = computed({\r\n\t\tget() {\r\n\t\t\treturn props.modelValue ?? ''\r\n\t\t},\r\n\t\tset(val: any) {\r\n\t\t\temit('update:modelValue', val ?? '')\r\n\t\t\tif (props.collectLabel && val !== undefined) {\r\n\t\t\t\tlet temp = {}\r\n\t\t\t\tfor (let e of options.value) {\r\n\t\t\t\t\tif (e[props.optionsValKey] === val) {\r\n\t\t\t\t\t\ttemp = JSON.parse(JSON.stringify(e))\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\temit('on-change', temp)\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\r\n\tconst searchDataT = computed(() => {\r\n\t\treturn props.searchKey\r\n\t\t\t? {\r\n\t\t\t\t\t...props.searchData,\r\n\t\t\t\t\tcurrent: current.value,\r\n\t\t\t\t\t[props.searchKey]: searchStr.value\r\n\t\t\t\t}\r\n\t\t\t: {\r\n\t\t\t\t\t...props.searchData,\r\n\t\t\t\t\tcurrent: current.value\r\n\t\t\t\t}\r\n\t})\r\n\r\n\twatch(\r\n\t\t() => props.getOptions,\r\n\t\t(after) => {\r\n\t\t\tif (after) {\r\n\t\t\t\tif (isFresh) {\r\n\t\t\t\t\tgetData()\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treset()\r\n\t\t\t}\r\n\t\t},\r\n\t\t{ immediate: true }\r\n\t)\r\n\r\n\twatch(\r\n\t\t() => props.url,\r\n\t\t(after) => {\r\n\t\t\tif (after) {\r\n\t\t\t\turlChanged = true\r\n\t\t\t}\r\n\t\t}\r\n\t)\r\n\r\n\tconst selectScrollSourceRef = ref()\r\n\r\n\tfunction addInputEventListener() {\r\n\t\t/*私有，不可调用*/\r\n\t\tconst inputEl = selectScrollSourceRef.value.$el.querySelector('.ivu-select-input[type=\"text\"]')\r\n\t\tinputEl.addEventListener('keyup', getOption)\r\n\t}\r\n\r\n\tfunction reset() {\r\n\t\t/*私有，不可调用*/\r\n\t\tif (!isFresh) {\r\n\t\t\tvalueT.value = ''\r\n\t\t\tisFresh = true\r\n\t\t\tsearchStr.value = ''\r\n\t\t\toptions.value = []\r\n\t\t\tcurrent.value = 1\r\n\t\t\tpages = 1\r\n\t\t\thistoryData = {}\r\n\t\t\turlChanged = false\r\n\t\t}\r\n\t}\r\n\r\n\tfunction isSelect(val: any) {\r\n\t\t/*私有，不可调用*/\r\n\t\tfor (let item of options.value) {\r\n\t\t\tif (item?.label === val) {\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false\r\n\t}\r\n\r\n\tconst getOption = debounce(function (e: any) {\r\n\t\t/*私有，不可调用*/\r\n\t\tconst val = e?.target?.value\r\n\t\tif (!isSelect(val)) {\r\n\t\t\tif (isValidValue(val)) {\r\n\t\t\t\tif (urlChanged) {\r\n\t\t\t\t\treset()\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (isEmpty(historyData)) {\r\n\t\t\t\t\t\thistoryData.current = current.value\r\n\t\t\t\t\t\thistoryData.pages = pages\r\n\t\t\t\t\t\thistoryData.options = cloneDeep(options.value)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (isValidValue(valueT.value)) {\r\n\t\t\t\t\t\tvalueT.value = ''\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tsearchStr.value = String(val)\r\n\t\t\t\toptions.value = []\r\n\t\t\t\tcurrent.value = 1\r\n\t\t\t\tisFresh = true\r\n\t\t\t\tgetData()\r\n\t\t\t} else {\r\n\t\t\t\tif (urlChanged) {\r\n\t\t\t\t\treset()\r\n\t\t\t\t\tgetData()\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvalueT.value = ''\r\n\t\t\t\t\tsearchStr.value = ''\r\n\t\t\t\t\tif (historyData.current) {\r\n\t\t\t\t\t\tcurrent.value = historyData.current\r\n\t\t\t\t\t\tpages = historyData.pages\r\n\t\t\t\t\t\toptions.value = cloneDeep(historyData.options)\r\n\t\t\t\t\t\thistoryData = {}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tgetData()\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}, 600)\r\n\r\n\tfunction loadMore() {\r\n\t\t/*私有，不可调用*/\r\n\t\tif (urlChanged) {\r\n\t\t\treset()\r\n\t\t}\r\n\t\tif (current.value < pages) {\r\n\t\t\t++current.value\r\n\t\t\tnextTick(function () {\r\n\t\t\t\tgetData()\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\tMessage.warning({\r\n\t\t\t\tbackground: true,\r\n\t\t\t\tcontent: t('r.noMore')\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getData() {\r\n\t\t/*私有，不可调用*/\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tif (props.getOptions) {\r\n\t\t\t\tif (props.searchWordsRequired && !isValidValue(searchStr.value)) {\r\n\t\t\t\t\tresolve(false)\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t$fetch\r\n\t\t\t\t\t.get(props.url, searchDataT.value)\r\n\t\t\t\t\t.then((r: any) => {\r\n\t\t\t\t\t\tisFresh = false\r\n\t\t\t\t\t\tlet temp: any[] = []\r\n\t\t\t\t\t\tif (r?.data?.records) {\r\n\t\t\t\t\t\t\ttemp = r.data.records\r\n\t\t\t\t\t\t\tpages = r.data.pages\r\n\t\t\t\t\t\t} else if (r?.data && myTypeof(r.data) === 'Array') {\r\n\t\t\t\t\t\t\ttemp = r.data\r\n\t\t\t\t\t\t\tpages = r.pages\r\n\t\t\t\t\t\t} else if (r?.data && myTypeof(r.data) === 'Object') {\r\n\t\t\t\t\t\t\ttemp = [r.data]\r\n\t\t\t\t\t\t\tpages = 1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (typeof props.optionFilter === 'function' && myTypeof(props.optionFilter) === 'Function') {\r\n\t\t\t\t\t\t\ttemp = props.optionFilter(temp)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!isEmpty(temp)) {\r\n\t\t\t\t\t\t\ttemp = temp.map((e, i) => {\r\n\t\t\t\t\t\t\t\tlet label = t('r.optionLabel') + i\r\n\t\t\t\t\t\t\t\tif (Array.isArray(props.optionsLabelKey)) {\r\n\t\t\t\t\t\t\t\t\tlet labelT: any[] = []\r\n\t\t\t\t\t\t\t\t\tfor (let j = 1, len = props.optionsLabelKey.length; j < len; j++) {\r\n\t\t\t\t\t\t\t\t\t\tlabelT.push(e[props.optionsLabelKey[j]])\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tlabel = `${e[props.optionsLabelKey[0]]}(${String(labelT)})`\r\n\t\t\t\t\t\t\t\t} else if (isString(props.optionsLabelKey)) {\r\n\t\t\t\t\t\t\t\t\tlabel = e[props.optionsLabelKey]\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (props.collectLabel) {\r\n\t\t\t\t\t\t\t\t\tlet eT = cloneDeep(e)\r\n\t\t\t\t\t\t\t\t\tdelete eT.value\r\n\t\t\t\t\t\t\t\t\tdelete eT.label\r\n\t\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\t\tvalue: e[props.optionsValKey],\r\n\t\t\t\t\t\t\t\t\t\tlabel: label,\r\n\t\t\t\t\t\t\t\t\t\t...eT\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\tvalue: e[props.optionsValKey],\r\n\t\t\t\t\t\t\t\t\tlabel: label\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\toptions.value.push(...temp)\r\n\t\t\t\t\t\t/*去重*/\r\n\t\t\t\t\t\tlet hash: Record<string, any> = {}\r\n\t\t\t\t\t\toptions.value = options.value.filter((e) => {\r\n\t\t\t\t\t\t\tif (!hash[e?.value]) {\r\n\t\t\t\t\t\t\t\thash[e?.value] = true\r\n\t\t\t\t\t\t\t\treturn true\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tnextTick(function () {\r\n\t\t\t\t\t\t\temit('update-option-finish')\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tresolve(true)\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(() => {\r\n\t\t\t\t\t\tMessage.error(t('r.getDataError'))\r\n\t\t\t\t\t\treject(t('r.getDataError'))\r\n\t\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tresolve(false)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tonMounted(addInputEventListener)\r\n</script>\r\n\r\n<template>\r\n\t<Select\r\n\t\tv-model=\"valueT\"\r\n\t\tref=\"selectScrollSourceRef\"\r\n\t\t:transfer-class-name=\"transferClass\"\r\n\t\tv-bind=\"$attrs\"\r\n\t\ttransfer\r\n\t\tfilterable\r\n\t\tv-loadmore:[transferClass]=\"loadMore\"\r\n\t\t:placeholder=\"placeholderT\"\r\n\t\t:disabled=\"disabled\"\r\n\t>\r\n\t\t<Option\r\n\t\t\tv-for=\"(item, index) in options\"\r\n\t\t\t:key=\"'op' + index\"\r\n\t\t\t:value=\"item?.value\"\r\n\t\t\t:label=\"item?.label\"\r\n\t\t\t:disabled=\"item?.disabled\"\r\n\t\t/>\r\n\t</Select>\r\n</template>\r\n","<!--PrintModal 表格打印，可以在预览页面调整每列宽度以及可以选择打印的列\r\n@created 2024.03.14\r\n@author Ricky email:zhangqingcq@foxmail.com-->\r\n\r\n<script setup lang=\"ts\">\r\n\timport t from '../../locale/i18nSFC'\r\n\timport { useRoute } from 'vue-router'\r\n\timport TableSetting from '../../components/TableSetting/TableSetting.vue'\r\n\timport IconTxtBtn from '../../components/IconTxtBtn/IconTxtBtn.vue'\r\n\timport TableIconBtn from '../../components/TableIconBtn/TableIconBtn.vue'\r\n\r\n\tconst route = useRoute()\r\n\tconst title = ref()\r\n\tconst disabled = ref(false)\r\n\tconst domPrint = ref(false)\r\n\tconst autoPrint = ref(false)\r\n\tconst width = ref(715)\r\n\tconst help = ref(false)\r\n\tconst isFrom = ref()\r\n\tconst sKey = 'tablePrint_' + Date.now().toString()\r\n\tconst customClass = ref('')\r\n\tconst columns = ref([])\r\n\tconst tableData = ref([])\r\n\tconst isDrag = ref(false)\r\n\r\n\tconst domContainerStyle = computed(() => {\r\n\t\treturn {\r\n\t\t\twidth: width.value + 'px'\r\n\t\t}\r\n\t})\r\n\r\n\tconst close = () => {\r\n\t\tif (isFrom.value) {\r\n\t\t\twindow.sessionStorage.removeItem('print_' + isFrom.value)\r\n\t\t}\r\n\t\twindow.sessionStorage.removeItem(sKey)\r\n\t\twindow.close()\r\n\t}\r\n\r\n\tconst wallClick = () => {\r\n\t\tif (help.value) {\r\n\t\t\thelp.value = false\r\n\t\t}\r\n\t}\r\n\r\n\tconst dragStart = () => {\r\n\t\tisDrag.value = true\r\n\t}\r\n\tconst handleDrag = (e: any) => {\r\n\t\tif (isDrag.value) {\r\n\t\t\twidth.value = e?.layerX - 20\r\n\t\t}\r\n\t}\r\n\tconst dragEnd = () => {\r\n\t\tif (isDrag.value) {\r\n\t\t\tisDrag.value = false\r\n\t\t}\r\n\t}\r\n\r\n\tconst print = () => {\r\n\t\thelp.value = false\r\n\t\tlet tc = window.setTimeout(() => {\r\n\t\t\twindow.clearTimeout(tc)\r\n\t\t\twindow.print()\r\n\t\t}, 100)\r\n\t}\r\n\r\n\tconst init = () => {\r\n\t\tisFrom.value = route?.params?.isFrom\r\n\t\tif (isFrom.value) {\r\n\t\t\tlet d = window.sessionStorage.getItem('print_' + isFrom.value)\r\n\t\t\tif (d) {\r\n\t\t\t\tconst _d = JSON.parse(d)\r\n\t\t\t\tif (!_d) {\r\n\t\t\t\t\tdisabled.value = true\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tcolumns.value = _d.columns\r\n\t\t\t\ttableData.value = _d.data\r\n\t\t\t\ttitle.value = _d.title\r\n\t\t\t\tcustomClass.value = _d?.config?.customClass || ''\r\n\t\t\t\tdomPrint.value = _d?.config?.domPrint || false\r\n\t\t\t\tautoPrint.value = _d?.config?.autoPrint || false\r\n\t\t\t\twidth.value = _d?.config?.width || 715\r\n\t\t\t\tdocument.title = (title.value || t('r.print')) + '_' + new Date().toLocaleString()\r\n\t\t\t} else {\r\n\t\t\t\tdisabled.value = true\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tonMounted(() => {\r\n\t\tif (autoPrint.value) {\r\n\t\t\tlet tc = window.setTimeout(() => {\r\n\t\t\t\twindow.clearTimeout(tc)\r\n\t\t\t\tprint()\r\n\t\t\t}, 100)\r\n\t\t}\r\n\t\tdocument.addEventListener('click', wallClick)\r\n\t\tdocument.addEventListener('mousemove', handleDrag)\r\n\t\tdocument.addEventListener('mouseup', dragEnd)\r\n\t})\r\n\tinit()\r\n</script>\r\n\r\n<template>\r\n\t<div class=\"tablePrintModal\" :class=\"[customClass]\">\r\n\t\t<div class=\"msgL notPrint\" v-show=\"disabled\">{{ t('r.printGuide.9') }}</div>\r\n\t\t<div class=\"a4Line aL notPrint\" v-show=\"!disabled\"\r\n\t\t\t><p>{{ t('r.printGuide.7') }}</p> <p>{{ t('r.printGuide.5') }}</p></div\r\n\t\t>\r\n\t\t<div class=\"a4Line aR notPrint\" v-show=\"!disabled\"\r\n\t\t\t><p>{{ t('r.printGuide.7') }}</p> <p>{{ t('r.printGuide.6') }}</p></div\r\n\t\t>\r\n\t\t<div class=\"a4Line bL notPrint\" v-show=\"!disabled\"\r\n\t\t\t><p>{{ t('r.printGuide.8') }}</p> <p>{{ t('r.printGuide.5') }}</p></div\r\n\t\t>\r\n\t\t<div class=\"a4Line bR notPrint\" v-show=\"!disabled\"\r\n\t\t\t><p>{{ t('r.printGuide.8') }}</p> <p>{{ t('r.printGuide.6') }}</p></div\r\n\t\t>\r\n\t\t<div class=\"topsL notPrint\" v-show=\"!disabled\">\r\n\t\t\t<div class=\"topsLTitle\">{{ title || t('r.print') }}</div>\r\n\t\t\t<div class=\"topsLBtn\">\r\n\t\t\t\t<IconTxtBtn icon=\"md-help-circle\" :name=\"t('r.help')\" @click.stop=\"help = !help\" />\r\n\t\t\t\t<IconTxtBtn icon=\"md-print\" :name=\"t('r.preview')\" @click=\"print\" />\r\n\t\t\t\t<TableSetting v-if=\"!domPrint\" v-model=\"columns\" :s-key=\"sKey\" storage=\"sessionStorage\" />\r\n\t\t\t\t<TableIconBtn icon=\"md-close\" @click=\"close\" :title=\"t('r.close')\" />\r\n\t\t\t</div>\r\n\t\t\t<div class=\"topsLHelp\" v-show=\"help\">\r\n\t\t\t\t<p v-if=\"!domPrint\">\r\n\t\t\t\t\t<span>1. </span>\r\n\t\t\t\t\t<span>{{ t('r.printGuide.1') }}</span>\r\n\t\t\t\t</p>\r\n\t\t\t\t<p v-if=\"!domPrint\">\r\n\t\t\t\t\t<span>2. </span>\r\n\t\t\t\t\t<span>{{ t('r.printGuide.2') }}</span>\r\n\t\t\t\t</p>\r\n\t\t\t\t<p v-if=\"domPrint\">\r\n\t\t\t\t\t<span>1. </span>\r\n\t\t\t\t\t<span>{{ t('r.printGuide.10') }}</span>\r\n\t\t\t\t</p>\r\n\t\t\t\t<p>\r\n\t\t\t\t\t<span>{{ domPrint ? '2. ' : '3. ' }}</span>\r\n\t\t\t\t\t<span>{{ t('r.printGuide.3') }}</span>\r\n\t\t\t\t</p>\r\n\t\t\t\t<p>\r\n\t\t\t\t\t<span>{{ domPrint ? '3. ' : '4. ' }}</span>\r\n\t\t\t\t\t<span>{{ t('r.printGuide.4') }}</span>\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div v-if=\"domPrint\" class=\"domPrintSetting notPrint\" :style=\"domContainerStyle\">\r\n\t\t\t<div class=\"settingLine\" @mousedown.stop=\"dragStart\"></div>\r\n\t\t</div>\r\n\t\t<div v-if=\"domPrint\" class=\"domPrintContent\" v-html=\"tableData\" :style=\"domContainerStyle\"></div>\r\n\t\t<Table v-if=\"!domPrint\" class=\"tablePW\" :columns=\"columns\" :data=\"tableData\" border v-show=\"!disabled\" />\r\n\t</div>\r\n</template>\r\n","import { cloneDeep } from 'lodash-es'\r\nimport PrintModal from './PrintModal.vue'\r\nimport { myTypeof } from '../globalFunc'\r\n\r\nlet _router: any = null\r\n\r\nfunction addStyle() {\r\n\tconst root = document.documentElement\r\n\troot.style.setProperty('overflow', 'auto')\r\n\tconst style = document.createElement('style')\r\n\tstyle.innerHTML = `body,div[data-v-app]{height:100% !important}`\r\n\tdocument.head.appendChild(style)\r\n}\r\n\r\nfunction init(router: any) {\r\n\tif (router?.addRoute) {\r\n\t\tif (!router.hasRoute('tablePrint')) {\r\n\t\t\trouter.addRoute({\r\n\t\t\t\tname: 'tablePrint',\r\n\t\t\t\tpath: '/tablePrint/:isFrom',\r\n\t\t\t\tcomponent: PrintModal\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t_router = router\r\n\r\n\t//新打开的浏览器窗口，进入时，该打印插件还未完成初始化，所以打印路由还没加上去，无法直接进入打印页面，在这里路由添加后重新进入打印页面\r\n\tif (location.pathname.indexOf('tablePrint') > -1) {\r\n\t\t//vue-router history模式\r\n\t\t_router.push(location.pathname)\r\n\t\taddStyle()\r\n\t} else if (location.hash.indexOf('tablePrint') > -1) {\r\n\t\t//vue-router hash模式\r\n\t\t_router.push(location.hash.replace(/^#/, ''))\r\n\t\taddStyle()\r\n\t}\r\n}\r\n\r\nfunction columnsHandle(item: any) {\r\n\tif (myTypeof(item) === 'Object') {\r\n\t\titem.width = item.minWidth || 100\r\n\t\titem.sortable = false\r\n\t\tdelete item.minWidth\r\n\t\tdelete item.__id\r\n\t\titem.resizable = true\r\n\t\tif (item.children && myTypeof(item.children) === 'Array') {\r\n\t\t\titem.children = item.children.map(columnsHandle)\r\n\t\t}\r\n\t}\r\n\treturn item\r\n}\r\n\r\n/**\r\n * 供外部使用的打印API\r\n * @param {Array} columns Table的列设置，同view-design\r\n * @param {Array|String} data Table的数据\r\n * @param {String} title 标题(如打印为PDF将是默认文件名)\r\n * @param {Object} config 打印设置，目前支持：1.customClass,用于定制打印页面样式；2.autoPrint,是否直接打印\r\n */\r\nfunction print(columns: any[], data: any[] | string, title?: string, config?: Record<string, any>) {\r\n\tif (!_router) {\r\n\t\treturn\r\n\t}\r\n\tlet columnsB\r\n\tif (!config?.domPrint) {\r\n\t\tlet _columns = cloneDeep(\r\n\t\t\tcolumns.filter((e) => {\r\n\t\t\t\treturn e?.key || e?.children\r\n\t\t\t})\r\n\t\t)\r\n\t\tif (_columns[0].type === 'selection') {\r\n\t\t\t_columns.shift()\r\n\t\t}\r\n\t\tif (!_columns.length) {\r\n\t\t\tcolumnsB = []\r\n\t\t} else {\r\n\t\t\tcolumnsB = _columns.map(columnsHandle)\r\n\t\t}\r\n\t}\r\n\r\n\tlet _p = _router?.currentRoute?.value?.fullPath\r\n\tif (_p) {\r\n\t\t_p = _p.replace?.(/\\//g, '_')\r\n\t}\r\n\tlet _d: Record<string, any> = {\r\n\t\tdata,\r\n\t\ttitle,\r\n\t\tconfig\r\n\t}\r\n\tif (!config?.domPrint) {\r\n\t\t_d.columns = columnsB\r\n\t}\r\n\twindow.sessionStorage.setItem('print_' + _p, JSON.stringify(_d))\r\n\r\n\tconst r = _router.resolve({\r\n\t\tname: 'tablePrint',\r\n\t\tparams: { isFrom: _p }\r\n\t})\r\n\r\n\tlet _w = window.open(r?.href, '_blank')\r\n\tif (!_w) {\r\n\t\tconsole.log('请不要禁用浏览器弹出窗口，否则无法正常使用该打印功能。')\r\n\t}\r\n}\r\n\r\n/**\r\n * @created 2024.03.14\r\n * @author Ricky email:zhangqingcq@foxmail.com\r\n * @description 表格打印，可以在预览页面调整每列宽度以及可以选择打印的列\r\n * 注意：1.该插件依赖于vue-router，需要在安装库时传入router，详见该库使用说明文档；\r\n * 2.打印时会新开一个浏览器窗口，路由为'/tablePrint'，该路由页面需要铺满浏览器窗口，即该路由所在的router-view外部\r\n * 不应有任何dom元素渲染在页面上（隐藏的多余dom元素不影响打印）。\r\n * 3.由于内容较多时需要分页打印，所以需要在打印页面的html、body、div[data-v-app]上添加样式，该插件会自动添加这些样式，\r\n * 如果页面这些dom节点已经存在类似样式，该插件会覆盖已存在的样式（只会影响打印页面，无需担心其他页面被污染）\r\n * 4.虽然插件有调节列宽的功能，但为了用户使用方便，开发人员应该在columns里设置好适合的列宽（minWidth或width）,\r\n * 让打印页面打开时就具备较好的打印布局效果。\r\n */\r\nconst tablePrint = {\r\n\tprint,\r\n\tinit\r\n}\r\n\r\nexport default tablePrint\r\n","import tablePrint from './tablePrint'\r\n\r\n/**\r\n * @description 打印Dom(网页指定的内容)\r\n * @param {String} data 要打印的dom数据，一般使用dom操作获取dom，然后将其outerHTML作为data传进去就行\r\n * @param {String} title 标题(如打印为PDF将是默认文件名)\r\n * @param {Object} config 打印设置，目前支持：1.customClass,用于定制打印页面样式；2.autoPrint,是否直接打印；3.width,dom容器宽度（打印内容将放在这个容器进行打印）\r\n * 注意：\r\n * 1.data只是dom,要打印出带样式的dom，需要将要打印的dom相关样式设置成全局样式，而且这些样式无需进入调用打印的页面即可生效。\r\n * 2.不要限制要打印的dom的高度（实在需要限制可在原来的页面写成局部样式，不要影响打印页面高度），否则无法正常分页打印出全部内容。\r\n */\r\nfunction _p(data: string = '', title: string = '', config: Record<string, any> = {}) {\r\n\tconfig.domPrint = true\r\n\tif (!config.width) {\r\n\t\tconfig.width = 715\r\n\t}\r\n\ttablePrint.print([], data, title, config)\r\n}\r\n\r\nexport default _p\r\n","/**\r\n * @description 全屏预览\r\n * @author ricky zhangqingcq@foxmail.com\r\n * @created 2023.08.24\r\n * 注意：不能全局调整Modal弹框尺寸，否则预览图片可能不居中，推荐使用另一个插件fullScreenImgByDom\r\n */\r\n\r\nimport { Modal, Icon } from 'view-ui-plus'\r\nimport { t } from '../locale'\r\nimport { h } from 'vue'\r\nimport { setTimeout } from './timer'\r\n\r\nexport default function fullScreenImgPreview(this: any, src: string) {\r\n\tconst T = (...arg: Parameters<typeof t>) => t.apply(this, arg)\r\n\tconst close = T('r.closePreview')\r\n\tconst fullImg = T('r.fullImg')\r\n\r\n\tlet id = 'previewImg' + Math.floor(Math.random() * 10000000)\r\n\tModal?.info?.({\r\n\t\tclosable: false,\r\n\t\t'transition-names': ['linear', 'fade'],\r\n\t\trender: (_h: any) => {\r\n\t\t\treturn h(\r\n\t\t\t\t'div',\r\n\t\t\t\t{\r\n\t\t\t\t\tclass: 'previewModal',\r\n\t\t\t\t\tid: id\r\n\t\t\t\t},\r\n\t\t\t\t[\r\n\t\t\t\t\th(\r\n\t\t\t\t\t\t'div',\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tclass: 'previewModalInner'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\th('img', {\r\n\t\t\t\t\t\t\t\tsrc: src,\r\n\t\t\t\t\t\t\t\talt: fullImg\r\n\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\th(Icon, {\r\n\t\t\t\t\t\t\t\ttype: 'md-close',\r\n\t\t\t\t\t\t\t\ttitle: close,\r\n\t\t\t\t\t\t\t\tclass: 'previewModalDelete',\r\n\t\t\t\t\t\t\t\tonClick() {\r\n\t\t\t\t\t\t\t\t\tModal?.remove?.()\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t)\r\n\t\t\t\t]\r\n\t\t\t)\r\n\t\t}\r\n\t})\r\n\r\n\tsetTimeout(() => {\r\n\t\tconst hideEl = document.getElementById(id)?.parentElement?.parentElement?.parentElement?.parentElement\r\n\t\tconst hideEl2 = document.getElementById(id)?.parentElement?.nextSibling as HTMLElement\r\n\t\thideEl && (hideEl.style.height = '0')\r\n\t\thideEl && (hideEl.style.padding = '0')\r\n\t\thideEl2 && (hideEl2.style.display = 'none')\r\n\t}, 10)\r\n}\r\n","import { Boot } from '@wangeditor/editor'\r\nimport { t } from '../locale'\r\n;(() => {\r\n\tif (window.wangeditorMenuInit) {\r\n\t\treturn\r\n\t}\r\n\r\n\tclass PreviewButton {\r\n\t\ttitle: string\r\n\t\ticonSvg: string\r\n\t\ttag: string\r\n\t\talwaysEnable: boolean\r\n\r\n\t\tconstructor() {\r\n\t\t\tthis.title = t('r.preview')\r\n\t\t\tthis.iconSvg =\r\n\t\t\t\t'<svg t=\"1656644788547\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"12356\" width=\"256\" height=\"256\"><path d=\"M512 1024H135.4C60.7 1024 0 963.3 0 888.6V135.4C0 60.7 60.7 0 135.4 0h753.2C963.3 0 1024 60.7 1024 135.4V512c0 24.9-20.1 45-45 45s-45-20.1-45-45V135.4c0-25-20.4-45.4-45.4-45.4H135.4c-25 0-45.4 20.4-45.4 45.4v753.2c0 25 20.4 45.4 45.4 45.4H512c24.9 0 45 20.1 45 45s-20.1 45-45 45z\" p-id=\"12357\"></path><path d=\"M512 802c-77.5 0-150.3-30.2-205.1-84.9C252.2 662.3 222 589.5 222 512s30.2-150.3 84.9-205.1S434.5 222 512 222s150.3 30.2 205.1 84.9C771.8 361.7 802 434.5 802 512s-30.2 150.3-84.9 205.1C662.3 771.8 589.5 802 512 802z m0-490c-110.3 0-200 89.7-200 200s89.7 200 200 200 200-89.7 200-200-89.7-200-200-200z\" p-id=\"12358\"></path><path d=\"M978.5 1023.5c-11.5 0-23-4.4-31.8-13.2L653.2 716.8c-17.6-17.6-17.6-46.1 0-63.6 17.6-17.6 46.1-17.6 63.6 0l293.5 293.5c17.6 17.6 17.6 46.1 0 63.6-8.8 8.8-20.3 13.2-31.8 13.2z\" p-id=\"12359\"></path></svg>'\r\n\t\t\tthis.tag = 'button'\r\n\t\t\tthis.alwaysEnable = true\r\n\t\t}\r\n\r\n\t\tgetValue() {\r\n\t\t\treturn ''\r\n\t\t}\r\n\r\n\t\tisActive() {\r\n\t\t\treturn false\r\n\t\t}\r\n\r\n\t\tisDisabled() {\r\n\t\t\treturn false\r\n\t\t}\r\n\r\n\t\texec(d: any) {\r\n\t\t\tconst e = document.getElementById('editor-preview')\r\n\t\t\tlet _w = localStorage.getItem('editorPreviewW') || 300\r\n\t\t\tlet _h = localStorage.getItem('editorPreviewH') || 500\r\n\t\t\tconst contentR = d?.getHtml?.()\r\n\r\n\t\t\tif (e) {\r\n\t\t\t\tlet wallE = e.children?.[0]?.children?.[1]?.children?.[0] as HTMLElement\r\n\t\t\t\tlet outWallE = e.children?.[0]?.children?.[1] as HTMLElement\r\n\t\t\t\tif (wallE) {\r\n\t\t\t\t\twallE.innerHTML = contentR\r\n\t\t\t\t\twallE.style.width = _w + 'px'\r\n\t\t\t\t}\r\n\t\t\t\tif (outWallE) {\r\n\t\t\t\t\toutWallE.style.height = _h + 'px'\r\n\t\t\t\t}\r\n\t\t\t\te.style.display = 'block'\r\n\t\t\t} else {\r\n\t\t\t\tconst body = document.body\r\n\t\t\t\tconst p = document.createElement('div')\r\n\t\t\t\tp.setAttribute('id', 'editor-preview')\r\n\t\t\t\tp.setAttribute('class', 'editor-preview-mask')\r\n\t\t\t\tp.innerHTML = `<div class='editor-preview-body'><div class='editor-preview-head'><div><span>宽</span><input type='number' value='${_w}' min='200'><span>高</span><input type='number' value='${_h}' min='300'></div><i class='ivu-icon ivu-icon-md-close'></i></div><div class='editor-preview-out-wall'><div class='editor-preview-wall r-editor-view'></div></div></div>`\r\n\t\t\t\tlet outWallE = p.children[0].children[1] as HTMLElement\r\n\t\t\t\tlet wallE = p.children[0].children[1].children[0] as HTMLElement\r\n\r\n\t\t\t\tlet inputW = p.children[0].children[0].children[0].children[1] as HTMLElement\r\n\r\n\t\t\t\tconst spaceW = 40\r\n\t\t\t\tconst spaceH = 70\r\n\r\n\t\t\t\tconst wHandler = (e: any) => {\r\n\t\t\t\t\tif (e?.type === 'keyup') {\r\n\t\t\t\t\t\tlet notEnter = false\r\n\t\t\t\t\t\tif (e.key) {\r\n\t\t\t\t\t\t\tnotEnter = e.key !== 'Enter'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (notEnter) {\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet val = e?.target?.value\r\n\t\t\t\t\tval = Number(val)\r\n\t\t\t\t\tif (wallE.style && wallE.style.width === val + 'px') {\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst bodyW = body.clientWidth\r\n\r\n\t\t\t\t\tif (val < 250) {\r\n\t\t\t\t\t\tval = 250\r\n\t\t\t\t\t\te.target.value = 250\r\n\t\t\t\t\t} else if (val > bodyW - spaceW) {\r\n\t\t\t\t\t\tval = bodyW - spaceW\r\n\t\t\t\t\t\te.target.value = bodyW - spaceW\r\n\t\t\t\t\t}\r\n\t\t\t\t\twallE.style.width = val + 'px'\r\n\t\t\t\t\tlocalStorage.setItem('editorPreviewW', val)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tinputW.addEventListener('blur', wHandler)\r\n\t\t\t\tinputW.addEventListener('keyup', wHandler)\r\n\t\t\t\tlet inputH = p.children[0].children[0].children[0].children[3]\r\n\r\n\t\t\t\tconst hHandler = (e: any) => {\r\n\t\t\t\t\tif (e?.type === 'keyup') {\r\n\t\t\t\t\t\tlet notEnter = false\r\n\t\t\t\t\t\tif (e.key) {\r\n\t\t\t\t\t\t\tnotEnter = e.key !== 'Enter'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (notEnter) {\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet val = e?.target?.value\r\n\t\t\t\t\tval = Number(val)\r\n\r\n\t\t\t\t\tif (outWallE.style && outWallE.style.height === val + 'px') {\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst bodyH = body.clientHeight\r\n\r\n\t\t\t\t\tif (val < 300) {\r\n\t\t\t\t\t\tval = 300\r\n\t\t\t\t\t\te.target.value = 300\r\n\t\t\t\t\t} else if (val > bodyH - spaceH) {\r\n\t\t\t\t\t\tval = bodyH - spaceH\r\n\t\t\t\t\t\te.target.value = bodyH - spaceH\r\n\t\t\t\t\t}\r\n\t\t\t\t\toutWallE.style.height = val + 'px'\r\n\t\t\t\t\tlocalStorage.setItem('editorPreviewH', val)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tinputH.addEventListener('blur', hHandler)\r\n\t\t\t\tinputH.addEventListener('keyup', hHandler)\r\n\t\t\t\tlet closeE = p.children[0].children[0].children[1]\r\n\t\t\t\tcloseE.addEventListener('click', () => {\r\n\t\t\t\t\tp.style.display = 'none'\r\n\t\t\t\t})\r\n\r\n\t\t\t\twallE.innerHTML = contentR\r\n\t\t\t\twallE.style.width = _w + 'px'\r\n\t\t\t\toutWallE.style.height = _h + 'px'\r\n\t\t\t\tbody.append(p)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst configP = {\r\n\t\tkey: 'previewX',\r\n\t\tfactory() {\r\n\t\t\treturn new PreviewButton()\r\n\t\t}\r\n\t}\r\n\r\n\tBoot.registerMenu(configP)\r\n\twindow.wangeditorMenuInit = true\r\n})()\r\n","/**\r\n * @description plug-r-qw 源代码入口文件\r\n * @author Ricky email:zhangqingcq@foxmail.com\r\n * @created 2023.04.27\r\n */\r\n\r\nimport type { App } from 'vue'\r\nimport * as components from './components'\r\nimport * as globalFunc from './utils/globalFunc'\r\nimport * as outFunc from './utils/output'\r\nimport localeFile from './locale'\r\n\r\nimport { init } from './utils/timer'\r\nimport { set } from './utils/amap'\r\nimport './utils/wangeditor5init'\r\nimport JsonView from 'vue-json-viewer'\r\nimport clickOutside from './directives/clickOutside'\r\n\r\nexport * from './components'\r\nexport * from './utils/globalFunc'\r\nexport * from './utils/needImportFunc'\r\nexport * from './utils/output'\r\n\r\nexport const locale = localeFile.use\r\nexport const i18n = localeFile.i18n\r\n\r\nconst methodsR: Record<string, any> = {\r\n\t...outFunc,\r\n\t...globalFunc\r\n}\r\n\r\nexport interface plugROption {\r\n\tnotRegistryGlobal?: boolean\r\n\tstore?: any\r\n\tuseStore?: any\r\n\trouter?: Record<keyof any, any>\r\n\tlocale?: Record<keyof any, any>\r\n\ti18n?: Record<keyof any, any>\r\n\tamap?: { securityJsCode: string; key: string }\r\n\r\n\t[k: keyof any]: any\r\n}\r\n\r\nexport const install = function (app: App, options: plugROption = {}) {\r\n\toutFunc.$fetch.init(options.useStore || options.store, app)\r\n\r\n\tapp.use(JsonView)\r\n\r\n\tif (options.locale) {\r\n\t\tlocaleFile.use(options.locale)\r\n\t}\r\n\r\n\tif (options.i18n) {\r\n\t\tlocaleFile.i18n(options.i18n)\r\n\t}\r\n\r\n\tif (options.router) {\r\n\t\tinit(options.router)\r\n\t\toutFunc.tablePrint.init(options.router)\r\n\t}\r\n\r\n\tif (options.amap) {\r\n\t\tset(options.amap)\r\n\t}\r\n\r\n\tif (!options.notRegistryGlobal) {\r\n\t\tObject.keys(components).forEach((key) => {\r\n\t\t\tif (!app.component(key)) {\r\n\t\t\t\tapp.component(key, (components as Record<string, any>)[key])\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tObject.keys(methodsR).forEach((key) => {\r\n\t\t\tapp.config.globalProperties[key] = methodsR[key]\r\n\t\t})\r\n\t}\r\n\r\n\tif (!app.directive('has')) {\r\n\t\tapp.directive('has', (el, binding) => {\r\n\t\t\tif (binding.value && !globalFunc.hasPermission(binding.value)) {\r\n\t\t\t\tel.style.display = 'none'\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\tif (!app.directive('loadmore')) {\r\n\t\t//select下拉滚动监听事件 可通过指令参数传递class来指定容器\r\n\t\tapp.directive('loadmore', {\r\n\t\t\tmounted(el, binding) {\r\n\t\t\t\t// 获取定义好的scroll盒子\r\n\t\t\t\tlet SELECT_DOM: any = el\r\n\r\n\t\t\t\tif (binding.arg) {\r\n\t\t\t\t\tSELECT_DOM = document.getElementsByClassName(binding.arg)?.[0]\r\n\t\t\t\t}\r\n\t\t\t\tif (!SELECT_DOM) {\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tSELECT_DOM.addEventListener('scroll', function () {\r\n\t\t\t\t\t/*\r\n\t\t\t\t\t * scrollHeight 获取元素内容高度(只读)\r\n\t\t\t\t\t * scrollTop 获取或者设置元素的偏移值,常用于, 计算滚动条的位置, 当一个元素的容器没有产生垂直方向的滚动条, 那它的scrollTop的值默认为0.\r\n\t\t\t\t\t * clientHeight 读取元素的可见高度(只读)\r\n\t\t\t\t\t * 如果元素滚动到底, 下面等式返回true, 没有则返回false:\r\n\t\t\t\t\t * ele.scrollHeight - ele.scrollTop === ele.clientHeight;\r\n\t\t\t\t\t */\r\n\t\t\t\t\tif (SELECT_DOM.scrollTop > 0 && SELECT_DOM.scrollHeight - SELECT_DOM.scrollTop <= SELECT_DOM.clientHeight) {\r\n\t\t\t\t\t\tbinding.value()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\tif (!app.directive('clickOutside')) {\r\n\t\tapp.directive('clickOutside', clickOutside)\r\n\t}\r\n\r\n\t//库基础字号(应跟你项目设置的view-design基础字号一样)，影响范围：iconTxtBtn的txt与icon的尺寸比例、fullPop的headerFontSize默认值、pagePro的current输入框尺寸。\r\n\tapp.config.globalProperties.fontSizeBase = 14\r\n\t// 搜索表单默认label宽度\r\n\tapp.config.globalProperties.searchFormLabelWidth = 84\r\n\t// 搜索表单默认表单项内容宽度\r\n\tapp.config.globalProperties.searchFormItemWidth = 202\r\n\t// 弹框表单默认label宽度\r\n\tapp.config.globalProperties.formModalLabelWidth = 140\r\n\t// 弹框表单默认宽度\r\n\tapp.config.globalProperties.formModalWidth = 520\r\n\t// 页内表单默认label宽度\r\n\tapp.config.globalProperties.formGroupLabelWidth = 160\r\n\t// 页内表单默认宽度\r\n\tapp.config.globalProperties.formGroupWidth = '100%'\r\n\t// iconTxtBtn默认图标大小\r\n\tapp.config.globalProperties.iconTxtBtnIconSize = 17\r\n\t// 页签每页可选条数默认配置\r\n\tapp.config.globalProperties.pageSizes = [10, 20, 50, 100]\r\n\t// btTablePage是否默认使用pagePro组件作为页签，还会影响transferBox\r\n\tapp.config.globalProperties.btTablePageUsePagePro = true\r\n\t// btTablePage表格内容默认对齐方式\r\n\tapp.config.globalProperties.btTablePageAlign = 'center'\r\n\t// pagePro和page是否默认展示total，还会影响btTablePage、transferBox\r\n\tapp.config.globalProperties.pageShowTotal = true\r\n\t// pagePro和page是否默认展示sizer，还会影响btTablePage、transferBox\r\n\tapp.config.globalProperties.pageShowSizer = true\r\n\t// tableSetting默认背景色\r\n\tapp.config.globalProperties.tableSettingBg = '#fff'\r\n\t// tableSetting默认transfer\r\n\tapp.config.globalProperties.tableSettingTransfer = true\r\n\t// tableSetting默认eventsEnabled\r\n\tapp.config.globalProperties.tableSettingEventsEnabled = true\r\n}\r\n\r\nconst plugRQw = { install }\r\n\r\nexport default plugRQw\r\n"],"names":["zhLang","REG_NAME","Format","hasOwn","obj","key","template","string","a","args","match","prefix","i","index","result","format","lang","message","nowLang","merged","vueI18n","i18nHandler","path","options","localMessage","newLocalMessage","deepmerge","t","value","array","current","j","property","localeFile","initI18n","proxy","getCurrentInstance","props","__props","emit","__emit","click","Proxy","appContext","showPop","ref","hFontSize","computed","popStyle","open","close","getData","__expose","msg","txtSize","_a","e","router","back","$swal","option","text","icon","closeOnClickOutside","T","arg","r","okTxt","cancelTxt","cancelVisible","okClass","cancelClass","reg","myTypeof","swal","res","err","spanRef","contentRef","tooltipDisabled","debounceFunc","maxWidth","getSize","$span","range","rangeWidth","onMounted","debounce","nextTick","onUpdated","onUnmounted","isClient","setValue","target","isRef","v","has","hasPermission","toLine","name","trimObj","p","o","l","clearObj","val","ignoreList","item","go","formDataHeadConfig","toFormData","data","temp","findCollection","group","condition","getPath","PATH","deepSearch","oneOf","validList","decimalDigitsLimit","num","expStr","valStr","downloadFileByFormSubmit","url","method","form","body","_url","httpEnv","regExp","isPlainObject","input","ta","fileExport","getColumnsKeys","sKey","columns","returnArray","names","isValidValue","isNumberValue","tooltipManual","contentKey","dash","jointMark","_h","params","content","_b","h","TableTooltip","isEmptyValue","stringLength","str","setValByOption","childKey","btnPermissions","isNaN","dataFilterOrToUrl","toUrl","keepEmptyVal","_data","removeEmptyValue","htmlPrint","pWin","siblingElems","elem","nodes","_elem","useRouter","getClass","handleClick","parent","siblings","child","_g","route","useRoute","menuDisplay","pathName","menuRef","titleC","typeIco","onBeforeMount","watch","after","addOpen","showHideMenu","_c","_e","_d","onClick","show","_useModel","getBg","d","timeoutBox","intervalBox","init","setTimeout","fn","time","handler","setInterval","isDebounce","openX","iconL","onSearch","clickOutside","el","binding","documentHandler","$swalConfirm","title","onOk","buttonRef","popperRef","indeterminate","checkAll","groupT","groupX","unknown","cloneDeep","disabledGroup","checkAllGroup","subV","locale","_popper","localStr","getStorage","Popper","c","calcPopperHeight","needChange","height","onBeforeUnmount","checkAllGroupChange","getChange","SwalConfirm","save","labelClick","clickOutsideHandle","event","$el","handleCheckAll","toHump","all","letter","htmlEncode","htmlDecode","html","getFileSrc","file","resolve","reader","getFileTypeByName","isImgByFile","type","getFileTypeIconByName","downloadFileReaderFile","href","saveLink","fakeALinkClick","ev","findPath","pathKey","isObject","isFunction","isEmpty","rr","getStringWidth","fontSize","nodesH","width","emptyInput","stopBubbling","loading","messageBox","onCancel","onClose","okText","cancelText","noWarnIcon","footerAlign","cancelBt","heightT","stringContent","functionContent","Modal","Button","_i","_f","count","loader","toggleSpin","counts","host","service","axios","notInitYet","q","logoutHandle","store","checkResult","rPath","config","y","handleRequest","isUrlData","s","keyT","checkRequest","url_","data_","method_","$fetch","app","pageRef","_fontSizeBase","currentPadding","pageSizeT","currentSize","changeCurrentSize","getPadding","$inputEl","inputStyle","paddingL","paddingR","tableContainerHeight","TableColumnConfig","pageSizes","dataT","total","selected","currentKey","currentIndex","_key","_order","columnsFixed","fixedTable","queryData","columnsT","Radio","td","dataS","selectedIds","selectedKeys","tableRef","search","getDataAndClickRow","initTable","addRow","row","setRowData","setCurrentRow","clickCurrentRow","deleteRow","onRowClick","onSelect","selectionHandle","selection","getSelected","changePage","pageSizeChange","onSortChange","order","getTableData","selectRow","predicate","_p","clearSelect","clearTableData","orderKey","keepSelect","selectVal","inputVal","labelSelectStyle","inputChange","handleChange","_amap","set","securityJsCode","get","valueT","widthT","isNumber","containerStyle","mapStyle","Map","GeoCoder","createMarker","mapId","mapInputRef","mapRef","infoWindow","checkHeight","initMap","AMap","AMapLoader","_map","iEl","center","lng","lat","point","marker","getAddress","dragPoint","status","dataC","valProp","isString","last","isEqual","dataFilter","tt","labels","onChange","selectedDetail","label","lv1","lv2","code","_index","domHandle","src","imgEl","nameEl","lastImg","arrSrc","nextImg","fullScreenImgByDom","fullImg","next","notice","_src","_name","bodyEl","first","closeHandler","bb","keyupHandler","fileSrcList","shallowRef","fileDefaultList","localImgSrcList","tempStorage","previewType","fileListItemIsIMG","urlT","fileList","fileIdList","fileDefaultImgList","fileImgSrcList","localImgList","getFileSrcList","_fileDefaultList","fileT","find","indexOf","triggerRef","getName","clearManualItem","downloadDefaultFile","showPreview","listExpand","findIndex","downloadManualFile","handelManualUpload","uploadError","error","uploadSuccess","response","_fileList","overSize","onFormatError","onPreview","id","onRemove","deleteById","_fileIdList","openA","openB","mouseOver","valueA","valueB","mPickerRef","clear","focus","changeA","changeB","_editor","toolbarConfigT","editorConfigT","insertFn","n","u","editorTextareaStyle","onCreated","selectContentWidth","itemClass","root","itemChange","reValidateAndChangeHandle","onSelectInputChange","alNameChange","asyncLabelChange","formGroupXRef","valGroup","formDataT","tempKeys","watchGroup","mgrUrl","selectInputKeys","hiddenKeys","showLoading","formReRenderKey","uploadUrl","debounceCount","formTeam","formStyle","itemStyle","formRulesT","tr","k","submitKeys","submitItems","showingKeys","showingItems","getSlotFormData","resetForm","clearForm","refreshFormDom","reRenderForm","f","initValGroup","initFormDataT","defaultV","getDefaultValues","formItem","clearTempKeys","clearTempKeyItem","defaultValItems","getTempKeyDefaultVal","getFormItemIfVal","returnIfVal","dealIfItem","x","tempKeysWatchHandle","box","initItems","tempKeyF","tempKeyE","tempKeyD","cp","tUrl","vT","tV","initOption","recoverVal","toRef","tempKeyC","tempKeyB","itemVal","tOption","eP","rP","rL","lVal","tC","iP","toValue","initValItems","targetOption","findOptions","collectTempKey","findTempKey","sameKeyCom","tp","fm","moment","findTempKeyItem","setItemToValGroup","notClearOthers","updateValGroup","kk","getValidateKeys","getValidateItems","updateTempKeys","validateFields","updateTempKeyItem","updateFormDataT","changeDataHandle","indexB","remove","getValGroup","validate","reValidate","prop","changeLoading","submit","valid","formGroupStyle","formRRef","formDataC","onSubmit","openModal","handleVisibleChange","initTree","valueE","collectValT","initData","changeStyle","checked","keyI","initDataB","renderContent","classA","isLeaf","ii","arr","grandParent","br","updateVal","valT","searchDataLeft","searchDataRight","lSelection","rSelection","leftTotal","rightTotal","leftTableSearchData","rightTableSearchData","delAllDis","deleteDis","addDis","addAllDis","leftFormRef","rightFormRef","lTabRef","rTabRef","reset","lSelectionChange","rSelectionChange","dataChangeL","dataChangeR","searchLeft","searchRight","add","fetchX","addAll","removeAll","action","leafChecked","valTemp","checkCount","secItem","valIndex","len","equalI","collectKey","before","isCheck","updateDataT","getLeafChecked","ttO","indeterminateCount","checkCountB","thirdItem","checkChangeFirst","itemB","checkChangeSecond","wellStyle","pages","searchStr","historyData","isFresh","urlChanged","transferClass","placeholderT","searchDataT","selectScrollSourceRef","addInputEventListener","getOption","isSelect","loadMore","Message","reject","labelT","eT","hash","disabled","domPrint","autoPrint","help","isFrom","customClass","tableData","isDrag","domContainerStyle","wallClick","dragStart","handleDrag","dragEnd","print","tc","_router","addStyle","style","PrintModal","columnsHandle","columnsB","_columns","tablePrint","fullScreenImgPreview","Icon","hideEl","hideEl2","PreviewButton","__publicField","_w","contentR","wallE","outWallE","inputW","spaceW","spaceH","wHandler","notEnter","bodyW","inputH","hHandler","bodyH","configP","Boot","i18n","methodsR","outFunc","globalFunc","install","outFunc.$fetch","JsonView","outFunc.tablePrint","components","globalFunc.hasPermission","SELECT_DOM","plugRQw"],"mappings":"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"}