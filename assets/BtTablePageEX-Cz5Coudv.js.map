{"version":3,"file":"BtTablePageEX-Cz5Coudv.js","sources":["../../examples/views/BtTablePageEX.vue"],"sourcesContent":["<script setup lang=\"ts\">\n\timport { cloneDeep } from 'lodash-es'\n\timport { Radio, RadioGroup, Checkbox, CheckboxGroup } from 'view-ui-plus'\n\timport {\n\t\tdownloadFileReaderFile,\n\t\t$swal,\n\t\tmessageBox,\n\t\t$fetch,\n\t\tsetTimeout,\n\t\tBtTablePage,\n\t\tIconTxtBtn,\n\t\tFormModal,\n\t\tTableIconBtn,\n\t\ttablePrint,\n\t\ttooltipManual,\n\t\thas\n\t} from '../../src'\n\timport imgK from '../assets/testImg.png'\n\timport ShowReadMe from '@/components/ShowReadMe.vue'\n\timport NodeServeInfo from '@/components/NodeServeInfo.vue'\n\n\tconst formModalRef = ref()\n\tconst btTab = ref()\n\tconst action = ref('new')\n\tconst nodeServer = ref(false)\n\tconst selectMode = ref('radio')\n\tconst total = ref(0)\n\tconst searchData = ref<Record<string, any>>({})\n\tlet tabData: any = []\n\tconst columns = [\n\t\t{\n\t\t\ttitle: 'ID',\n\t\t\tkey: 'id',\n\t\t\twidth: 80\n\t\t},\n\t\t{\n\t\t\ttitle: '文件名称',\n\t\t\tkey: 'name',\n\t\t\tminWidth: 250,\n\t\t\ttooltip: true,\n\t\t\trender: (_h: any, params: Record<string, any>) => {\n\t\t\t\treturn _h(\n\t\t\t\t\t'span',\n\t\t\t\t\t{\n\t\t\t\t\t\tclass: 'link',\n\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\tdownloadFileReaderFile('模拟文件下载', imgK)\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ttooltipManual('name', true)(_h, params)\n\t\t\t\t)\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\ttitle: '文件类型',\n\t\t\tminWidth: 120,\n\t\t\tkey: 'mimeType'\n\t\t},\n\t\t{\n\t\t\ttitle: '文件大小',\n\t\t\tminWidth: 100,\n\t\t\tkey: 'size'\n\t\t},\n\t\t{\n\t\t\ttitle: '备注',\n\t\t\tminWidth: 200,\n\t\t\tkey: 'remark'\n\t\t},\n\t\t{\n\t\t\ttitle: '操作',\n\t\t\twidth: 240,\n\t\t\trender: (_h: any, params: Record<string, any>) => {\n\t\t\t\treturn _h('div', [\n\t\t\t\t\t//view-ui-plus render函数实现 v-has 同等效果示例\n\t\t\t\t\t_h('span', { ...has('abc') }, '123'),\n\t\t\t\t\t_h(TableIconBtn, {\n\t\t\t\t\t\ticon: 'ios-create',\n\t\t\t\t\t\ttitle: '编辑',\n\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\tif (nodeServer.value) {\n\t\t\t\t\t\t\t\taction.value = 'edit'\n\t\t\t\t\t\t\t\tformModalRef.value.updateValGroup(params.row)\n\t\t\t\t\t\t\t\tformModalRef.value.setItemToValGroup({ id: params.row.id }, true)\n\t\t\t\t\t\t\t\tformModalRef.value.open()\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$swal('提示', '仅在node-serve模式下可执行编辑', 'info')\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\t_h(TableIconBtn, {\n\t\t\t\t\t\ticon: 'ios-trash',\n\t\t\t\t\t\ttitle: '删除',\n\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\tmessageBox({\n\t\t\t\t\t\t\t\tcontent: '确定模拟执行删除操作？',\n\t\t\t\t\t\t\t\tonOk: () => {\n\t\t\t\t\t\t\t\t\tif (nodeServer.value) {\n\t\t\t\t\t\t\t\t\t\t$fetch.delete('/node-serve/bt-table-page', { id: params.row.id }).then((r: any) => {\n\t\t\t\t\t\t\t\t\t\t\tif (r?.code === 0) {\n\t\t\t\t\t\t\t\t\t\t\t\t$swal('删除成功', '', 'success')\n\t\t\t\t\t\t\t\t\t\t\t\tgetData()\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t$swal('删除失败', '', 'error')\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\t\t$swal('成功', '假装删除成功', 'success')\n\t\t\t\t\t\t\t\t\t\t}, 500)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t])\n\t\t\t}\n\t\t}\n\t]\n\tconst formData = [\n\t\t{\n\t\t\ttype: 'txt',\n\t\t\tval: '正常的文件系统应该是上传文件，我们这里只是演示btTablePage使用方法，手动填写这些字段就行',\n\t\t\tlabel: '说明'\n\t\t},\n\t\t{\n\t\t\ttype: 'input',\n\t\t\tkey: 'name',\n\t\t\tlabel: '文件名称'\n\t\t},\n\t\t{\n\t\t\ttype: 'inputNumber',\n\t\t\tkey: 'size',\n\t\t\tlabel: '文件大小',\n\t\t\tmin: 0\n\t\t},\n\t\t{\n\t\t\ttype: 'input',\n\t\t\tkey: 'mimeType',\n\t\t\tlabel: '文件类型'\n\t\t},\n\t\t{\n\t\t\ttype: 'textarea',\n\t\t\tkey: 'remark',\n\t\t\tlabel: '备注'\n\t\t}\n\t]\n\tconst formRules = {\n\t\tname: {\n\t\t\trequired: true\n\t\t},\n\t\tsize: {\n\t\t\trequired: true\n\t\t},\n\t\tmimeType: {\n\t\t\trequired: true\n\t\t}\n\t}\n\n\tconst url = computed(() => {\n\t\treturn nodeServer.value ? '/node-serve/bt-table-page' : '/testData/btTablePage.json'\n\t})\n\tconst title = computed(() => {\n\t\treturn action.value === 'new' ? '新增' : '编辑'\n\t})\n\tconst method = computed(() => {\n\t\treturn action.value === 'new' ? 'post' : 'put'\n\t})\n\n\tlet tt = ref<number[]>([])\n\tlet tr: number | null = null\n\n\tfunction dragDrop(a: any, b: any) {\n\t\tlet d = btTab.value.dataS\n\t\t//提出a\n\t\tlet t = d.splice(a, 1)\n\t\t//将a插到b后面\n\t\td.splice(b, 0, ...t)\n\t\tnextTick(function () {\n\t\t\tbtTab.value.dataS = d\n\t\t})\n\t}\n\n\tfunction clearSelect() {\n\t\tbtTab.value.clearSelect()\n\t}\n\n\tfunction handleNew() {\n\t\tif (nodeServer.value) {\n\t\t\taction.value = 'new'\n\t\t\tformModalRef.value.open()\n\t\t} else {\n\t\t\t$swal('提示', '仅在node-serve模式下可执行新增', 'info')\n\t\t}\n\t}\n\n\tfunction handleSub(d: Record<string, any>) {\n\t\tif (d) {\n\t\t\t$fetch[method.value]('/node-serve/bt-table-page', d).then((r: any) => {\n\t\t\t\tif (r?.code === 0) {\n\t\t\t\t\t$swal(title.value + '成功', '', 'success')\n\t\t\t\t\tif (action.value === 'new') {\n\t\t\t\t\t\tsearch()\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbtTab.value.getDataAndClickRow(true)\n\t\t\t\t\t}\n\t\t\t\t\tformModalRef.value.close()\n\t\t\t\t} else {\n\t\t\t\t\t$swal(title.value + '失败', '', 'error')\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\tfunction getData() {\n\t\tnextTick(function () {\n\t\t\tbtTab.value.getTableData()\n\t\t})\n\t}\n\n\tfunction getS() {\n\t\tconsole.log(btTab.value.getSelected())\n\t\t$swal('请在控制台查看已选数据', '', 'success')\n\t}\n\n\tfunction search(data?: Record<string, any>) {\n\t\tif (!data) {\n\t\t\tdata = {}\n\t\t}\n\t\tsearchData.value = cloneDeep(data)\n\t}\n\n\tfunction onRowClick(row: Record<string, any>, index: number) {\n\t\tconsole.log('row click-->', row, index)\n\t}\n\n\tfunction setTotal(d: any) {\n\t\ttotal.value = d?.total || d?.data?.total || 0\n\t\ttabData = d?.data?.records || d?.data || []\n\t}\n\n\tfunction handlePrint() {\n\t\ttablePrint.print(columns, tabData, '表格打印示例', { autoPrint: true })\n\t}\n\n\tfunction messageRender(_h: any) {\n\t\tlet _c = []\n\t\tconst _r = selectMode.value === 'radio'\n\t\tfor (let i = 0; i < tabData.length; i++) {\n\t\t\t_c.push(_h(_r ? Radio : Checkbox, { label: i }, () => tabData[i].id))\n\t\t}\n\n\t\treturn _h(\n\t\t\t_r ? RadioGroup : CheckboxGroup,\n\t\t\t{\n\t\t\t\tmodelValue: _r ? tr : tt.value,\n\t\t\t\tonOnChange(v: any) {\n\t\t\t\t\tif (_r) {\n\t\t\t\t\t\ttr = v\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttt.value = v\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t() => _c\n\t\t)\n\t}\n\n\tfunction selectRow() {\n\t\tmessageBox({\n\t\t\ttitle: '你想选中那些行',\n\t\t\tcontent: messageRender,\n\t\t\tonOk: () => {\n\t\t\t\tif (selectMode.value === 'radio') {\n\t\t\t\t\tbtTab.value.selectRow(tr)\n\t\t\t\t} else {\n\t\t\t\t\tbtTab.value.selectRow(tt.value)\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\n\tfunction selectRowPredicate() {\n\t\tmessageBox({\n\t\t\ttitle: '按条件主动选择',\n\t\t\tcontent: selectMode.value === 'radio' ? '将选中id为80的那一行' : '将选中id大于79的行',\n\t\t\tonOk: () => {\n\t\t\t\tif (selectMode.value === 'radio') {\n\t\t\t\t\tbtTab.value.selectRow((row: any) => row.id === 80)\n\t\t\t\t} else {\n\t\t\t\t\tbtTab.value.selectRow((row: any) => row.id > 79)\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n</script>\n\n<template>\n\t<show-read-me />\n\t<div class=\"flexColumnBox\">\n\t\t<NodeServeInfo />\n\t\t<div class=\"growFlexItem\">\n\t\t\t<BtTablePage\n\t\t\t\tref=\"btTab\"\n\t\t\t\t:columns=\"columns\"\n\t\t\t\t:url=\"url\"\n\t\t\t\t:search-data=\"searchData\"\n\t\t\t\tshow-top-row\n\t\t\t\t:radio=\"selectMode === 'radio'\"\n\t\t\t\t:selection=\"selectMode === 'checkbox'\"\n\t\t\t\t:showTotal=\"false\"\n\t\t\t\t:draggable=\"true\"\n\t\t\t\ttable-empty-td-handle\n\t\t\t\tborder\n\t\t\t\t@on-row-click=\"onRowClick\"\n\t\t\t\t@on-data-change=\"setTotal\"\n\t\t\t\t@on-drag-drop=\"dragDrop\"\n\t\t\t>\n\t\t\t\t<template #topMsg>共有：{{ total }} 条数据。</template>\n\t\t\t\t<template #topBtnGroup>\n\t\t\t\t\t<div class=\"topBoxKAQ\">\n\t\t\t\t\t\t<RadioGroup v-model=\"selectMode\" style=\"margin-right: 20px\" @on-change=\"clearSelect\">\n\t\t\t\t\t\t\t<Radio label=\"radio\">单选</Radio>\n\t\t\t\t\t\t\t<Radio label=\"checkbox\">多选</Radio>\n\t\t\t\t\t\t</RadioGroup>\n\t\t\t\t\t\t<Checkbox v-model=\"nodeServer\" @on-change=\"getData\">切换为node-serve数据(需开启项目nodeJs服务器)</Checkbox>\n\t\t\t\t\t\t<IconTxtBtn name=\"select row\" icon=\"md-checkbox\" @click=\"selectRow\" />\n\t\t\t\t\t\t<IconTxtBtn name=\"select function\" icon=\"md-checkbox\" @click=\"selectRowPredicate\" />\n\t\t\t\t\t\t<IconTxtBtn name=\"get select\" icon=\"md-list\" @click=\"getS\" />\n\t\t\t\t\t\t<IconTxtBtn name=\"新增\" icon=\"md-add\" @click=\"handleNew\" />\n\t\t\t\t\t\t<IconTxtBtn name=\"打印\" icon=\"md-print\" @click=\"handlePrint\" />\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</BtTablePage>\n\t\t</div>\n\t</div>\n\t<FormModal :title=\"title\" ref=\"formModalRef\" :form-data=\"formData\" :form-rules=\"formRules\" @on-submit=\"handleSub\" />\n</template>\n\n<style scoped lang=\"less\">\n\t.topBoxKAQ {\n\t\tfloat: right;\n\t}\n</style>\n"],"names":["formModalRef","ref","btTab","action","nodeServer","selectMode","total","searchData","tabData","columns","_h","params","downloadFileReaderFile","imgK","tooltipManual","has","TableIconBtn","$swal","messageBox","$fetch","r","getData","setTimeout","formData","formRules","url","computed","title","method","tt","tr","dragDrop","a","b","d","t","nextTick","clearSelect","handleNew","handleSub","search","getS","data","cloneDeep","onRowClick","row","index","setTotal","_a","_b","handlePrint","tablePrint","messageRender","_c","_r","i","Radio","Checkbox","RadioGroup","CheckboxGroup","v","selectRow","selectRowPredicate"],"mappings":"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"}